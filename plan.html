<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Maestro Interactivo: Rodando a Gas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chart.js/3.9.1/chart.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutral Harmony -->
    <!-- Application Structure Plan: The SPA is designed as an interactive dashboard with five main sections accessible via a sticky top navigation. This structure was chosen over a linear document format to allow non-linear exploration, catering to how different stakeholders (CFO, CTO, CEO) might want to consume the information. The flow is: 1) Investment Thesis (the "Why") with high-level KPIs and an investment breakdown chart. 2) Financial Plan (the "How Much") with an interactive chart showing cash flow and monthly expenses, making the burn rate tangible. 3) Tech Roadmap (the "What") using a visual Gantt-style timeline for intuitive understanding of the development sequence. 4) Operations Plan (the "How") also uses a visual timeline to show GTM and legal alignment. 5) Team Plan (the "Who") highlights the core ESOP advantage and provides a detailed role allocation table. This dashboard approach transforms static tables into explorable data, enhancing comprehension and engagement. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Investment Thesis KPIs -> Goal: Inform/Impress -> Viz: Large number cards & Donut Chart -> Interaction: Hover for details -> Justification: More impactful than a list, quickly shows investment allocation -> Library: HTML/CSS, Chart.js.
        - Report Info: Financial Table -> Goal: Show Change/Compare -> Viz: Line/Stacked Bar Combo Chart -> Interaction: Month slider updates chart and KPI cards -> Justification: Visualizes cash runway and expense breakdown dynamically, making complex data digestible -> Library: Chart.js.
        - Report Info: Tech/Ops Roadmaps -> Goal: Organize/Show Change -> Viz: HTML/CSS Gantt-style timeline -> Interaction: Click on tasks to see details -> Justification: More intuitive for understanding project flow and dependencies than a table -> Library: HTML/CSS/JS.
        - Report Info: HR Allocation Table -> Goal: Organize/Inform -> Viz: Styled HTML Table -> Interaction: Dropdown filter to highlight a specific role's journey -> Justification: Improves readability of a dense data table -> Library: HTML/JS.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f4; /* Warm neutral background */
            color: #1f2937; /* Dark gray text */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .nav-link {
            transition: color 0.3s, border-color 0.3s;
        }
        .nav-link:hover, .nav-link.active {
            color: #c2410c; /* Accent color */
            border-bottom-color: #c2410c;
        }
        .kpi-card {
            background-color: #ffffff;
            border-left: 5px solid #0d9488; /* Muted teal accent */
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .timeline-bar {
            position: relative;
            overflow: hidden;
            border-radius: 0.5rem;
            background-color: #e2e8f0;
        }
        .timeline-progress {
            position: absolute;
            height: 100%;
            border-radius: 0.5rem;
            opacity: 0.8;
            transition: background-color 0.3s;
        }
        .timeline-item:hover .timeline-progress {
            opacity: 1;
        }
        .agent-card {
            transition: all 0.3s ease;
        }
        .agent-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 10px 10px -5px rgb(0 0 0 / 0.04);
        }
        .phase-card {
            transition: all 0.3s ease;
        }
        .phase-card:hover {
            transform: translateY(-2px);
        }
        .team-member {
            transition: all 0.3s ease;
        }
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 5px rgba(245, 158, 11, 0.5); }
            50% { box-shadow: 0 0 20px rgba(245, 158, 11, 0.8); }
        }
        .esop-highlight {
            animation: pulse-glow 2s infinite;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header & Navigation -->
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="font-bold text-xl text-slate-800">Rodando a Gas</span>
                    <span class="ml-2 text-sm font-medium text-slate-500">Plan Maestro Interactivo</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#tesis" class="nav-link text-gray-700 hover:text-orange-700 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Tesis</a>
                        <a href="#financiero" class="nav-link text-gray-700 hover:text-orange-700 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Financiero</a>
                        <a href="#tecnologia" class="nav-link text-gray-700 hover:text-orange-700 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Tecnología</a>
                        <a href="#operaciones" class="nav-link text-gray-700 hover:text-orange-700 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Operaciones</a>
                        <a href="#equipo" class="nav-link text-gray-700 hover:text-orange-700 px-3 py-2 rounded-md text-sm font-medium border-b-2 border-transparent">Equipo</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <!-- 0. Tesis de Inversión -->
        <section id="tesis" class="mb-16 scroll-mt-16">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900 mb-2">Tesis de Inversión</h1>
            <p class="text-lg text-slate-600 mb-8">La ventaja financiera fundamental del modelo IA-Nativo de Rodando a Gas.</p>
            
            <div class="bg-white p-6 rounded-lg shadow-md mb-12">
                <h3 class="font-bold text-xl mb-4 text-teal-800">Resumen Estratégico</h3>
                <p class="text-slate-700 leading-relaxed">
                    La inversión solicitada no financia un gasto operativo, sino la adquisición de un activo productivo: un ecosistema de cuatro agentes de IA sinérgicos. Este modelo transforma los costos variables de una financiera tradicional en una inversión de capital fija, generando eficiencia exponencial, un foso competitivo y una escalabilidad de alto margen, similar a un modelo SaaS. Se está financiando una "fuerza laboral de IA" propietaria que garantiza un modelo de negocio de alto margen y sienta las bases para el dominio del mercado.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                <div class="kpi-card p-5 rounded-lg shadow-sm">
                    <p class="text-sm font-medium text-slate-500">Inversión Tecnológica Inicial</p>
                    <p class="text-3xl font-bold text-slate-800">$2.33M</p>
                    <p class="text-xs text-slate-400">MXN en Core IA + SaaS Crítico (32.0%)</p>
                </div>
                <div class="kpi-card p-5 rounded-lg shadow-sm">
                    <p class="text-sm font-medium text-slate-500">Ahorros Anuales vs. Tradicional</p>
                    <p class="text-3xl font-bold text-slate-800">$6.3M</p>
                    <p class="text-xs text-slate-400">MXN vs tradicional (reemplaza +20 personas)</p>
                </div>
                <div class="kpi-card p-5 rounded-lg shadow-sm" style="border-color: #f59e0b;">
                    <p class="text-sm font-medium text-slate-500">ROI a 5 Años (Proyectado)</p>
                    <p class="text-3xl font-bold text-slate-800">457%</p>
                    <p class="text-xs text-slate-400">Sobre inversión tecnológica inicial</p>
                </div>
                <div class="kpi-card p-5 rounded-lg shadow-sm" style="border-color: #f59e0b;">
                    <p class="text-sm font-medium text-slate-500">Período de Recuperación</p>
                    <p class="text-3xl font-bold text-slate-800">~20</p>
                    <p class="text-xs text-slate-400">Meses para recuperar inversión tech</p>
                </div>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="font-bold text-xl mb-4 text-teal-800">Inversión Semilla Solicitada: $7,260,000 MXN</h3>
                <p class="text-slate-600 mb-6">El capital se asignará estratégicamente para maximizar la validación del modelo de negocio y el desarrollo del activo tecnológico clave. A continuación se muestra el desglose de la inversión.</p>
                <div class="chart-container h-64 md:h-80 max-h-80">
                    <canvas id="investmentDonutChart"></canvas>
                </div>
                
                <!-- SaaS Breakdown Detail -->
                <div class="mt-8 bg-gradient-to-r from-teal-50 to-cyan-50 p-6 rounded-lg border border-teal-200">
                    <h4 class="font-bold text-teal-800 mb-4">💼 Desglose SaaS Backbone ($436,000 MXN)</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h5 class="font-semibold text-slate-800 mb-3">Componentes Principales</h5>
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between items-center p-2 bg-white rounded">
                                    <span>Odoo Enterprise (ERP completo)</span>
                                    <span class="font-semibold text-teal-600">$216,000</span>
                                </div>
                                <div class="flex justify-between items-center p-2 bg-white rounded">
                                    <span>Financial AI (Stripe, Xero, DocuSign)</span>
                                    <span class="font-semibold text-teal-600">$120,000</span>
                                </div>
                                <div class="flex justify-between items-center p-2 bg-white rounded">
                                    <span>Seguridad Empresarial (Auth0, SOC2)</span>
                                    <span class="font-semibold text-teal-600">$60,000</span>
                                </div>
                                <div class="flex justify-between items-center p-2 bg-white rounded">
                                    <span>Comunicación Básica (Slack, Google)</span>
                                    <span class="font-semibold text-teal-600">$40,000</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h5 class="font-semibold text-slate-800 mb-3">Cronograma de Implementación</h5>
                            <div class="space-y-2 text-sm">
                                <div class="p-2 bg-white rounded border-l-4 border-teal-500">
                                    <div class="font-semibold">Meses 1-3: Setup + Configuración</div>
                                    <div class="text-slate-600">Setup Odoo, Auth0, infraestructura base</div>
                                </div>
                                <div class="p-2 bg-white rounded border-l-4 border-teal-400">
                                    <div class="font-semibold">Mes 2: Integración APIs</div>
                                    <div class="text-slate-600">Stripe/Xero, Slack/Google Workspace</div>
                                </div>
                                <div class="p-2 bg-white rounded border-l-4 border-teal-300">
                                    <div class="font-semibold">Mes 4+: Operación Completa</div>
                                    <div class="text-slate-600">Stack SaaS operativo, SOC2-ready</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 1. Plan Financiero -->
        <section id="financiero" class="mb-16 scroll-mt-16">
            <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-2">Plan Financiero (CFO View)</h2>
            <p class="text-lg text-slate-600 mb-8">Un despliegue de capital no lineal para maximizar la eficiencia y mitigar riesgos.</p>
            
            <div class="bg-white p-6 rounded-lg shadow-md">
                 <h3 class="font-bold text-xl mb-2 text-teal-800">Flujo de Caja y Gasto Mensual</h3>
                 <p class="text-slate-600 mb-4">Interactúe con el deslizador para explorar el plan financiero mes a mes. El gráfico visualiza el gasto por categoría y el efectivo restante, demostrando un control de capital prudente que prioriza la validación tecnológica antes del gasto en CAPEX.</p>

                <div class="mb-8">
                    <label for="month-slider" class="block text-sm font-medium text-slate-700 mb-2">Mes: <span id="month-label" class="font-bold text-orange-600">1</span></label>
                    <input id="month-slider" type="range" min="1" max="12" value="1" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 text-center">
                    <div class="bg-slate-50 p-3 rounded-lg">
                        <p class="text-sm text-slate-500">Gasto del Mes</p>
                        <p id="kpi-gasto-mes" class="text-2xl font-bold"></p>
                    </div>
                    <div class="bg-slate-50 p-3 rounded-lg">
                        <p class="text-sm text-slate-500">Gasto Acumulado</p>
                        <p id="kpi-gasto-acumulado" class="text-2xl font-bold"></p>
                    </div>
                    <div class="bg-slate-50 p-3 rounded-lg">
                        <p class="text-sm text-slate-500">Efectivo Restante</p>
                        <p id="kpi-efectivo" class="text-2xl font-bold"></p>
                    </div>
                    <div class="bg-slate-50 p-3 rounded-lg">
                        <p class="text-sm text-slate-500">Reserva Emergencia</p>
                        <p class="text-2xl font-bold text-teal-600">$476k</p>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="financialPlanChart"></canvas>
                </div>
            </div>
        </section>

        <!-- 2. Plan de Desarrollo Tecnológico -->
        <section id="tecnologia" class="mb-16 scroll-mt-16">
            <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-2">Plan de Desarrollo (CTO View)</h2>
            <p class="text-lg text-slate-600 mb-8">Un roadmap secuencial para mitigar riesgos, validando las hipótesis más críticas primero.</p>
            
            <!-- AI Agents Overview Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                <div class="agent-card bg-white p-6 rounded-lg shadow-md border-l-4 border-teal-600 cursor-pointer hover:shadow-lg transition-all duration-300" data-agent="hase">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-bold text-lg text-slate-800">HASE</h3>
                        <span class="text-2xl">🧠</span>
                    </div>
                    <p class="text-sm text-slate-600 mb-3">Motor de Scoring</p>
                    <p class="text-2xl font-bold text-teal-600">$600,000</p>
                    <p class="text-xs text-slate-500">1,440 horas desarrollo</p>
                    <div class="mt-3 text-xs text-slate-400">Click para detalles técnicos →</div>
                </div>

                <div class="agent-card bg-white p-6 rounded-lg shadow-md border-l-4 border-emerald-600 cursor-pointer hover:shadow-lg transition-all duration-300" data-agent="pia">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-bold text-lg text-slate-800">PIA</h3>
                        <span class="text-2xl">📱</span>
                    </div>
                    <p class="text-sm text-slate-600 mb-3">Agente Intervención</p>
                    <p class="text-2xl font-bold text-emerald-600">$400,000</p>
                    <p class="text-xs text-slate-500">976 horas desarrollo</p>
                    <div class="mt-3 text-xs text-slate-400">Click para detalles técnicos →</div>
                </div>

                <div class="agent-card bg-white p-6 rounded-lg shadow-md border-l-4 border-cyan-600 cursor-pointer hover:shadow-lg transition-all duration-300" data-agent="superpma">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-bold text-lg text-slate-800">Super-PMA</h3>
                        <span class="text-2xl">🔧</span>
                    </div>
                    <p class="text-sm text-slate-600 mb-3">Mantenimiento Predictivo</p>
                    <p class="text-2xl font-bold text-cyan-600">$450,000</p>
                    <p class="text-xs text-slate-500">1,024 horas desarrollo</p>
                    <div class="mt-3 text-xs text-slate-400">Click para detalles técnicos →</div>
                </div>

                <div class="agent-card bg-white p-6 rounded-lg shadow-md border-l-4 border-indigo-600 cursor-pointer hover:shadow-lg transition-all duration-300" data-agent="asistente">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="font-bold text-lg text-slate-800">Asistente</h3>
                        <span class="text-2xl">🤖</span>
                    </div>
                    <p class="text-sm text-slate-600 mb-3">Digital Assistant</p>
                    <p class="text-2xl font-bold text-indigo-600">$250,000</p>
                    <p class="text-xs text-slate-500">1,024 horas desarrollo</p>
                    <div class="mt-3 text-xs text-slate-400">Click para detalles técnicos →</div>
                </div>
            </div>

            <!-- ROI Comparison Interactive Section -->
            <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h3 class="font-bold text-xl mb-4 text-teal-800">Análisis ROI: IA-Nativo vs Tradicional</h3>
                <div class="mb-6">
                    <label for="roi-years" class="block text-sm font-medium text-slate-700 mb-2">Proyección a: <span id="years-label" class="font-bold text-orange-600">5</span> años</label>
                    <input id="roi-years" type="range" min="1" max="10" value="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="bg-slate-50 p-4 rounded-lg text-center">
                        <p class="text-sm text-slate-500">Costo Acumulado Tradicional</p>
                        <p id="roi-tradicional" class="text-2xl font-bold text-red-600">$19.78M</p>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg text-center">
                        <p class="text-sm text-slate-500">Costo Acumulado IA-Nativo</p>
                        <p id="roi-ia-nativo" class="text-2xl font-bold text-green-600">$6.82M</p>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg text-center">
                        <p class="text-sm text-slate-500">Ahorro Total</p>
                        <p id="roi-ahorro" class="text-2xl font-bold text-teal-600">$12.96M</p>
                    </div>
                </div>
                
                <div class="chart-container h-64">
                    <canvas id="roiComparisonChart"></canvas>
                </div>
                
                <div class="mt-4 p-4 bg-amber-50 rounded-lg border border-amber-200">
                    <p class="text-sm font-semibold text-amber-800">📊 Punto de Equilibrio: <span id="payback-period">20 meses</span></p>
                    <p class="text-sm text-amber-700 mt-1">ROI Final: <span id="final-roi" class="font-bold">457%</span> sobre inversión tecnológica</p>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="font-bold text-xl mb-2 text-teal-800">Roadmap de Desarrollo a 12 Meses</h3>
                <p class="text-slate-600 mb-6">El plan prioriza el motor de scoring (HASE) para validar la predicción de riesgo antes de construir los agentes de intervención (PIA) y monetización (Super-PMA). Haga clic en una barra para ver los detalles de esa fase.</p>
                <div id="tech-timeline-container" class="space-y-6"></div>
                <div id="tech-details-pane" class="mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200 hidden">
                    <h4 id="tech-details-title" class="font-bold text-lg mb-2"></h4>
                    <p id="tech-details-tasks" class="text-sm text-slate-700"></p>
                    <p id="tech-details-milestone" class="text-sm font-semibold text-orange-600 mt-2"></p>
                </div>
            </div>
        </section>

        <!-- 3. Plan Operativo y de Negocio -->
        <section id="operaciones" class="mb-16 scroll-mt-16">
            <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-2">Plan Operativo (COO/CEO View)</h2>
            <p class="text-lg text-slate-600 mb-8">Sincronizando GTM, legal y el piloto con los hitos tecnológicos para construir un negocio viable.</p>
            
            <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h3 class="font-bold text-xl mb-4 text-teal-800">Cronograma Operativo Detallado</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="phase-card bg-gradient-to-br from-teal-50 to-teal-100 p-4 rounded-lg border border-teal-200 cursor-pointer hover:shadow-md transition-all" data-phase="1">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-teal-800">MESES 1-3</span>
                            <span class="text-teal-600">🏗️</span>
                        </div>
                        <h4 class="font-bold text-teal-900 mb-2">Fundación</h4>
                        <div class="space-y-1 text-xs text-teal-700">
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>100% operadores pre-seleccionados</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Trámites REPUVE y SEMARNAT iniciados</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Equipo técnico 100% operativo</div>
                        </div>
                    </div>

                    <div class="phase-card bg-gradient-to-br from-emerald-50 to-emerald-100 p-4 rounded-lg border border-emerald-200 cursor-pointer hover:shadow-md transition-all" data-phase="2">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-emerald-800">MESES 4-6</span>
                            <span class="text-emerald-600">🚀</span>
                        </div>
                        <h4 class="font-bold text-emerald-900 mb-2">Desarrollo</h4>
                        <div class="space-y-1 text-xs text-emerald-700">
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>3 contratos piloto firmados</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>REPUVE y SEMARNAT obtenidos</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>1ra vagoneta transmitiendo datos</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>MVP tecnológico + SaaS desplegado</div>
                        </div>
                    </div>

                    <div class="phase-card bg-gradient-to-br from-cyan-50 to-cyan-100 p-4 rounded-lg border border-cyan-200 cursor-pointer hover:shadow-md transition-all" data-phase="3">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-cyan-800">MESES 7-9</span>
                            <span class="text-cyan-600">📊</span>
                        </div>
                        <h4 class="font-bold text-cyan-900 mb-2">Validación</h4>
                        <div class="space-y-1 text-xs text-cyan-700">
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>3 unidades >95% tiempo activo</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>NPS >50</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Primeros ingresos marketplace</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Morosidad = 0%</div>
                        </div>
                    </div>

                    <div class="phase-card bg-gradient-to-br from-amber-50 to-amber-100 p-4 rounded-lg border border-amber-200 cursor-pointer hover:shadow-md transition-all" data-phase="4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-amber-800">MESES 10-12</span>
                            <span class="text-amber-600">💰</span>
                        </div>
                        <h4 class="font-bold text-amber-900 mb-2">Tracción</h4>
                        <div class="space-y-1 text-xs text-amber-700">
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Morosidad final 0%</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>NPS >70</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Data room 100% completo</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Term sheet $45M en negociación</div>
                        </div>
                    </div>
                </div>
                
                <div id="phase-details" class="bg-slate-50 p-6 rounded-lg border border-slate-200 hidden">
                    <h4 id="phase-title" class="font-bold text-lg mb-4"></h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h5 class="font-semibold text-slate-800 mb-2">Tareas Específicas:</h5>
                            <div id="phase-tasks" class="text-sm text-slate-700 space-y-2"></div>
                        </div>
                        <div>
                            <h5 class="font-semibold text-slate-800 mb-2">KPIs Checkpoint:</h5>
                            <div id="phase-kpis" class="text-sm text-slate-700 space-y-2"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="font-bold text-xl mb-2 text-teal-800">Hitos Operativos y de Negocio</h3>
                <p class="text-slate-600 mb-6">Las actividades operativas están programadas para capitalizar los avances tecnológicos, asegurando la construcción de un negocio sólido y legalmente compatible. El enfoque legal ágil evita la carga regulatoria prematura de una SOFOM.</p>
                <div id="ops-timeline-container" class="space-y-4"></div>
                <div id="ops-details-pane" class="mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200 hidden">
                    <h4 id="ops-details-title" class="font-bold text-lg mb-2"></h4>
                    <p id="ops-details-tasks" class="text-sm text-slate-700 whitespace-pre-line"></p>
                    <p id="ops-details-kpi" class="text-sm font-semibold text-orange-600 mt-2"></p>
                </div>
            </div>
        </section>

        <!-- 4. Plan de Asignación de Recursos Humanos -->
        <section id="equipo" class="scroll-mt-16">
            <h2 class="text-3xl md:text-4xl font-bold text-slate-900 mb-2">Plan de Equipo (HR View)</h2>
            <p class="text-lg text-slate-600 mb-8">La ventaja competitiva más defendible y el principal mitigador del riesgo de ejecución.</p>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-bold text-xl mb-4 text-teal-800">La Piedra Angular: El Núcleo ESOP</h3>
                    <div class="space-y-4 text-slate-700">
                        <p>La certeza de ejecución recae sobre un equipo pre-ensamblado de 3 miembros técnicos senior con química y velocidad probadas.</p>
                        <blockquote class="border-l-4 border-orange-500 pl-4 italic">
                            Su compensación es estratégica: salarios bajos más un <strong>~7% de equity</strong> colectivo, creando <strong>"golden handcuffs"</strong> que eliminan el riesgo de fuga de talento.
                        </blockquote>
                        <p>Para los inversionistas, esto no es un plan de RRHH, es la garantía de que el equipo que construye el valor permanecerá para entregarlo. Es una asignación de capital sofisticada que dirige el equity a los creadores de IP a largo plazo.</p>
                    </div>
                </div>
                 <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="font-bold text-xl mb-4 text-teal-800">Asignación Detallada por Persona/Mes</h3>
                    <p class="text-slate-600 mb-4">Matriz completa mostrando cada hora de trabajo vinculada directamente a hitos del plan maestro. Hover sobre roles ESOP para ver equity stakes.</p>
                    
                    <!-- ESOP Core Team Highlight -->
                    <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200 mb-6">
                        <h4 class="font-semibold text-amber-800 mb-2">🌟 Núcleo ESOP (Golden Handcuffs)</h4>
                        <div class="text-center mb-3">
                            <div class="text-2xl font-bold text-amber-700">10% Equity Colectivo</div>
                            <div class="text-sm text-amber-600">~$15M MXN upside en Serie A exitosa</div>
                            <div class="text-xs text-amber-500 mt-1">Distribución específica post-validación año 1</div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                            <div class="team-member bg-white p-3 rounded border border-amber-200">
                                <div class="flex items-center">
                                    <span class="text-amber-500 mr-2">⭐</span>
                                    <div class="font-semibold text-slate-800">Científico de Datos</div>
                                </div>
                                <div class="text-xs text-slate-600 mt-1">HASE líder • Super-PMA modelos • 1,440h</div>
                            </div>
                            <div class="team-member bg-white p-3 rounded border border-amber-200">
                                <div class="flex items-center">
                                    <span class="text-amber-500 mr-2">⭐</span>
                                    <div class="font-semibold text-slate-800">Ingeniero ML</div>
                                </div>
                                <div class="text-xs text-slate-600 mt-1">PIA líder • Asistente NLP/CV • 1,200h</div>
                            </div>
                            <div class="team-member bg-white p-3 rounded border border-amber-200">
                                <div class="flex items-center">
                                    <span class="text-amber-500 mr-2">⭐</span>
                                    <div class="font-semibold text-slate-800">Full-Stack Developer</div>
                                </div>
                                <div class="text-xs text-slate-600 mt-1">SaaS arquitecto • Integración general • 1,200h</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-4 flex flex-wrap gap-4">
                        <div>
                            <label for="role-filter" class="block text-sm font-medium text-gray-700">Filtrar por Rol:</label>
                            <select id="role-filter" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md">
                                <option value="all">Todos los Roles</option>
                            </select>
                        </div>
                        <div>
                            <label for="month-filter" class="block text-sm font-medium text-gray-700">Destacar Mes:</label>
                            <select id="month-filter" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md">
                                <option value="all">Todos</option>
                                <option value="1">Mes 1</option>
                                <option value="2">Mes 2</option>
                                <option value="3">Mes 3</option>
                                <option value="4">Mes 4</option>
                                <option value="5">Mes 5</option>
                                <option value="6">Mes 6</option>
                                <option value="7">Mes 7</option>
                                <option value="8">Mes 8</option>
                                <option value="9">Mes 9</option>
                                <option value="10">Mes 10</option>
                                <option value="11">Mes 11</option>
                                <option value="12">Mes 12</option>
                            </select>
                        </div>
                    </div>

                    <div class="overflow-x-auto">
                        <table id="hr-table" class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rol</th>
                                    <!-- Months will be generated by JS -->
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <!-- Rows will be generated by JS -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Hours Summary -->
                    <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                        <div class="bg-slate-50 p-3 rounded-lg">
                            <div class="text-sm text-slate-500">Total Horas Desarrollo</div>
                            <div class="text-xl font-bold text-slate-800">6,688h</div>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg">
                            <div class="text-sm text-slate-500">Horas Núcleo ESOP</div>
                            <div class="text-xl font-bold text-amber-600">3,840h</div>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg">
                            <div class="text-sm text-slate-500">% Tiempo ESOP</div>
                            <div class="text-xl font-bold text-teal-600">57.4%</div>
                        </div>
                        <div class="bg-slate-50 p-3 rounded-lg">
                            <div class="text-sm text-slate-500">Equity Total ESOP</div>
                            <div class="text-xl font-bold text-orange-600">10%</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Agent Deep-Dive Modals -->
    <div id="agent-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b p-6 flex justify-between items-center">
                    <h2 id="modal-title" class="text-2xl font-bold text-slate-800"></h2>
                    <button id="close-modal" class="text-slate-500 hover:text-slate-700 text-2xl">&times;</button>
                </div>
                <div id="modal-content" class="p-6">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Legal Entity Info Modal -->
    <div id="legal-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full">
                <div class="p-6 border-b flex justify-between items-center">
                    <h2 class="text-xl font-bold text-slate-800">Estructura Legal y Corporativa</h2>
                    <button id="close-legal-modal" class="text-slate-500 hover:text-slate-700 text-2xl">&times;</button>
                </div>
                <div class="p-6">
                    <div class="space-y-4">
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">Entidad Legal</h3>
                            <p class="text-sm text-slate-600"><strong>Razón Social:</strong> CONDUCTORES DEL MUNDO S.A.P.I. de C.V.</p>
                            <p class="text-sm text-slate-600"><strong>RFC:</strong> CMU201119DD6</p>
                            <p class="text-sm text-slate-600"><strong>Fecha constitución:</strong> 19 noviembre 2020</p>
                            <p class="text-sm text-slate-600"><strong>Modificación objeto:</strong> 24 julio 2025</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">Objeto Social Ampliado</h3>
                            <ul class="text-sm text-slate-600 space-y-1">
                                <li>• Operaciones financiamiento activos/servicios</li>
                                <li>• Servicios movilidad/transporte (MaaS)</li>
                                <li>• Desarrollo soluciones IA/ML</li>
                                <li>• Sistemas computacionales/tecnológicos</li>
                                <li>• Recopilación/administración datos</li>
                            </ul>
                        </div>
                        
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                            <h3 class="font-semibold text-green-800 mb-2">Cumplimiento Regulatorio</h3>
                            <div class="grid grid-cols-2 gap-2 text-sm">
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> Trámites REPUVE (obligatorio GNV)</div>
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> Permisos SEMARNAT (conversión GNV)</div>
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> Políticas PLD (Prevención Lavado Dinero)</div>
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> Preparación SOC2-ready desde día 1</div>
                            </div>
                        </div>
                        
                        <div class="bg-amber-50 p-4 rounded-lg border border-amber-200">
                            <h3 class="font-semibold text-amber-800 mb-2">CAPEX Vagonetas - Desglose Exacto</h3>
                            <div class="text-sm text-slate-700">
                                <div class="flex justify-between mb-1">
                                    <span>Vagoneta base:</span>
                                    <span class="font-semibold">$730,000</span>
                                </div>
                                <div class="flex justify-between mb-1">
                                    <span>Hardware IoT completo:</span>
                                    <span class="font-semibold">$100,000</span>
                                </div>
                                <div class="flex justify-between mb-1">
                                    <span>Seguro y legalización:</span>
                                    <span class="font-semibold">$46,667</span>
                                </div>
                                <div class="border-t pt-2 mt-2">
                                    <div class="flex justify-between font-bold">
                                        <span>Costo por unidad:</span>
                                        <span>$876,667</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Glossary Modal -->
    <div id="glossary-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full">
                <div class="p-6 border-b flex justify-between items-center">
                    <h2 class="text-xl font-bold text-slate-800">Glosario de Términos</h2>
                    <button id="close-glossary-modal" class="text-slate-500 hover:text-slate-700 text-2xl">&times;</button>
                </div>
                <div class="p-6">
                    <div class="space-y-4">
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">GTM (Go-To-Market)</h3>
                            <p class="text-sm text-slate-600">Estrategia de lanzamiento y adquisición de clientes. Define cómo llevaremos el producto al mercado y capturaremos la demanda.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">REPUVE</h3>
                            <p class="text-sm text-slate-600">Registro Público Vehicular. Trámite obligatorio para vehículos que operan con Gas Natural Vehicular (GNV) en México.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">SEMARNAT</h3>
                            <p class="text-sm text-slate-600">Secretaría de Medio Ambiente y Recursos Naturales. Otorga permisos obligatorios para conversión de vehículos a GNV.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">PLD</h3>
                            <p class="text-sm text-slate-600">Prevención de Lavado de Dinero. Marco de compliance financiero obligatorio para operaciones de financiamiento.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">ESOP</h3>
                            <p class="text-sm text-slate-600">Employee Stock Ownership Plan. Plan de participación accionaria que alinea incentivos del equipo técnico clave con el crecimiento empresarial.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">SaaS Backbone</h3>
                            <p class="text-sm text-slate-600">Infraestructura de Software como Servicio empresarial. Incluye ERP (Odoo), sistemas de pago (Stripe), contabilidad (Xero) y seguridad (Auth0).</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-slate-800 text-white mt-16">
        <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
            <p>&copy; 2025 Rodando a Gas. Plan Maestro Interactivo.</p>
            <div class="mt-2 space-x-4">
                <button id="show-legal" class="text-orange-300 hover:text-orange-100 text-xs underline">Ver Estructura Legal y Corporativa</button>
                <button id="show-glossary" class="text-orange-300 hover:text-orange-100 text-xs underline">Glosario de Términos</button>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // AGREGAR VALIDACIÓN CHART.JS AL INICIO:
            if (typeof Chart === 'undefined') {
                console.error('Chart.js no está cargado!');
                return;
            }
            console.log('Chart.js versión:', Chart.version);
            
            // --- DATA ---
            const financialData = {
                labels: Array.from({ length: 12 }, (_, i) => `Mes ${i + 1}`),
                gastoEquipo: [110000, 125000, 125000, 125000, 125000, 125000, 125000, 125000, 125000, 125000, 125000, 115000],
                gastoDesarrollo: [190000, 210000, 257143, 250143, 250143, 250143, 230143, 230143, 230143, 193333, 193333, 199333],
                gastoCapex: [0, 0, 0, 0, 0, 876667, 876667, 876666, 0, 0, 0, 0],
                gastoTotal: [300000, 335000, 382143, 375143, 375143, 1251810, 1231810, 1231809, 355143, 318333, 318333, 324333],
                gastoAcumulado: [300000, 635000, 1017143, 1392286, 1767429, 3019239, 4251049, 5482858, 5837001, 6155334, 6473667, 6798000],
                efectivoRestante: [6960000, 6625000, 6242857, 5867714, 5492571, 4240761, 3008951, 1777142, 1422001, 1103668, 785335, 476002],
                inversionInicial: 7260000,
                reservaEmergencia: 476000
            };

            // ROI Comparison Data
            const roiComparisonData = {
                years: ['Año 1', 'Año 2', 'Año 3', 'Año 4', 'Año 5'],
                tradicional: [3580000, 7339000, 11285950, 15430248, 19781760],
                iaNativo: [3140000, 3994700, 4892135, 5834442, 6823864],
                ahorros: [440000, 3344300, 6393815, 9595806, 12957896],
                details: {
                    inversionTecnologica: 2326000,
                    ahorroAnual: 6300000,
                    roiFinal: 457,
                    paybackMeses: 20,
                    costoAnualTradicional: 3580000,
                    costoAnualIaNativo: 814000
                }
            };
            
            const roiData = {
                tradicional: [3580000, 7339000, 11285950, 15430248, 19781760, 24349688, 29142857, 34170262, 39441270, 44965522, 50753042, 56814250],
                iaNativo: [3140000, 3994700, 4892135, 5834442, 6823864, 7862002, 8951634, 10095711, 11297366, 12560008, 13886339, 15279356],
                ahorros: []
            };
            
            // Calculate savings
            for(let i = 0; i < roiData.tradicional.length; i++) {
                roiData.ahorros.push(roiData.tradicional[i] - roiData.iaNativo[i]);
            }

            // Agent Details Data - Ultra-detailed version
            const agentDetails = {
                hase: {
                    title: 'HASE - Motor de Scoring Hiper-Adaptativo ($600,000)',
                    budget: {
                        softwareDesarrollo: 540000,
                        infraestructuraCloud: 50000,
                        licenciasMLOps: 10000
                    },
                    techStack: ['Python', 'XGBoost', 'scikit-learn', 'Apache Airflow', 'FastAPI (<200ms)', 'SHAP (explicabilidad)', 'PostgreSQL', 'TimescaleDB'],
                    hours: {
                        total: 1440,
                        breakdown: [
                            { role: 'Científico Datos Senior', hours: 864, period: 'meses 1-4', focus: 'Líder desarrollo, ingesta datos, definición features' },
                            { role: 'Ingeniero ML', hours: 192, period: 'apoyo meses 2-3', focus: 'Entrenamiento modelos, validación' },
                            { role: 'Backend Developer', hours: 384, period: 'APIs meses 3-4', focus: 'FastAPI deployment, integración' }
                        ]
                    },
                    cronograma: [
                        { mes: 1, tarea: 'Ingesta datos históricos, definición features', hito: 'Pipeline ETL funcional' },
                        { mes: 2, tarea: 'Entrenamiento modelos v0.5', hito: 'Primeros modelos baseline' },
                        { mes: 3, tarea: 'HASE v0.8 >80% precisión AUC ✓', hito: 'Motor scoring validado offline' },
                        { mes: 6, tarea: 'Optimización con datos piloto', hito: '>90% precisión con datos reales' }
                    ],
                    kpis: [
                        'Precisión predicción >80% AUC mes 3',
                        'Precisión >90% con datos piloto mes 6', 
                        'Latencia API <200ms',
                        'Explicabilidad SHAP integrada'
                    ]
                },
                
                pia: {
                    title: 'PIA - Agente Intervención Proactiva ($400,000)',
                    budget: {
                        softwareDesarrollo: 310000,
                        licenciasApis: 75000,
                        infraestructura: 15000
                    },
                    techStack: ['WhatsApp Business API', 'Twilio SMS backup', 'LLMs afinados empáticos', 'Decision Trees escalamiento', 'FastAPI', 'Redis queue'],
                    hours: {
                        total: 976,
                        breakdown: [
                            { role: 'Ingeniero ML', hours: 480, period: 'líder desarrollo', focus: 'Motor alertas, LLM training' },
                            { role: 'Backend Developer', hours: 240, period: 'APIs integración', focus: 'WhatsApp API, Twilio' },
                            { role: 'Full-Stack', hours: 256, period: 'integración frontend', focus: 'Dashboard alertas, UX' }
                        ]
                    },
                    cronograma: [
                        { mes: 2, tarea: 'Desarrollo motor alertas PIA', hito: 'Arquitectura definida' },
                        { mes: 4, tarea: 'Integración WhatsApp Business API', hito: 'Mensajes automáticos funcionales' },
                        { mes: 5, tarea: 'PIA v1.0 funcional', hito: 'Sistema cobranza empática activo' },
                        { mes: 6, tarea: 'Validación con piloto', hito: 'Tasa adopción >60% operadores' }
                    ],
                    kpis: [
                        'Tasa adopción >60% operadores piloto (mes 6)',
                        'Reducción morosidad 50% al 67.5%',
                        'Respuesta <2min a alertas críticas',
                        'NPS mensajes >70% (no intrusivos)'
                    ]
                },

                superpma: {
                    title: 'Super-PMA - Mantenimiento Predictivo + Marketplace ($450,000)',
                    budget: {
                        softwareDesarrollo: 350000,
                        infraestructuraStreaming: 60000, 
                        hardwareDesarrollo: 20000,
                        licenciasIoT: 20000
                    },
                    techStack: ['RandomForest', 'XGBoost series temporales', 'Apache Kafka streaming', 'React marketplace', 'OBD-II sensores', 'GPS tracking', 'Acelerómetros', 'Medidores flujo GNV'],
                    hours: {
                        total: 1024,
                        breakdown: [
                            { role: 'IoT Engineer', hours: 768, period: 'líder hardware/streaming', focus: 'Sensores, Kafka pipeline, instalación' },
                            { role: 'Científico Datos', hours: 96, period: 'modelos predictivos', focus: 'Algoritmos predicción fallas' },
                            { role: 'Full-Stack', hours: 160, period: 'marketplace MVP', focus: 'Plataforma proveedores, comisiones' }
                        ]
                    },
                    monetization: [
                        'Comisiones marketplace: 15-20% transacciones',
                        'Ingresos objetivo: >$300 MXN/vehículo/mes',
                        'Reducción costos mantenimiento: ~25%',
                        'Reducción downtime: 30-50%'
                    ],
                    cronograma: [
                        { mes: 3, tarea: 'Diseño integración IoT', hito: 'Arquitectura sensores definida' },
                        { mes: 6, tarea: 'Instalación hardware primera unidad', hito: 'Streaming datos tiempo real' },
                        { mes: 7, tarea: 'Marketplace básico funcional', hito: 'Primeras transacciones' },
                        { mes: 8, tarea: 'MVP completo', hito: 'Modelo ingresos validado' }
                    ]
                },

                asistente: {
                    title: 'Asistente Digital 24/7 + Diagnósticos Premium ($250,000)',
                    budget: {
                        softwareDesarrollo: 180000,
                        licenciasApis: 55000,
                        infraestructura: 15000
                    },
                    techStack: ['GPT-4 Vision', 'Claude 3 análisis imagen', 'Make/n8n orquestación', 'BERT español NLP', 'WhatsApp chatbot', 'Base conocimiento 50+ escenarios'],
                    hours: {
                        total: 1024,
                        breakdown: [
                            { role: 'Ingeniero ML', hours: 320, period: 'núcleo NLP/CV', focus: 'Chatbot core, visión computacional' },
                            { role: 'Full-Stack', hours: 224, period: 'integración sistemas', focus: 'APIs, base conocimiento' },
                            { role: 'Frontend', hours: 480, period: 'interfaz usuario', focus: 'WhatsApp UX, dashboard diagnósticos' }
                        ]
                    },
                    serviciosPremium: [
                        'Diagnósticos técnicos: $500-$800 MXN/consulta',
                        'Automatización: ~70% consultas sin humano',
                        'Disponibilidad: 24/7 vía WhatsApp',
                        'Análisis imágenes: Fotos fallas, desgaste partes'
                    ],
                    cronograma: [
                        { mes: 4, tarea: 'Desarrollo chatbot core', hito: 'Base conocimiento 50+ escenarios' },
                        { mes: 6, tarea: 'Diagnóstico por texto funcional', hito: 'Automatización >50% consultas' },
                        { mes: 7, tarea: 'Análisis imagen básico', hito: 'GPT-4 Vision integrado' },
                        { mes: 8, tarea: 'MVP multimodal completo', hito: 'Servicios premium activos' }
                    ]
                }
            };

            // Detailed Operational Phase Data
            const fasesOperativas = {
                1: {
                    periodo: 'Meses 1-3: Fundación',
                    color: '#10b981',
                    tareas: {
                        gtm: 'Go-To-Market: Identificación operadores piloto (red 24,000+ contactos)',
                        legal: 'Trámites REPUVE y SEMARNAT (obligatorios para GNV)',
                        piloto: 'Compra 3 vagonetas para conversión GNV',
                        tecnico: 'HASE v0.8 entrenado, infraestructura + SaaS desplegada'
                    },
                    kpis: [
                        '100% operadores pre-seleccionados ✓',
                        'Trámites REPUVE y SEMARNAT iniciados ✓', 
                        'Equipo técnico + SaaS 100% operativo ✓'
                    ]
                },
                2: {
                    periodo: 'Meses 4-6: Desarrollo',
                    color: '#3b82f6',
                    tareas: {
                        gtm: 'Go-To-Market: Firma contratos operadores piloto',
                        legal: 'Validación cumplimiento PLD + obtención REPUVE/SEMARNAT',
                        piloto: 'Instalación hardware IoT, 1ra vagoneta operando',
                        tecnico: 'PIA funcional + SaaS integrado, App Android MVP'
                    },
                    kpis: [
                        '3 contratos piloto firmados ✓',
                        'REPUVE y SEMARNAT obtenidos ✓',
                        '1ra vagoneta transmitiendo datos ✓',
                        'MVP tecnológico + SaaS desplegado ✓'
                    ]
                },
                3: {
                    periodo: 'Meses 7-9: Validación',
                    color: '#8b5cf6',
                    tareas: {
                        gtm: 'Onboarding soporte continuo operadores',
                        legal: 'Auditoría cumplimiento, políticas internas', 
                        piloto: '3 unidades operando, monitoreo 24/7',
                        tecnico: 'Ecosistema IA 100% funcional'
                    },
                    kpis: [
                        '3 unidades >95% tiempo activo ✓',
                        'NPS >50 ✓',
                        'Primeros ingresos marketplace ✓',
                        'Morosidad = 0% ✓'
                    ]
                },
                4: {
                    periodo: 'Meses 10-12: Tracción',
                    color: '#f59e0b',
                    tareas: {
                        gtm: 'Documentación testimoniales, casos éxito',
                        legal: 'Data room S.A.P.I. completo',
                        piloto: 'Análisis final economía unitaria',
                        tecnico: 'Documentación completa, roadmap Serie A'
                    },
                    kpis: [
                        'Morosidad final 0% ✓',
                        'NPS >70 ✓',
                        'Data room 100% completo ✓',
                        'Term sheet $45M en negociación ✓'
                    ]
                }
            };

            // Detailed Phase Data (for backwards compatibility)
            const phaseDetails = {
                1: {
                    title: 'Meses 1-3: Fundación y Preparación',
                    tasks: [
                        'Go-To-Market: Identificación operadores piloto (red 24,000+ contactos)',
                        'Legal: Trámites REPUVE y SEMARNAT (obligatorios para GNV)',
                        'Piloto: Compra 3 vagonetas para conversión GNV',
                        'Técnico: HASE v0.8 entrenado, infraestructura + SaaS desplegada'
                    ],
                    kpis: [
                        '100% operadores pre-seleccionados ✓',
                        'Trámites REPUVE y SEMARNAT iniciados ✓',
                        'Equipo técnico + SaaS 100% operativo ✓'
                    ]
                },
                2: {
                    title: 'Meses 4-6: Lanzamiento y Despliegue',
                    tasks: [
                        'Go-To-Market: Firma contratos operadores piloto',
                        'Legal: Validación cumplimiento PLD + obtención REPUVE/SEMARNAT',
                        'Piloto: Instalación hardware IoT, 1ra vagoneta operando',
                        'Técnico: PIA funcional + SaaS integrado, App Android MVP'
                    ],
                    kpis: [
                        '3 contratos piloto firmados ✓',
                        'REPUVE y SEMARNAT obtenidos ✓',
                        '1ra vagoneta transmitiendo datos ✓',
                        'MVP tecnológico + SaaS desplegado ✓'
                    ]
                },
                3: {
                    title: 'Meses 7-9: Validación y Recolección de Datos',
                    tasks: [
                        'GTM: Onboarding soporte continuo operadores',
                        'Legal: Auditoría cumplimiento, políticas internas',
                        'Piloto: 3 unidades operando, monitoreo 24/7',
                        'Técnico: Ecosistema IA 100% funcional'
                    ],
                    kpis: [
                        '3 unidades >95% tiempo activo ✓',
                        'NPS >50 ✓',
                        'Primeros ingresos marketplace ✓',
                        'Morosidad = 0% ✓'
                    ]
                },
                4: {
                    title: 'Meses 10-12: Tracción y Preparación Serie A',
                    tasks: [
                        'GTM: Documentación testimoniales, casos éxito',
                        'Legal: Data room S.A.P.I. completo',
                        'Piloto: Análisis final economía unitaria',
                        'Técnico: Documentación completa, roadmap Serie A'
                    ],
                    kpis: [
                        'Morosidad final 0% ✓',
                        'NPS >70 ✓',
                        'Data room 100% completo ✓',
                        'Term sheet $45M en negociación ✓'
                    ]
                }
            };

            // HR Matrix Detallada - Complete 8 roles x 12 months
            const hrMatrixDetallada = {
                roles: [
                    { name: 'Científico de Datos', type: 'ESOP', salary: 35000, equity: 10.0, totalHours: 1440, focus: 'HASE líder • Super-PMA modelos' },
                    { name: 'Ingeniero ML', type: 'ESOP', salary: 30000, equity: 10.0, totalHours: 1200, focus: 'PIA líder • Asistente NLP/CV' },
                    { name: 'Full-Stack Developer', type: 'ESOP', salary: 30000, equity: 10.0, totalHours: 1200, focus: 'SaaS arquitecto • Integración general' },
                    { name: 'Desarrollador Backend', type: 'Contratista', salary: 9000, equity: 0, totalHours: 960 },
                    { name: 'Desarrollador IoT', type: 'Contratista', salary: 9000, equity: 0, totalHours: 1024 },
                    { name: 'Desarrollador Frontend', type: 'Contratista', salary: 9000, equity: 0, totalHours: 720 },
                    { name: 'Ingeniero DevOps', type: 'Contratista', salary: 9000, equity: 0, totalHours: 480 },
                    { name: 'Ingeniero QA', type: 'Contratista', salary: 9000, equity: 0, totalHours: 384 }
                ],
                allocations: [
                    ['HASE (70%) SaaS-Setup (30%)', 'HASE (80%) SaaS-Integration (20%)', 'HASE (80%) SaaS-Optimization (20%)', 'Super-PMA (80%) HASE (20%)', 'Super-PMA (100%)', 'Super-PMA (100%)', 'Análisis Piloto (HASE, PMA)', 'Análisis Piloto (HASE, PMA)', 'Optimización Modelos', 'Documentación (Modelos)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['HASE (60%) SaaS-Integration (40%)', 'PIA (50%) HASE (50%)', 'PIA (80%) Asistente (20%)', 'PIA (70%) Asistente (30%)', 'PIA (100%)', 'Asistente (70%) PIA (30%)', 'Asistente (100%)', 'Análisis Piloto (PIA, Asistente)', 'Optimización Modelos', 'Documentación (IA)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['SaaS (100%)', 'SaaS (80%) PIA (20%)', 'SaaS (50%) PIA (50%)', 'Asistente (50%) PMA (50%)', 'Asistente (50%) PMA (50%)', 'Integración Piloto', 'Soporte Piloto', 'Optimización General', 'Soporte GTM', 'Soporte (Serie A)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['-', 'HASE (API)', 'HASE (API)', 'PIA (API)', 'PIA (API)', 'Integración General', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Backend', 'Documentación API', 'Mantenimiento', 'Mantenimiento'],
                    ['-', 'Super-PMA (HW)', 'Super-PMA (HW)', 'Super-PMA (Streaming)', 'Super-PMA (Streaming)', 'Despliegue Piloto', 'Monitoreo Piloto', 'Monitoreo Piloto', 'Optimización Datos', 'Documentación HW', 'Mantenimiento', 'Mantenimiento'],
                    ['-', '-', 'App (UI/UX)', 'App (Dashboard)', 'App (Backend Connect)', 'App (QA)', 'App (Feedback)', 'App (Feedback)', 'App (Ajustes)', 'Finalización App', '-', 'Soporte (Serie A)'],
                    ['Infra (Cloud, CI/CD)', 'Infra (DBs)', 'Infra (Seguridad)', 'Monitoreo', 'Monitoreo', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Infra', '-', '-', '-', '-'],
                    ['-', '-', '-', '-', '-', 'Pruebas (Carga)', 'Pruebas (Piloto)', 'Pruebas (Piloto)', 'Pruebas (Regresión)', 'Documentación QA', '-', '-']
                ]
            };

            // Enhanced HR Data with detailed monthly assignments (for backwards compatibility)
            const enhancedHrData = {
                roles: ['Científico de Datos', 'Ingeniero de ML', 'Desarrollador Full-Stack', 'Desarrollador Backend', 'Desarrollador IoT', 'Desarrollador Frontend', 'Ingeniero DevOps', 'Ingeniero QA'],
                allocations: [
                    ['HASE (100%)', 'HASE (100%)', 'HASE (80%) Super-PMA (20%)', 'Super-PMA (80%) HASE (20%)', 'Super-PMA (100%)', 'Super-PMA (100%)', 'Análisis Piloto (HASE, PMA)', 'Análisis Piloto (HASE, PMA)', 'Optimización Modelos', 'Documentación (Modelos)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['HASE (100%)', 'PIA (50%) HASE (50%)', 'PIA (80%) Asistente (20%)', 'PIA (70%) Asistente (30%)', 'PIA (100%)', 'Asistente (70%) PIA (30%)', 'Asistente (100%)', 'Análisis Piloto (PIA, Asistente)', 'Optimización Modelos', 'Documentación (IA)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['SaaS (100%)', 'SaaS (80%) PIA (20%)', 'SaaS (50%) PIA (50%)', 'Asistente (50%) PMA (50%)', 'Asistente (50%) PMA (50%)', 'Integración Piloto', 'Soporte Piloto', 'Optimización General', 'Soporte GTM', 'Soporte (Serie A)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['-', 'HASE (API)', 'HASE (API)', 'PIA (API)', 'PIA (API)', 'Integración General', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Backend', 'Documentación API', 'Mantenimiento', 'Mantenimiento'],
                    ['-', 'Super-PMA (HW)', 'Super-PMA (HW)', 'Super-PMA (Streaming)', 'Super-PMA (Streaming)', 'Despliegue Piloto', 'Monitoreo Piloto', 'Monitoreo Piloto', 'Optimización Datos', 'Documentación HW', 'Mantenimiento', 'Mantenimiento'],
                    ['-', '-', 'App (UI/UX)', 'App (Dashboard)', 'App (Backend Connect)', 'App (QA)', 'App (Feedback)', 'App (Feedback)', 'App (Ajustes)', 'Finalización App', '-', 'Soporte (Serie A)'],
                    ['Infra (Cloud, CI/CD)', 'Infra (DBs)', 'Infra (Seguridad)', 'Monitoreo', 'Monitoreo', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Infra', '-', '-', '-', '-'],
                    ['-', '-', '-', '-', '-', 'Pruebas (Carga)', 'Pruebas (Piloto)', 'Pruebas (Piloto)', 'Pruebas (Regresión)', 'Documentación QA', '-', '-']
                ],
                esopRoles: ['Científico de Datos', 'Ingeniero de ML', 'Desarrollador Full-Stack'],
                totalHours: [1440, 1200, 1200, 960, 1024, 720, 480, 384]
            };

            // Financial data is now pre-calculated with exact values

            const investmentData = {
                labels: ['Desarrollo Core IA + SaaS', 'Inversión Piloto (CAPEX)', 'Equipo y Operaciones', 'Reserva de Emergencia'],
                datasets: [{
                    data: [2326000, 2630000, 1828000, 476000],
                    backgroundColor: ['#0d9488', '#0f766e', '#115e59', '#f59e0b'],
                    borderColor: '#f8f7f4',
                    borderWidth: 4
                }]
            };
            
            const techTimelineData = [
                { category: 'HASE', start: 1, end: 3, color: '#10b981', tasks: 'Ingesta de datos, definición de features, entrenamiento de modelos v0.5 a v0.8.', milestone: 'Hito: HASE v0.8 entrenado con >80% de precisión (AUC).' },
                { category: 'SaaS Backbone', start: 1, end: 6, color: '#0d9488', tasks: 'Setup Odoo ERP, integración Stripe/Xero, configuración Auth0, deployment infrastructure empresarial.', milestone: 'Hito: Stack SaaS operativo con seguridad SOC2-ready.' },
                { category: 'PIA', start: 1, end: 5, color: '#0f766e', tasks: 'Diseño de arquitectura, motor de alertas, integración WhatsApp Business API, pruebas MVP.', milestone: 'Hito: MVP de PIA funcional con WhatsApp integrado.' },
                { category: 'Super-PMA', start: 3, end: 8, color: '#115e59', tasks: 'Diseño de integración IoT, desarrollo motor predictivo, marketplace básico, optimización con datos del piloto.', milestone: 'Hito: MVP del marketplace funcional generando ingresos.' },
                { category: 'Asistente Digital', start: 4, end: 8, color: '#134e4a', tasks: 'Núcleo del chatbot, base de conocimiento, diagnóstico por texto, análisis de imagen básico.', milestone: 'Hito: MVP multimodal del Asistente funcional 24/7.' },
                { category: 'Optimización y Serie A', start: 9, end: 12, color: '#f59e0b', tasks: 'Refinamiento de los 4 agentes + SaaS, análisis de datos, preparación de data room técnico y roadmap para Serie A.', milestone: 'Hito: Term sheet de Serie A en negociación.' }
            ];

            const opsTimelineData = [
                { phase: 'Meses 1-3: Fundación y Preparación', color: '#0d9488', tasks: 'Go-To-Market: Identificación y pre-calificación de operadores para el piloto.\nLegales: Trámites REPUVE y SEMARNAT (obligatorios para GNV).\nPiloto: Negociación y compra de las 3 vagonetas para conversión GNV.\nProducto: HASE v0.8 + SaaS infraestructura desplegada.', kpi: 'KPI: 100% de operadores del piloto pre-seleccionados. Trámites REPUVE/SEMARNAT iniciados.' },
                { phase: 'Meses 4-6: Lanzamiento y Despliegue', color: '#0f766e', tasks: 'Go-To-Market: Firma de contratos con operadores del piloto.\nLegales: Validación cumplimiento PLD + obtención REPUVE/SEMARNAT.\nPiloto: Instalación de hardware IoT. Despliegue de la primera vagoneta.\nProducto: PIA funcional + SaaS integrado, App Android MVP.', kpi: 'KPI: 3 contratos piloto firmados. REPUVE/SEMARNAT obtenidos. 1ra vagoneta operando.' },
                { phase: 'Meses 7-9: Validación y Recolección de Datos', color: '#115e59', tasks: 'GTM: Onboarding y soporte continuo a los operadores.\nLegales: Auditoría de cumplimiento y preparación de políticas.\nPiloto: Despliegue de unidades 2 y 3. Monitoreo 24/7.\nProducto: Recolección de feedback y datos de rendimiento.', kpi: 'KPI: 3 unidades operando >95% del tiempo. NPS > 50.' },
                { phase: 'Meses 10-12: Tracción y Preparación Serie A', color: '#f59e0b', tasks: 'GTM: Documentación de testimoniales y casos de éxito.\nLegales: Preparación del data room legal para la S.A.P.I.\nPiloto: Análisis final de datos y reportes de economía unitaria.\nProducto: Consolidación del roadmap de producto para la Serie A.', kpi: 'KPI: Morosidad del piloto en 0%. NPS > 70. Data room completo.' }
            ];

            const hrData = {
                roles: ['Científico de Datos', 'Ingeniero de ML', 'Desarrollador Full-Stack', 'Desarrollador Backend', 'Desarrollador IoT', 'Desarrollador Frontend', 'Ingeniero DevOps', 'Ingeniero QA'],
                allocations: [
                    ['HASE (100%)', 'HASE (100%)', 'HASE (80%) Super-PMA (20%)', 'Super-PMA (80%) HASE (20%)', 'Super-PMA (100%)', 'Super-PMA (100%)', 'Análisis Piloto (HASE, PMA)', 'Análisis Piloto (HASE, PMA)', 'Optimización Modelos', 'Documentación (Modelos)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['HASE (100%)', 'PIA (50%) HASE (50%)', 'PIA (80%) Asistente (20%)', 'PIA (70%) Asistente (30%)', 'PIA (100%)', 'Asistente (70%) PIA (30%)', 'Asistente (100%)', 'Análisis Piloto (PIA, Asistente)', 'Optimización Modelos', 'Documentación (IA)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['SaaS (100%)', 'SaaS (80%) PIA (20%)', 'SaaS (50%) PIA (50%)', 'Asistente (50%) PMA (50%)', 'Asistente (50%) PMA (50%)', 'Integración Piloto', 'Soporte Piloto', 'Optimización General', 'Soporte GTM', 'Soporte (Serie A)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['-', 'HASE (API)', 'HASE (API)', 'PIA (API)', 'PIA (API)', 'Integración General', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Backend', 'Documentación API', 'Mantenimiento', 'Mantenimiento'],
                    ['-', 'Super-PMA (HW)', 'Super-PMA (HW)', 'Super-PMA (Streaming)', 'Super-PMA (Streaming)', 'Despliegue Piloto', 'Monitoreo Piloto', 'Monitoreo Piloto', 'Optimización Datos', 'Documentación HW', 'Mantenimiento', 'Mantenimiento'],
                    ['-', '-', 'App (UI/UX)', 'App (Dashboard)', 'App (Backend Connect)', 'App (QA)', 'App (Feedback)', 'App (Feedback)', 'App (Ajustes)', 'Finalización App', '-', 'Soporte (Serie A)'],
                    ['Infra (Cloud, CI/CD)', 'Infra (DBs)', 'Infra (Seguridad)', 'Monitoreo', 'Monitoreo', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Infra', '-', '-', '-', '-'],
                    ['-', '-', '-', '-', '-', 'Pruebas (Carga)', 'Pruebas (Piloto)', 'Pruebas (Piloto)', 'Pruebas (Regresión)', 'Documentación QA', '-', '-']
                ]
            };

            // --- CHARTS ---

            // Investment Donut Chart
            console.log('Creando Investment Chart...');
            const donutCanvas = document.getElementById('investmentDonutChart');
            console.log('Canvas element:', donutCanvas);
            if (!donutCanvas) {
                console.error('Investment donut chart canvas not found');
                return;
            }
            const donutCtx = donutCanvas.getContext('2d');
            if (!donutCtx) {
                console.error('Cannot get 2D context for investment donut chart');
                return;
            }
            
            try {
                new Chart(donutCtx, {
                type: 'doughnut',
                data: investmentData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' }).format(context.parsed);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
            } catch (error) {
                console.error('Error creating investment donut chart:', error);
            }

            // ROI Comparison Chart
            const roiCanvas = document.getElementById('roiComparisonChart');
            if (!roiCanvas) {
                console.error('ROI comparison chart canvas not found');
                return;
            }
            const roiCtx = roiCanvas.getContext('2d');
            if (!roiCtx) {
                console.error('Cannot get 2D context for ROI comparison chart');
                return;
            }
            
            let roiChart;
            try {
                roiChart = new Chart(roiCtx, {
                type: 'line',
                data: {
                    labels: ['Año 1', 'Año 2', 'Año 3', 'Año 4', 'Año 5', 'Año 6', 'Año 7', 'Año 8', 'Año 9', 'Año 10'],
                    datasets: [
                        {
                            label: 'Modelo Tradicional',
                            data: roiData.tradicional.slice(0, 10),
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            fill: false,
                            tension: 0.3
                        },
                        {
                            label: 'Modelo IA-Nativo',
                            data: roiData.iaNativo.slice(0, 10),
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            fill: false,
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + 
                                           new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN', minimumFractionDigits: 0 }).format(context.parsed.y);
                                }
                            }
                        },
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Costo Acumulado (MXN)'
                            },
                            ticks: {
                                callback: value => `$${(value / 1000000).toFixed(1)}M`
                            }
                        }
                    }
                }
            });
            } catch (error) {
                console.error('Error creating ROI comparison chart:', error);
            }

            // Financial Plan Chart
            console.log('Creando Financial Chart...');
            const financialCanvas = document.getElementById('financialPlanChart');
            console.log('Canvas element:', financialCanvas);
            if (!financialCanvas) {
                console.error('Financial plan chart canvas not found');
                return;
            }
            const financialCtx = financialCanvas.getContext('2d');
            if (!financialCtx) {
                console.error('Cannot get 2D context for financial plan chart');
                return;
            }
            
            let financialChart;
            try {
                financialChart = new Chart(financialCtx, {
                type: 'bar',
                data: {
                    labels: financialData.labels,
                    datasets: [
                        {
                            label: 'Gasto en Equipo',
                            data: financialData.gastoEquipo,
                            backgroundColor: '#14b8a6', // Teal
                            stack: 'Stack 0',
                        },
                        {
                            label: 'Gasto en Desarrollo',
                            data: financialData.gastoDesarrollo,
                            backgroundColor: '#0d9488', // Darker Teal
                            stack: 'Stack 0',
                        },
                        {
                            label: 'Gasto CAPEX',
                            data: financialData.gastoCapex,
                            backgroundColor: '#0f766e', // Even Darker Teal
                            stack: 'Stack 0',
                        },
                        {
                            label: 'Efectivo Restante',
                            data: financialData.efectivoRestante,
                            type: 'line',
                            borderColor: '#f97316', // Orange
                            backgroundColor: 'rgba(249, 115, 22, 0.1)',
                            fill: true,
                            yAxisID: 'y1',
                            tension: 0.3
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN', minimumFractionDigits: 0 }).format(context.parsed.y);
                                    }
                                    return label;
                                }
                            }
                        },
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            grid: { display: false }
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Gasto Mensual (MXN)'
                            },
                            ticks: {
                                callback: value => `${value / 1000}k`
                            }
                        },
                        y1: {
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Efectivo Restante (MXN)'
                            },
                            grid: {
                                drawOnChartArea: false, 
                            },
                            ticks: {
                                callback: value => `${value / 1000000}M`
                            }
                        }
                    }
                }
            });
            } catch (error) {
                console.error('Error creating financial chart:', error);
            }

            // --- INTERACTIONS ---

            // Agent Modal Functionality
            const agentCards = document.querySelectorAll('.agent-card');
            const agentModal = document.getElementById('agent-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            const closeModal = document.getElementById('close-modal');

            function createAgentModalContent(agent) {
                const data = agentDetails[agent];
                const budgetTotal = Object.values(data.budget).reduce((a, b) => a + b, 0);
                const hoursTotal = data.hours.total || data.hours;
                const hoursBreakdown = data.hours.breakdown || [];
                
                return `
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">Presupuesto Detallado</h3>
                                ${Object.entries(data.budget).map(([key, value]) => `
                                    <div class="flex justify-between text-sm mb-2">
                                        <span class="capitalize">${key.replace(/([A-Z])/g, ' $1').toLowerCase()}:</span>
                                        <span class="font-semibold">$${value.toLocaleString()}</span>
                                    </div>
                                `).join('')}
                                <div class="border-t pt-2 mt-2">
                                    <div class="flex justify-between font-bold">
                                        <span>Total:</span>
                                        <span>$${budgetTotal.toLocaleString()}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">Tech Stack</h3>
                                <div class="flex flex-wrap gap-2">
                                    ${data.techStack.map(tech => `
                                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">${tech}</span>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">Horas Desarrollo</h3>
                                <div class="text-center">
                                    <div class="text-3xl font-bold text-teal-600">${hoursTotal}h</div>
                                    <div class="text-sm text-slate-600">Total estimadas</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">Asignación por Rol</h3>
                                ${hoursBreakdown.length > 0 ? hoursBreakdown.map(member => `
                                    <div class="mb-3 p-3 bg-white rounded border">
                                        <div class="font-semibold text-sm">${member.role}</div>
                                        <div class="text-xs text-slate-600">${member.hours}h • ${member.period}</div>
                                        <div class="text-xs text-slate-500 mt-1">${member.focus}</div>
                                    </div>
                                `).join('') : (data.team || []).map(member => `
                                    <div class="mb-3 p-3 bg-white rounded border">
                                        <div class="font-semibold text-sm">${member.role}</div>
                                        <div class="text-xs text-slate-600">${member.hours}h • ${member.months}</div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">
                                    ${data.cronograma ? 'Cronograma Detallado' : data.kpis ? 'KPIs Específicos' : data.monetization ? 'Monetización' : data.serviciosPremium ? 'Servicios Premium' : 'Detalles'}
                                </h3>
                                ${data.cronograma ? data.cronograma.map(item => `
                                    <div class="mb-3 p-2 bg-white rounded border-l-4 border-teal-500">
                                        <div class="font-semibold text-sm">Mes ${item.mes}: ${item.tarea}</div>
                                        <div class="text-xs text-slate-600 mt-1">🎯 ${item.hito}</div>
                                    </div>
                                `).join('') : (data.kpis || data.monetization || data.serviciosPremium || data.services || []).map(item => `
                                    <div class="mb-2 text-sm text-slate-700">• ${item}</div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            agentCards.forEach(card => {
                card.addEventListener('click', () => {
                    const agent = card.dataset.agent;
                    modalTitle.textContent = agentDetails[agent].title;
                    modalContent.innerHTML = createAgentModalContent(agent);
                    agentModal.classList.remove('hidden');
                });
            });

            closeModal.addEventListener('click', () => {
                agentModal.classList.add('hidden');
            });

            // ROI Calculator Functionality
            const roiSlider = document.getElementById('roi-years');
            const yearsLabel = document.getElementById('years-label');
            const roiTradicional = document.getElementById('roi-tradicional');
            const roiIaNativo = document.getElementById('roi-ia-nativo');
            const roiAhorro = document.getElementById('roi-ahorro');
            const paybackPeriod = document.getElementById('payback-period');
            const finalRoi = document.getElementById('final-roi');

            function updateROI(years) {
                const yearIndex = years - 1;
                yearsLabel.textContent = years;
                roiTradicional.textContent = `$${(roiData.tradicional[yearIndex] / 1000000).toFixed(2)}M`;
                roiIaNativo.textContent = `$${(roiData.iaNativo[yearIndex] / 1000000).toFixed(2)}M`;
                roiAhorro.textContent = `$${(roiData.ahorros[yearIndex] / 1000000).toFixed(2)}M`;
                
                // Update chart data
                roiChart.data.datasets[0].data = roiData.tradicional.slice(0, years);
                roiChart.data.datasets[1].data = roiData.iaNativo.slice(0, years);
                roiChart.data.labels = Array.from({length: years}, (_, i) => `Año ${i + 1}`);
                roiChart.update();
                
                // Calculate ROI percentage
                const investmentTech = 2326000;
                const savings = roiData.ahorros[yearIndex];
                const roi = ((savings / investmentTech) * 100).toFixed(0);
                finalRoi.textContent = `${roi}%`;
            }

            roiSlider.addEventListener('input', (e) => updateROI(parseInt(e.target.value)));
            updateROI(5);

            // Phase Details Functionality
            const phaseCards = document.querySelectorAll('.phase-card');
            const phaseDetailsDiv = document.getElementById('phase-details');
            const phaseTitle = document.getElementById('phase-title');
            const phaseTasks = document.getElementById('phase-tasks');
            const phaseKpis = document.getElementById('phase-kpis');

            phaseCards.forEach(card => {
                card.addEventListener('click', () => {
                    const phase = parseInt(card.dataset.phase);
                    const details = phaseDetails[phase];
                    
                    phaseTitle.textContent = details.title;
                    phaseTasks.innerHTML = details.tasks.map(task => `<div class="flex items-start"><span class="text-teal-600 mr-2">•</span>${task}</div>`).join('');
                    phaseKpis.innerHTML = details.kpis.map(kpi => `<div class="flex items-center"><span class="text-green-600 mr-2">✓</span>${kpi}</div>`).join('');
                    phaseDetailsDiv.classList.remove('hidden');
                });
            });

            // Legal Modal
            const showLegalBtn = document.getElementById('show-legal');
            const legalModal = document.getElementById('legal-modal');
            const closeLegalModal = document.getElementById('close-legal-modal');

            showLegalBtn.addEventListener('click', () => {
                legalModal.classList.remove('hidden');
            });

            closeLegalModal.addEventListener('click', () => {
                legalModal.classList.add('hidden');
            });

            // Glossary Modal
            const showGlossaryBtn = document.getElementById('show-glossary');
            const glossaryModal = document.getElementById('glossary-modal');
            const closeGlossaryModal = document.getElementById('close-glossary-modal');

            if (showGlossaryBtn && glossaryModal && closeGlossaryModal) {
                showGlossaryBtn.addEventListener('click', () => {
                    glossaryModal.classList.remove('hidden');
                });

                closeGlossaryModal.addEventListener('click', () => {
                    glossaryModal.classList.add('hidden');
                });
            }

            // Close modals on outside click
            [agentModal, legalModal, glossaryModal].forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.add('hidden');
                    }
                });
            });

            // Financial Slider
            const slider = document.getElementById('month-slider');
            const monthLabel = document.getElementById('month-label');
            const kpiGastoMes = document.getElementById('kpi-gasto-mes');
            const kpiGastoAcumulado = document.getElementById('kpi-gasto-acumulado');
            const kpiEfectivo = document.getElementById('kpi-efectivo');

            function formatCurrency(value) {
                if (value >= 1000000) return `$${(value / 1000000).toFixed(2)}M`;
                if (value >= 1000) return `$${(value / 1000).toFixed(0)}k`;
                return `$${value}`;
            }

            function updateFinancials(month) {
                const index = month - 1;
                monthLabel.textContent = month;
                kpiGastoMes.textContent = formatCurrency(financialData.gastoTotal[index]);
                kpiGastoAcumulado.textContent = formatCurrency(financialData.gastoAcumulado[index]);
                kpiEfectivo.textContent = formatCurrency(financialData.efectivoRestante[index]);
                
                financialChart.data.datasets.forEach(dataset => {
                    dataset.borderWidth = Array(12).fill(1);
                });
                financialChart.data.datasets.forEach(dataset => {
                    if(dataset.type !== 'line') {
                        dataset.borderWidth[index] = 3;
                        dataset.borderColor = '#1f2937';
                    }
                });
                financialChart.update();
            }

            slider.addEventListener('input', (e) => updateFinancials(parseInt(e.target.value)));
            updateFinancials(1);

            // Tech Timeline
            const techContainer = document.getElementById('tech-timeline-container');
            const techDetailsPane = document.getElementById('tech-details-pane');
            const techDetailsTitle = document.getElementById('tech-details-title');
            const techDetailsTasks = document.getElementById('tech-details-tasks');
            const techDetailsMilestone = document.getElementById('tech-details-milestone');
            
            techTimelineData.forEach(item => {
                const itemEl = document.createElement('div');
                itemEl.className = 'timeline-item cursor-pointer p-3 rounded-lg hover:bg-slate-50';
                const width = ((item.end - item.start + 1) / 12) * 100;
                const left = ((item.start - 1) / 12) * 100;

                itemEl.innerHTML = `
                    <div class="flex justify-between items-center mb-1">
                        <span class="font-semibold text-sm">${item.category}</span>
                        <span class="text-xs text-slate-500">Mes ${item.start} - ${item.end}</span>
                    </div>
                    <div class="timeline-bar h-4 w-full bg-slate-200">
                        <div class="timeline-progress" style="width: ${width}%; left: ${left}%; background-color: ${item.color};"></div>
                    </div>
                `;
                itemEl.addEventListener('click', () => {
                    techDetailsTitle.textContent = item.category;
                    techDetailsTasks.textContent = item.tasks;
                    techDetailsMilestone.textContent = item.milestone;
                    techDetailsPane.classList.remove('hidden');
                });
                techContainer.appendChild(itemEl);
            });

            // Ops Timeline
            const opsContainer = document.getElementById('ops-timeline-container');
            const opsDetailsPane = document.getElementById('ops-details-pane');
            const opsDetailsTitle = document.getElementById('ops-details-title');
            const opsDetailsTasks = document.getElementById('ops-details-tasks');
            const opsDetailsKpi = document.getElementById('ops-details-kpi');

            opsTimelineData.forEach(item => {
                const itemEl = document.createElement('div');
                itemEl.className = 'ops-item cursor-pointer p-4 rounded-lg border border-slate-200 hover:bg-slate-50 hover:border-slate-300 transition-colors';
                itemEl.style.borderLeft = `5px solid ${item.color}`;
                itemEl.innerHTML = `<h4 class="font-semibold">${item.phase}</h4>`;
                
                itemEl.addEventListener('click', () => {
                    opsDetailsTitle.textContent = item.phase;
                    opsDetailsTasks.textContent = item.tasks;
                    opsDetailsKpi.textContent = item.kpi;
                    opsDetailsPane.classList.remove('hidden');
                });
                opsContainer.appendChild(itemEl);
            });

            // Enhanced HR Table
            const hrTable = document.getElementById('hr-table');
            const roleFilter = document.getElementById('role-filter');
            const monthFilter = document.getElementById('month-filter');
            const theadRow = hrTable.querySelector('thead tr');
            const tbody = hrTable.querySelector('tbody');

            // Populate filters and table header
            hrMatrixDetallada.roles.forEach(roleData => {
                const option = document.createElement('option');
                option.value = roleData.name;
                option.textContent = roleData.name;
                roleFilter.appendChild(option);
            });
            for(let i = 1; i <= 12; i++) {
                const th = document.createElement('th');
                th.className = 'px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider';
                th.textContent = `M${i}`;
                theadRow.appendChild(th);
            }

            // Populate table body with enhanced data using new detailed structure
            hrMatrixDetallada.allocations.forEach((alloc, i) => {
                const tr = document.createElement('tr');
                const roleData = hrMatrixDetallada.roles[i];
                const roleName = roleData.name;
                const isEsop = roleData.type === 'ESOP';
                
                tr.dataset.role = roleName;
                tr.className = isEsop ? 'bg-amber-50' : '';
                
                const roleCell = document.createElement('td');
                roleCell.className = 'px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900';
                roleCell.innerHTML = `
                    <div class="flex items-center">
                        ${isEsop ? '<span class="text-amber-500 mr-2">★</span>' : ''}
                        ${roleName}
                        <div class="ml-2 text-xs text-slate-600">
                            ${roleData.totalHours}h
                            ${isEsop ? `<span class="text-amber-600"> • ${roleData.equity}% equity</span>` : ''}
                        </div>
                    </div>
                `;
                tr.appendChild(roleCell);
                
                alloc.forEach((task, monthIndex) => {
                    const td = document.createElement('td');
                    td.className = 'px-3 py-2 whitespace-nowrap text-xs text-center text-gray-500';
                    td.textContent = task;
                    td.dataset.month = monthIndex + 1;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });

            // Enhanced filtering functionality
            function updateTableDisplay() {
                const selectedRole = roleFilter.value;
                const selectedMonth = monthFilter.value;
                
                tbody.querySelectorAll('tr').forEach(tr => {
                    const role = tr.dataset.role;
                    const roleData = hrMatrixDetallada.roles.find(r => r.name === role);
                    const isEsop = roleData && roleData.type === 'ESOP';
                    
                    // Role filtering
                    const roleMatch = selectedRole === 'all' || role === selectedRole;
                    tr.style.display = roleMatch ? '' : 'none';
                    
                    if (roleMatch) {
                        // Reset background
                        tr.className = isEsop ? 'bg-amber-50' : '';
                        
                        // Highlight selected role
                        if (selectedRole !== 'all') {
                            tr.style.backgroundColor = '#fef3c7';
                        }
                        
                        // Month highlighting
                        tr.querySelectorAll('td').forEach((td, index) => {
                            if (index > 0) { // Skip role column
                                td.style.backgroundColor = '';
                                td.style.fontWeight = '';
                                
                                if (selectedMonth !== 'all' && td.dataset.month === selectedMonth) {
                                    td.style.backgroundColor = '#dbeafe';
                                    td.style.fontWeight = 'bold';
                                }
                            }
                        });
                    }
                });
            }

            roleFilter.addEventListener('change', updateTableDisplay);
            monthFilter.addEventListener('change', updateTableDisplay);

            // Team member hover effects
            document.querySelectorAll('.team-member').forEach(member => {
                member.addEventListener('mouseenter', () => {
                    const equity = member.dataset.equity;
                    member.style.transform = 'scale(1.02)';
                    member.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
                });
                
                member.addEventListener('mouseleave', () => {
                    member.style.transform = 'scale(1)';
                    member.style.boxShadow = '';
                });
            });

            // Active Nav Link on Scroll
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link');
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 80) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active', 'text-orange-700');
                    if (link.getAttribute('href').includes(current)) {
                        link.classList.add('active', 'text-orange-700');
                    }
                });
            });

        });
    </script>
</body>
</html>
