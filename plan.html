<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Maestro Interactivo: Rodando a Gas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b; 
            --bg-card: rgba(255, 255, 255, 0.12);
            --text-primary: #ffffff;
            --text-secondary: #e2e8f0;
            --text-muted: #94a3b8;
            --accent-blue: #3b82f6;
            --accent-cyan: #22d3ee;
            --accent-teal: #10b981;
            --accent-orange: #f59e0b;
            --accent-purple: #8b5cf6;
            --glass-bg: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.15);
            --shadow-primary: 0 20px 40px rgba(0, 0, 0, 0.4);
            --shadow-glow: 0 30px 60px rgba(59, 130, 246, 0.3);
            
            /* EPIC TYPOGRAPHY SCALE */
            --text-xs: 0.875rem;    /* 14px */
            --text-sm: 1rem;        /* 16px */
            --text-base: 1.125rem;  /* 18px */
            --text-lg: 1.25rem;     /* 20px */
            --text-xl: 1.5rem;      /* 24px */
            --text-2xl: 2rem;       /* 32px */
            --text-3xl: 2.5rem;     /* 40px */
            --text-4xl: 3.5rem;     /* 56px */
        }

        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            background-attachment: fixed;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Particle Background */
        .particle-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: linear-gradient(45deg, var(--accent-blue), var(--accent-cyan));
            border-radius: 50%;
            pointer-events: none;
        }

        /* EPIC PARTICLE ANIMATIONS */
        @keyframes floatUp {
            0% { 
                transform: translateY(0) rotate(0deg) scale(0);
                opacity: 0;
            }
            10% { 
                opacity: 1;
                transform: scale(1);
            }
            90% { 
                opacity: 1;
            }
            100% { 
                transform: translateY(-100vh) rotate(360deg) scale(0);
                opacity: 0;
            }
        }

        @keyframes float {
            0% { 
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* EPIC TYPOGRAPHY FIXES - DOMINANT HEADERS */
        .section-title { 
            font-size: var(--text-4xl) !important;  /* 3.5rem = 56px DOMINANTE */
            font-weight: 900 !important;
            line-height: 1.0 !important;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(59, 130, 246, 0.4);
        }

        .card-title { 
            font-size: var(--text-2xl) !important;  /* 2rem = 32px MAYOR */
            font-weight: 800 !important;
            color: var(--text-primary);
        }

        .number-epic { 
            font-size: 4rem !important;  /* AUMENTAR de 3.5rem a 4rem */
            font-weight: 900 !important;
            text-shadow: 0 0 30px rgba(59, 130, 246, 0.6) !important;
        }

        /* BODY TEXT LEGIBLE - MÍNIMO 18px */
        .body-text, p, .text-slate-300, .text-slate-400 { 
            font-size: var(--text-base) !important;  /* 18px MÍNIMO */
            line-height: 1.7 !important;
            color: #e2e8f0 !important;  /* MEJOR CONTRASTE */
        }

        /* NÚMEROS ÉPICOS MÁS GRANDES */
        .counter-number { 
            font-size: 4rem !important;  /* AUMENTAR de 3.5rem a 4rem */
            font-weight: 900 !important;
            text-shadow: 0 0 30px rgba(59, 130, 246, 0.6) !important;
        }

        /* TEXTO PEQUEÑO LEGIBLE */
        .text-xs, .text-sm {
            font-size: var(--text-sm) !important;  /* MÍNIMO 16px */
            color: #cbd5e1 !important;  /* MEJOR CONTRASTE */
        }

        /* GLASSMORPHISM MEJORADO - LEGIBLE PERO WOW */
        .glass-card-wow {
            background: rgba(255, 255, 255, 0.12) !important;
            backdrop-filter: blur(12px) saturate(180%) !important;  /* REDUCIR blur de 20px a 12px */
            border: 1.5px solid rgba(255, 255, 255, 0.2) !important;  /* BORDERS MÁS VISIBLES */
            border-radius: 20px !important;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.15) !important;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
        }

        .glass-card-wow:hover {
            background: rgba(255, 255, 255, 0.18) !important;
            border: 1.5px solid rgba(59, 130, 246, 0.4) !important;
            transform: translateY(-8px) scale(1.02) !important;
            box-shadow: 
                0 35px 70px rgba(59, 130, 246, 0.25),
                0 0 40px rgba(59, 130, 246, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.25) !important;
        }

        /* GLASS CARD ADVANCED - MEJORADO */
        .glass-card-advanced {
            background: rgba(255, 255, 255, 0.12) !important;
            backdrop-filter: blur(12px) saturate(180%) !important;  /* REDUCIR blur de 20px a 12px */
            border: 1.5px solid rgba(255, 255, 255, 0.2) !important;  /* BORDERS MÁS VISIBLES */
            border-radius: 20px !important;
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.15) !important;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
        }
        
        /* Epic 3D Hover Effects */
        .card-wow-hover:hover {
            transform: translateY(-15px) scale(1.05) rotateX(5deg) rotateY(2deg);
            box-shadow: 
                0 25px 50px rgba(59, 130, 246, 0.4),
                0 0 30px rgba(34, 211, 238, 0.3);
            border: 1px solid rgba(59, 130, 246, 0.5);
            background: var(--bg-card);
        }

        .glass-card-advanced:hover {
            background: rgba(255, 255, 255, 0.18) !important;
            border: 1.5px solid rgba(59, 130, 246, 0.4) !important;
            transform: translateY(-8px) scale(1.02) !important;
            box-shadow: 
                0 35px 70px rgba(59, 130, 246, 0.25),
                0 0 40px rgba(59, 130, 246, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.25) !important;
        }
        
        /* Epic Counter Animation Styles */
        .counter-number {
            font-weight: 900;
            font-size: 3.5rem;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan), var(--accent-teal));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            transition: all 0.3s ease;
        }
        
        .counter-number:hover {
            transform: scale(1.1);
            text-shadow: 
                0 0 20px var(--accent-cyan),
                0 0 40px var(--accent-blue),
                0 0 60px var(--accent-teal);
        }

        .number-glow:hover {
            text-shadow: 
                0 0 20px var(--accent-cyan),
                0 0 40px var(--accent-blue),
                0 0 60px var(--accent-teal);
            transform: scale(1.1);
        }
        
        /* Epic Navigation */
        .nav-epic {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(24px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .nav-epic.scrolled {
            background: rgba(15, 23, 42, 0.95);
            transform: translateY(-100%);
        }

        .nav-epic.visible {
            transform: translateY(0);
        }

        .nav-link-epic {
            position: relative;
            padding: 0.75rem 1.5rem;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        .nav-link-epic:hover,
        .nav-link-epic.active {
            color: var(--accent-cyan);
        }

        .nav-link-epic::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-cyan));
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .nav-link-epic:hover::after,
        .nav-link-epic.active::after {
            width: 80%;
        }

        /* Legacy nav styles for compatibility */
        .nav-dark {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(24px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .nav-link-dark {
            color: var(--text-secondary);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .nav-link-dark:hover, .nav-link-dark.active {
            color: var(--accent-cyan);
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }
        
        .nav-link-dark::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-cyan));
            transition: width 0.3s ease;
        }
        
        .nav-link-dark:hover::after, .nav-link-dark.active::after {
            width: 100%;
        }
        
        /* CHART CONTAINERS CON GLASSMORPHISM MEJORADO */
        .chart-container {
            position: relative !important;
            width: 100% !important;
            height: 400px !important;
            margin-left: auto;
            margin-right: auto;
            background: rgba(255, 255, 255, 0.08) !important;
            backdrop-filter: blur(12px) saturate(180%) !important;
            border: 1.5px solid rgba(255, 255, 255, 0.15) !important;
            border-radius: 20px !important;
            padding: 24px !important;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
        }
        
        canvas {
            display: block !important;
            width: 100% !important;
            height: 100% !important;
            position: relative !important;
        }

        .chart-container canvas {
            position: relative !important;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 400px !important;
            }
        }
        
        /* KPI CARDS ÉPICAS */
        .kpi-card-epic {
            background: rgba(255, 255, 255, 0.12) !important;
            backdrop-filter: blur(12px) saturate(180%) !important;
            border: 1.5px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 20px !important;
            border-left: 4px solid var(--accent-blue);
            padding: 2rem !important;  /* MÁS PADDING PARA RESPIRAR */
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.15) !important;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
            position: relative;
            overflow: hidden;
            perspective: 1000px;
            transform-style: preserve-3d;
        }
        
        .kpi-card-epic::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(34, 211, 238, 0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .kpi-card-epic:hover::before {
            opacity: 1;
        }
        
        .kpi-card-epic:hover {
            transform: translateY(-15px) scale(1.05) rotateX(8deg) !important;
            box-shadow: 
                0 35px 70px rgba(59, 130, 246, 0.4),
                0 0 40px rgba(34, 211, 238, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.25) !important;
            border-color: rgba(59, 130, 246, 0.6) !important;
            border-left-color: var(--accent-cyan);
        }

        /* KPI CARDS DARK - MEJORADAS */
        .kpi-card-dark {
            background: rgba(255, 255, 255, 0.12) !important;
            backdrop-filter: blur(12px) saturate(180%) !important;
            border: 1.5px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 20px !important;
            border-left: 4px solid var(--accent-blue);
            padding: 2rem !important;  /* MÁS PADDING PARA RESPIRAR */
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.15) !important;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
            position: relative;
            overflow: hidden;
        }
        
        .kpi-card-dark::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(34, 211, 238, 0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .kpi-card-dark:hover::before {
            opacity: 1;
        }
        
        .kpi-card-dark:hover {
            transform: translateY(-15px) scale(1.05) rotateX(8deg) !important;
            box-shadow: 
                0 35px 70px rgba(59, 130, 246, 0.4),
                0 0 40px rgba(34, 211, 238, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.25) !important;
            border-color: rgba(59, 130, 246, 0.6) !important;
            border-left-color: var(--accent-cyan);
        }
        
        /* Epic Agent Cards */
        .agent-card-3d {
            background: var(--glass-bg);
            backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: 
                var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            perspective: 1000px;
            transform-style: preserve-3d;
        }
        
        .agent-card-3d:hover {
            transform: translateY(-20px) scale(1.08) rotateX(8deg);
            box-shadow: 
                0 30px 60px rgba(16, 185, 129, 0.4),
                0 0 40px rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.5);
            background: var(--bg-card);
        }

        /* Legacy Agent Cards */
        .agent-card-dark {
            background: var(--glass-bg);
            backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: 
                var(--shadow-primary),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }
        
        .agent-card-dark:hover {
            transform: translateY(-20px) scale(1.08) rotateX(8deg);
            box-shadow: 
                0 30px 60px rgba(16, 185, 129, 0.4),
                0 0 40px rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.5);
            background: var(--bg-card);
        }
        
        /* Epic Scroll Animations */
        .scroll-animate {
            opacity: 0;
            transform: translateY(40px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scroll-animate.animate-in {
            opacity: 1;
            transform: translateY(0);
        }

        .fade-in-up {
            opacity: 0;
            transform: translateY(40px);
            transition: all 0.8s ease-out;
        }
        
        .fade-in-up.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .scale-in {
            opacity: 0;
            transform: scale(0.9);
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .scale-in.visible {
            opacity: 1;
            transform: scale(1);
        }

        .stagger-1 { transition-delay: 0.1s; }
        .stagger-2 { transition-delay: 0.2s; }
        .stagger-3 { transition-delay: 0.3s; }
        .stagger-4 { transition-delay: 0.4s; }
        
        /* Gradient Text */
        .gradient-text {
            background: linear-gradient(135deg, #3b82f6, #06b6d4, #10b981);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Epic Button Effects */
        .button-epic {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .button-epic:hover {
            transform: scale(0.98);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }

        .button-epic::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .button-epic:active::before {
            width: 300px;
            height: 300px;
        }

        /* Legacy button styles */
        .btn-glow {
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-cyan));
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            padding: 12px 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-glow:hover {
            transform: scale(0.98);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }
        
        .btn-glow::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn-glow:active::before {
            width: 300px;
            height: 300px;
        }
        
        /* Timeline Enhancements */
        .timeline-bar-dark {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .timeline-progress-dark {
            position: absolute;
            height: 100%;
            border-radius: 12px;
            background: linear-gradient(90deg, #3b82f6, #06b6d4);
            opacity: 0.8;
            transition: all 0.3s ease;
        }
        
        .timeline-item:hover .timeline-progress-dark {
            opacity: 1;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }
        
        /* Pulse Animation for Critical Numbers */
        @keyframes pulse-glow-epic {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 40px rgba(59, 130, 246, 0.8);
                transform: scale(1.02);
            }
        }
        
        .esop-highlight-epic {
            animation: pulse-glow-epic 3s infinite;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 12px;
            padding: 4px 8px;
        }
        
        /* Scroll Progress Bar */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #06b6d4, #10b981);
            z-index: 9999;
            transition: width 0.1s ease;
        }
        
        /* Section Headers */
        .section-header {
            position: relative;
            margin-bottom: 2rem;
        }
        
        .section-header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 80px;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #06b6d4);
            border-radius: 2px;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(15, 23, 42, 0.5);
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #3b82f6, #06b6d4);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #2563eb, #0891b2);
        }

        /* Loading States & Skeleton Screens */
        .skeleton {
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.1) 25%, 
                rgba(255,255,255,0.2) 50%, 
                rgba(255,255,255,0.1) 75%
            );
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(59, 130, 246, 0.2);
            border-top: 4px solid var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">
    <!-- Particle Background -->
    <div class="particle-container" id="particleContainer"></div>
    
    <!-- Scroll Progress Bar -->
    <div class="scroll-progress"></div>

    <!-- Header & Navigation -->
    <header class="nav-dark sticky top-0 z-50 shadow-lg">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="font-bold text-xl gradient-text">Rodando a Gas</span>
                    <span class="ml-2 text-sm font-medium text-slate-400">Plan Maestro Interactivo</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#tesis" class="nav-link-dark px-3 py-2 rounded-md text-sm font-medium">Tesis</a>
                        <a href="#financiero" class="nav-link-dark px-3 py-2 rounded-md text-sm font-medium">Financiero</a>
                        <a href="#tecnologia" class="nav-link-dark px-3 py-2 rounded-md text-sm font-medium">Tecnología</a>
                        <a href="#operaciones" class="nav-link-dark px-3 py-2 rounded-md text-sm font-medium">Operaciones</a>
                        <a href="#equipo" class="nav-link-dark px-3 py-2 rounded-md text-sm font-medium">Equipo</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <!-- 0. Tesis de Inversión -->
        <section id="tesis" class="mb-16 scroll-mt-16 fade-in-up">
            <div class="section-header">
                <h1 class="section-title mb-2">Tesis de Inversión</h1>
                <p class="text-lg text-slate-300 mb-8">La ventaja financiera fundamental del modelo IA-Nativo de Rodando a Gas.</p>
            </div>
            
            <div class="glass-card-advanced p-8 mb-12 card-wow-hover">
                <h3 class="font-bold text-2xl mb-6 gradient-text">Resumen Estratégico</h3>
                <p class="text-slate-300 leading-relaxed text-lg">
                    La inversión solicitada no financia un gasto operativo, sino la adquisición de un activo productivo: un ecosistema de cuatro agentes de IA sinérgicos. Este modelo transforma los costos variables de una financiera tradicional en una inversión de capital fija, generando eficiencia exponencial, un foso competitivo y una escalabilidad de alto margen, similar a un modelo SaaS. Se está financiando una "fuerza laboral de IA" propietaria que garantiza un modelo de negocio de alto margen y sienta las bases para el dominio del mercado.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                <div class="kpi-card-dark p-6 scale-in">
                    <p class="text-sm font-medium text-slate-400 mb-2">Inversión Tecnológica Inicial</p>
                    <p class="counter-number" data-target="2330000" data-prefix="$" data-suffix="M">$0M</p>
                    <p class="text-xs text-slate-500">MXN en Core IA + SaaS Crítico (32.0%)</p>
                </div>
                <div class="kpi-card-dark p-6 scale-in">
                    <p class="text-sm font-medium text-slate-400 mb-2">Ahorros Anuales vs. Tradicional</p>
                    <p class="counter-number" data-target="6300000" data-prefix="$" data-suffix="M">$0M</p>
                    <p class="text-xs text-slate-500">MXN vs tradicional (reemplaza +20 personas)</p>
                </div>
                <div class="kpi-card-dark p-6 scale-in" style="border-left-color: #f59e0b;">
                    <p class="text-sm font-medium text-slate-400 mb-2">ROI a 5 Años (Proyectado)</p>
                    <p class="counter-number" data-target="457" data-suffix="%">0%</p>
                    <p class="text-xs text-slate-500">Sobre inversión tecnológica inicial</p>
                </div>
                <div class="kpi-card-dark p-6 scale-in" style="border-left-color: #f59e0b;">
                    <p class="text-sm font-medium text-slate-400 mb-2">Período de Recuperación</p>
                    <p class="counter-number" data-target="20" data-prefix="~">0</p>
                    <p class="text-xs text-slate-500">Meses para recuperar inversión tech</p>
                </div>
            </div>

            <div class="glass-card-advanced p-8 card-wow-hover">
                <h3 class="card-title mb-6 gradient-text">Inversión Semilla Solicitada: <span class="number-epic counter-number esop-highlight-epic" data-target="7260000" data-prefix="$" data-suffix=" MXN">$0 MXN</span></h3>
                <p class="text-slate-300 mb-6 text-lg">El capital se asignará estratégicamente para maximizar la validación del modelo de negocio y el desarrollo del activo tecnológico clave. A continuación se muestra el desglose de la inversión.</p>
                <div class="chart-container" style="height: 400px; width: 100%;">
                    <canvas id="investmentDonutChart"></canvas>
                </div>
                
                <!-- SaaS Breakdown Detail -->
                <div class="mt-8 glass-card-advanced p-6 border border-cyan-500/20">
                    <h4 class="font-bold gradient-text mb-6 text-xl">💼 Desglose SaaS Backbone ($436,000 MXN)</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h5 class="font-semibold text-slate-200 mb-4">Componentes Principales</h5>
                            <div class="space-y-3 text-sm">
                                <div class="flex justify-between items-center p-3 glass-card-advanced rounded-lg">
                                    <span class="text-slate-300">Odoo Enterprise (ERP completo)</span>
                                    <span class="font-semibold gradient-text">$216,000</span>
                                </div>
                                <div class="flex justify-between items-center p-3 glass-card-advanced rounded-lg">
                                    <span class="text-slate-300">Financial AI (Stripe, Xero, DocuSign)</span>
                                    <span class="font-semibold gradient-text">$120,000</span>
                                </div>
                                <div class="flex justify-between items-center p-3 glass-card-advanced rounded-lg">
                                    <span class="text-slate-300">Seguridad Empresarial (Auth0, SOC2)</span>
                                    <span class="font-semibold gradient-text">$60,000</span>
                                </div>
                                <div class="flex justify-between items-center p-3 glass-card-advanced rounded-lg">
                                    <span class="text-slate-300">Comunicación Básica (Slack, Google)</span>
                                    <span class="font-semibold gradient-text">$40,000</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h5 class="font-semibold text-slate-200 mb-4">Cronograma de Implementación</h5>
                            <div class="space-y-3 text-sm">
                                <div class="p-3 glass-card-advanced rounded-lg border-l-4 border-cyan-500">
                                    <div class="font-semibold text-slate-200">Meses 1-3: Setup + Configuración</div>
                                    <div class="text-slate-400">Setup Odoo, Auth0, infraestructura base</div>
                                </div>
                                <div class="p-3 glass-card-advanced rounded-lg border-l-4 border-blue-500">
                                    <div class="font-semibold text-slate-200">Mes 2: Integración APIs</div>
                                    <div class="text-slate-400">Stripe/Xero, Slack/Google Workspace</div>
                                </div>
                                <div class="p-3 glass-card-advanced rounded-lg border-l-4 border-teal-500">
                                    <div class="font-semibold text-slate-200">Mes 4+: Operación Completa</div>
                                    <div class="text-slate-400">Stack SaaS operativo, SOC2-ready</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 1. Plan Financiero -->
        <section id="financiero" class="mb-16 scroll-mt-16 fade-in-up">
            <div class="section-header">
                <h2 class="section-title mb-2">Plan Financiero (CFO View)</h2>
                <p class="text-lg text-slate-300 mb-8">Un despliegue de capital no lineal para maximizar la eficiencia y mitigar riesgos.</p>
            </div>
            
            <div class="glass-card-advanced p-8 card-wow-hover">
                 <h3 class="font-bold text-2xl mb-4 gradient-text">Flujo de Caja y Gasto Mensual</h3>
                 <p class="text-slate-300 mb-6 text-lg">Interactúe con el deslizador para explorar el plan financiero mes a mes. El gráfico visualiza el gasto por categoría y el efectivo restante, demostrando un control de capital prudente que prioriza la validación tecnológica antes del gasto en CAPEX.</p>

                <div class="mb-8">
                    <label for="month-slider" class="block text-sm font-medium text-slate-300 mb-3">Mes: <span id="month-label" class="font-bold gradient-text text-lg">1</span></label>
                    <input id="month-slider" type="range" min="1" max="12" value="1" class="w-full h-3 bg-slate-700 rounded-lg appearance-none cursor-pointer">
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 text-center">
                    <div class="glass-card-advanced p-4 rounded-lg">
                        <p class="text-sm text-slate-400 mb-2">Gasto del Mes</p>
                        <p id="kpi-gasto-mes" class="text-2xl font-bold gradient-text"></p>
                    </div>
                    <div class="glass-card-advanced p-4 rounded-lg">
                        <p class="text-sm text-slate-400 mb-2">Gasto Acumulado</p>
                        <p id="kpi-gasto-acumulado" class="text-2xl font-bold gradient-text"></p>
                    </div>
                    <div class="glass-card-advanced p-4 rounded-lg">
                        <p class="text-sm text-slate-400 mb-2">Efectivo Restante</p>
                        <p id="kpi-efectivo" class="text-2xl font-bold gradient-text"></p>
                    </div>
                    <div class="glass-card-advanced p-4 rounded-lg">
                        <p class="text-sm text-slate-400 mb-2">Reserva Emergencia</p>
                        <p class="text-2xl font-bold text-cyan-400">$476k</p>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="financialPlanChart"></canvas>
                </div>
            </div>
        </section>

        <!-- 2. Plan de Desarrollo Tecnológico -->
        <section id="tecnologia" class="mb-16 scroll-mt-16 fade-in-up">
            <div class="section-header">
                <h2 class="section-title mb-2">Plan de Desarrollo (CTO View)</h2>
                <p class="text-lg text-slate-300 mb-8">Un roadmap secuencial para mitigar riesgos, validando las hipótesis más críticas primero.</p>
            </div>
            
            <!-- AI Agents Overview Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                <div class="agent-card-dark p-6 border-l-4 border-teal-500 scale-in" data-agent="hase">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-xl gradient-text">HASE</h3>
                        <span class="text-3xl">🧠</span>
                    </div>
                    <p class="text-sm text-slate-400 mb-3">Motor de Scoring</p>
                    <p class="text-3xl font-bold text-teal-400 counter-number" data-target="600000" data-prefix="$">$0</p>
                    <p class="text-xs text-slate-500 mb-3"><span class="counter-number" data-target="1440">0</span> horas desarrollo</p>
                    <div class="mt-4 text-xs text-slate-400">Click para detalles técnicos →</div>
                </div>

                <div class="agent-card-dark p-6 border-l-4 border-emerald-500 scale-in" data-agent="pia">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-xl gradient-text">PIA</h3>
                        <span class="text-3xl">📱</span>
                    </div>
                    <p class="text-sm text-slate-400 mb-3">Agente Intervención</p>
                    <p class="text-3xl font-bold text-emerald-400 counter-number" data-target="400000" data-prefix="$">$0</p>
                    <p class="text-xs text-slate-500 mb-3"><span class="counter-number" data-target="976">0</span> horas desarrollo</p>
                    <div class="mt-4 text-xs text-slate-400">Click para detalles técnicos →</div>
                </div>

                <div class="agent-card-dark p-6 border-l-4 border-cyan-500 scale-in" data-agent="superpma">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-xl gradient-text">Super-PMA</h3>
                        <span class="text-3xl">🔧</span>
                    </div>
                    <p class="text-sm text-slate-400 mb-3">Mantenimiento Predictivo</p>
                    <p class="text-3xl font-bold text-cyan-400 counter-number" data-target="450000" data-prefix="$">$0</p>
                    <p class="text-xs text-slate-500 mb-3"><span class="counter-number" data-target="1024">0</span> horas desarrollo</p>
                    <div class="mt-4 text-xs text-slate-400">Click para detalles técnicos →</div>
                </div>

                <div class="agent-card-dark p-6 border-l-4 border-indigo-500 scale-in" data-agent="asistente">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="font-bold text-xl gradient-text">Asistente</h3>
                        <span class="text-3xl">🤖</span>
                    </div>
                    <p class="text-sm text-slate-400 mb-3">Digital Assistant</p>
                    <p class="text-3xl font-bold text-indigo-400 counter-number" data-target="250000" data-prefix="$">$0</p>
                    <p class="text-xs text-slate-500 mb-3"><span class="counter-number" data-target="1024">0</span> horas desarrollo</p>
                    <div class="mt-4 text-xs text-slate-400">Click para detalles técnicos →</div>
                </div>
            </div>

            <!-- Tech Development Summary -->
            <div class="glass-card-advanced p-8 mb-12 card-wow-hover">
                <h3 class="font-bold text-2xl mb-6 gradient-text">Resumen de Desarrollo Total</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="text-center">
                        <div class="counter-number text-4xl mb-2" data-target="6688" data-suffix="h">0h</div>
                        <div class="text-slate-400">Horas Totales</div>
                    </div>
                    <div class="text-center">
                        <div class="counter-number text-4xl mb-2" data-target="1700000" data-prefix="$">$0</div>
                        <div class="text-slate-400">Inversión IA Core</div>
                    </div>
                    <div class="text-center">
                        <div class="counter-number text-4xl mb-2" data-target="12960000" data-prefix="$" data-suffix="M">$0M</div>
                        <div class="text-slate-400">Ahorro Acumulado</div>
                    </div>
                    <div class="text-center">
                        <div class="counter-number text-4xl mb-2" data-target="20">0</div>
                        <div class="text-slate-400">Meses Payback</div>
                    </div>
                </div>
            </div>

            <!-- ROI Comparison Interactive Section -->
            <div class="glass-card-advanced p-8 card-wow-hover mb-8">
                <h3 class="font-bold text-2xl mb-6 gradient-text">Análisis ROI: IA-Nativo vs Tradicional</h3>
                <div class="mb-6">
                    <label for="roi-years" class="block text-sm font-medium text-slate-300 mb-3">Proyección a: <span id="years-label" class="font-bold gradient-text text-lg">5</span> años</label>
                    <input id="roi-years" type="range" min="1" max="10" value="5" class="w-full h-3 bg-slate-700 rounded-lg appearance-none cursor-pointer">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                    <div class="glass-card-advanced p-4 rounded-lg text-center">
                        <p class="text-sm text-slate-400 mb-2">Costo Acumulado Tradicional</p>
                        <p id="roi-tradicional" class="text-2xl font-bold text-red-400">$19.78M</p>
                    </div>
                    <div class="glass-card-advanced p-4 rounded-lg text-center">
                        <p class="text-sm text-slate-400 mb-2">Costo Acumulado IA-Nativo</p>
                        <p id="roi-ia-nativo" class="text-2xl font-bold text-green-400">$6.82M</p>
                    </div>
                    <div class="glass-card-advanced p-4 rounded-lg text-center">
                        <p class="text-sm text-slate-400 mb-2">Ahorro Total</p>
                        <p id="roi-ahorro" class="text-2xl font-bold text-cyan-400">$12.96M</p>
                    </div>
                </div>
                
                <div class="chart-container h-64">
                    <canvas id="roiComparisonChart"></canvas>
                </div>
                
                <div class="mt-6 glass-card-advanced p-4 rounded-lg border border-amber-500/20">
                    <p class="text-sm font-semibold text-amber-400">📊 Punto de Equilibrio: <span id="payback-period" class="gradient-text">20 meses</span></p>
                    <p class="text-sm text-slate-300 mt-1">ROI Final: <span id="final-roi" class="font-bold gradient-text">457%</span> sobre inversión tecnológica</p>
                </div>
                
                <!-- ROI Comparison Table Year by Year -->
                <div class="mt-8 bg-slate-50 p-6 rounded-lg border border-slate-200">
                    <h4 class="font-bold text-slate-800 mb-4">📈 Tabla ROI Comparativa: Tradicional vs IA-Nativo (5 años)</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Año</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Modelo Tradicional</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Modelo IA-Nativo</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Ahorro Acumulado</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">ROI %</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Año 1</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-red-600 font-semibold">$3.58M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-green-600 font-semibold">$3.14M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-teal-600 font-semibold">$0.44M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-orange-600 font-semibold">19%</td>
                                </tr>
                                <tr class="bg-gray-50">
                                    <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Año 2</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-red-600 font-semibold">$7.34M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-green-600 font-semibold">$3.99M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-teal-600 font-semibold">$3.34M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-orange-600 font-semibold">144%</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Año 3</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-red-600 font-semibold">$11.29M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-green-600 font-semibold">$4.89M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-teal-600 font-semibold">$6.39M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-orange-600 font-semibold">275%</td>
                                </tr>
                                <tr class="bg-gray-50">
                                    <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Año 4</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-red-600 font-semibold">$15.43M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-green-600 font-semibold">$5.83M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-teal-600 font-semibold">$9.60M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-orange-600 font-semibold">413%</td>
                                </tr>
                                <tr>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900">Año 5</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-red-600 font-semibold">$19.78M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-green-600 font-semibold">$6.82M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-teal-600 font-semibold">$12.96M</td>
                                    <td class="px-4 py-3 whitespace-nowrap text-sm text-center text-orange-600 font-semibold">557%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                        <div class="bg-white p-3 rounded border">
                            <div class="text-sm text-slate-500">Inversión Tecnológica</div>
                            <div class="text-lg font-bold text-slate-800">$2.33M MXN</div>
                        </div>
                        <div class="bg-white p-3 rounded border">
                            <div class="text-sm text-slate-500">Ahorro Anual Recurrente</div>
                            <div class="text-lg font-bold text-teal-600">$6.3M MXN</div>
                        </div>
                        <div class="bg-white p-3 rounded border">
                            <div class="text-sm text-slate-500">Equipo Reemplazado</div>
                            <div class="text-lg font-bold text-orange-600">20+ personas</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="font-bold text-xl mb-2 text-teal-800">Roadmap de Desarrollo a 12 Meses</h3>
                <p class="text-slate-600 mb-6">El plan prioriza el motor de scoring (HASE) para validar la predicción de riesgo antes de construir los agentes de intervención (PIA) y monetización (Super-PMA). Haga clic en una barra para ver los detalles de esa fase.</p>
                <div id="tech-timeline-container" class="space-y-6"></div>
                <div id="tech-details-pane" class="mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200 hidden">
                    <h4 id="tech-details-title" class="font-bold text-lg mb-2"></h4>
                    <p id="tech-details-tasks" class="text-sm text-slate-700"></p>
                    <p id="tech-details-milestone" class="text-sm font-semibold text-orange-600 mt-2"></p>
                </div>
            </div>
        </section>

        <!-- 3. Plan Operativo y de Negocio -->
        <section id="operaciones" class="mb-16 scroll-mt-16 fade-in-up">
            <div class="section-header">
                <h2 class="section-title mb-2">Plan Operativo (COO/CEO View)</h2>
                <p class="text-lg text-slate-300 mb-8">Sincronizando GTM, legal y el piloto con los hitos tecnológicos para construir un negocio viable.</p>
            </div>
            
            <div class="glass-card-advanced p-8 card-wow-hover">
                <h3 class="font-bold text-2xl mb-4 gradient-text">Cronograma Operativo Detallado</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="phase-card bg-gradient-to-br from-teal-50 to-teal-100 p-4 rounded-lg border border-teal-200 cursor-pointer hover:shadow-md transition-all" data-phase="1">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-teal-800">MESES 1-3</span>
                            <span class="text-teal-600">🏗️</span>
                        </div>
                        <h4 class="font-bold text-teal-900 mb-2">Fundación</h4>
                        <div class="space-y-1 text-xs text-teal-700">
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>100% operadores pre-seleccionados</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Trámites REPUVE y SEMARNAT iniciados</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Equipo técnico 100% operativo</div>
                        </div>
                    </div>

                    <div class="phase-card bg-gradient-to-br from-emerald-50 to-emerald-100 p-4 rounded-lg border border-emerald-200 cursor-pointer hover:shadow-md transition-all" data-phase="2">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-emerald-800">MESES 4-6</span>
                            <span class="text-emerald-600">🚀</span>
                        </div>
                        <h4 class="font-bold text-emerald-900 mb-2">Desarrollo</h4>
                        <div class="space-y-1 text-xs text-emerald-700">
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>3 contratos piloto firmados</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>REPUVE y SEMARNAT obtenidos</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>1ra vagoneta transmitiendo datos</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>MVP tecnológico + SaaS desplegado</div>
                        </div>
                    </div>

                    <div class="phase-card bg-gradient-to-br from-cyan-50 to-cyan-100 p-4 rounded-lg border border-cyan-200 cursor-pointer hover:shadow-md transition-all" data-phase="3">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-cyan-800">MESES 7-9</span>
                            <span class="text-cyan-600">📊</span>
                        </div>
                        <h4 class="font-bold text-cyan-900 mb-2">Validación</h4>
                        <div class="space-y-1 text-xs text-cyan-700">
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>3 unidades >95% tiempo activo</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>NPS >50</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Primeros ingresos marketplace</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Morosidad = 0%</div>
                        </div>
                    </div>

                    <div class="phase-card bg-gradient-to-br from-amber-50 to-amber-100 p-4 rounded-lg border border-amber-200 cursor-pointer hover:shadow-md transition-all" data-phase="4">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-sm font-semibold text-amber-800">MESES 10-12</span>
                            <span class="text-amber-600">💰</span>
                        </div>
                        <h4 class="font-bold text-amber-900 mb-2">Tracción</h4>
                        <div class="space-y-1 text-xs text-amber-700">
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Morosidad final 0%</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>NPS >70</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Data room 100% completo</div>
                            <div class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>Term sheet $45M en negociación</div>
                        </div>
                    </div>
                </div>
                
                <div id="phase-details" class="bg-slate-50 p-6 rounded-lg border border-slate-200 hidden">
                    <h4 id="phase-title" class="font-bold text-lg mb-4"></h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h5 class="font-semibold text-slate-800 mb-2">Tareas Específicas:</h5>
                            <div id="phase-tasks" class="text-sm text-slate-700 space-y-2"></div>
                        </div>
                        <div>
                            <h5 class="font-semibold text-slate-800 mb-2">KPIs Checkpoint:</h5>
                            <div id="phase-kpis" class="text-sm text-slate-700 space-y-2"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="glass-card-advanced p-8 card-wow-hover">
                <h3 class="font-bold text-2xl mb-4 gradient-text">Hitos Operativos y de Negocio</h3>
                <p class="text-slate-300 mb-6 text-lg">Las actividades operativas están programadas para capitalizar los avances tecnológicos, asegurando la construcción de un negocio sólido y legalmente compatible. El enfoque legal ágil evita la carga regulatoria prematura de una SOFOM.</p>
                <div id="ops-timeline-container" class="space-y-4"></div>
                <div id="ops-details-pane" class="mt-6 p-4 bg-slate-50 rounded-lg border border-slate-200 hidden">
                    <h4 id="ops-details-title" class="font-bold text-lg mb-2"></h4>
                    <p id="ops-details-tasks" class="text-sm text-slate-700 whitespace-pre-line"></p>
                    <p id="ops-details-kpi" class="text-sm font-semibold text-orange-600 mt-2"></p>
                </div>
            </div>
        </section>

        <!-- 4. Plan de Asignación de Recursos Humanos -->
        <section id="equipo" class="scroll-mt-16 fade-in-up">
            <div class="section-header">
                <h2 class="section-title mb-2">Plan de Equipo (HR View)</h2>
                <p class="text-lg text-slate-300 mb-8">La ventaja competitiva más defendible y el principal mitigador del riesgo de ejecución.</p>
            </div>
            
            <div class="glass-card-advanced p-8 card-wow-hover">
                <h3 class="font-bold text-2xl mb-4 gradient-text">La Piedra Angular: El Núcleo ESOP</h3>
                <div class="space-y-4 text-slate-300">
                    <p>La certeza de ejecución recae sobre un equipo pre-ensamblado de 3 miembros técnicos senior con química y velocidad probadas.</p>
                    <blockquote class="border-l-4 border-orange-500 pl-4 italic">
                        Su compensación es estratégica: salarios bajos más un <strong>10% de equity</strong> colectivo, creando <strong>"golden handcuffs"</strong> que eliminan el riesgo de fuga de talento.
                    </blockquote>
                    <p>Para los inversionistas, esto no es un plan de RRHH, es la garantía de que el equipo que construye el valor permanecerá para entregarlo. Es una asignación de capital sofisticada que dirige el equity a los creadores de IP a largo plazo.</p>
                </div>
            </div>
             <div class="glass-card-advanced p-8 card-wow-hover">
                <h3 class="font-bold text-2xl mb-4 gradient-text">Asignación Detallada por Persona/Mes</h3>
                <p class="text-slate-300 mb-4 text-lg">Matriz completa mostrando cada hora de trabajo vinculada directamente a hitos del plan maestro. Hover sobre roles ESOP para ver equity stakes.</p>
                
                <!-- ESOP Core Team Highlight -->
                <div class="bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border border-amber-200 mb-6">
                    <h4 class="font-semibold text-amber-800 mb-2">🌟 Núcleo ESOP (Golden Handcuffs)</h4>
                    <div class="text-center mb-3">
                        <div class="text-2xl font-bold text-amber-700">10% Equity Colectivo</div>
                        <div class="text-sm text-amber-600">~$15M MXN upside en Serie A exitosa</div>
                        <div class="text-xs text-amber-500 mt-1">Distribución específica post-validación año 1</div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                        <div class="team-member bg-white p-3 rounded border border-amber-200 hover:bg-amber-50 cursor-pointer">
                            <div class="flex items-center">
                                <span class="text-amber-500 mr-2">⭐</span>
                                <div class="font-semibold text-slate-800">Científico de Datos</div>
                            </div>
                            <div class="text-xs text-slate-600 mt-1">HASE líder • Super-PMA modelos • 1,440h</div>
                            <div class="text-xs text-amber-600 mt-1">ESOP member</div>
                        </div>
                        <div class="team-member bg-white p-3 rounded border border-amber-200 hover:bg-amber-50 cursor-pointer">
                            <div class="flex items-center">
                                <span class="text-amber-500 mr-2">⭐</span>
                                <div class="font-semibold text-slate-800">Ingeniero ML</div>
                            </div>
                            <div class="text-xs text-slate-600 mt-1">PIA líder • Asistente NLP/CV • 1,200h</div>
                            <div class="text-xs text-amber-600 mt-1">ESOP member</div>
                        </div>
                        <div class="team-member bg-white p-3 rounded border border-amber-200 hover:bg-amber-50 cursor-pointer">
                            <div class="flex items-center">
                                <span class="text-amber-500 mr-2">⭐</span>
                                <div class="font-semibold text-slate-800">Full-Stack Developer</div>
                            </div>
                            <div class="text-xs text-slate-600 mt-1">SaaS arquitecto • Integración general • 1,200h</div>
                            <div class="text-xs text-amber-600 mt-1">ESOP member</div>
                        </div>
                    </div>
                </div>
                
                <div class="mb-4 flex flex-wrap gap-4">
                    <div>
                        <label for="role-filter" class="block text-sm font-medium text-gray-700">Filtrar por Rol:</label>
                        <select id="role-filter" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md">
                            <option value="all">Todos los Roles</option>
                        </select>
                    </div>
                    <div>
                        <label for="month-filter" class="block text-sm font-medium text-gray-700">Destacar Mes:</label>
                        <select id="month-filter" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm rounded-md">
                            <option value="all">Todos</option>
                            <option value="1">Mes 1</option>
                            <option value="2">Mes 2</option>
                            <option value="3">Mes 3</option>
                            <option value="4">Mes 4</option>
                            <option value="5">Mes 5</option>
                            <option value="6">Mes 6</option>
                            <option value="7">Mes 7</option>
                            <option value="8">Mes 8</option>
                            <option value="9">Mes 9</option>
                            <option value="10">Mes 10</option>
                            <option value="11">Mes 11</option>
                            <option value="12">Mes 12</option>
                        </select>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table id="hr-table" class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rol</th>
                                <!-- Months will be generated by JS -->
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <!-- Rows will be generated by JS -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Hours Summary -->
                <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                    <div class="bg-slate-50 p-3 rounded-lg">
                        <div class="text-sm text-slate-500">Total Horas Desarrollo</div>
                        <div class="text-xl font-bold text-slate-800">6,688h</div>
                    </div>
                    <div class="bg-slate-50 p-3 rounded-lg">
                        <div class="text-sm text-slate-500">Horas Núcleo ESOP</div>
                        <div class="text-xl font-bold text-amber-600">3,840h</div>
                    </div>
                    <div class="bg-slate-50 p-3 rounded-lg">
                        <div class="text-sm text-slate-500">% Tiempo ESOP</div>
                        <div class="text-xl font-bold text-teal-600">57.4%</div>
                    </div>
                    <div class="bg-slate-50 p-3 rounded-lg">
                        <div class="text-sm text-slate-500">Equity Total ESOP</div>
                        <div class="text-xl font-bold text-orange-600">10%</div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Agent Deep-Dive Modals -->
    <div id="agent-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b p-6 flex justify-between items-center">
                    <h2 id="modal-title" class="text-2xl font-bold text-slate-800"></h2>
                    <button id="close-modal" class="text-slate-500 hover:text-slate-700 text-2xl">&times;</button>
                </div>
                <div id="modal-content" class="p-6">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <!-- Legal Entity Info Modal -->
    <div id="legal-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full">
                <div class="p-6 border-b flex justify-between items-center">
                    <h2 class="text-xl font-bold text-slate-800">Estructura Legal y Corporativa</h2>
                    <button id="close-legal-modal" class="text-slate-500 hover:text-slate-700 text-2xl">&times;</button>
                </div>
                <div class="p-6 max-h-[70vh] overflow-y-auto">
                    <div class="space-y-4">
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">Entidad Legal</h3>
                            <p class="text-sm text-slate-600"><strong>Razón Social:</strong> CONDUCTORES DEL MUNDO S.A.P.I. de C.V.</p>
                            <p class="text-sm text-slate-600"><strong>RFC:</strong> CMU201119DD6</p>
                            <p class="text-sm text-slate-600"><strong>Fecha constitución:</strong> 19 noviembre 2020</p>
                            <p class="text-sm text-slate-600"><strong>Modificación objeto:</strong> 24 julio 2025 (ampliación actividades IA/ML)</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">Objeto Social Detallado</h3>
                            <ul class="text-sm text-slate-600 space-y-1">
                                <li>• Operaciones financiamiento activos y servicios (leasing vagonetas)</li>
                                <li>• Servicios movilidad y transporte como servicio (MaaS)</li>
                                <li>• Desarrollo y comercialización soluciones IA/ML propietarias</li>
                                <li>• Sistemas computacionales y tecnológicos especializados</li>
                                <li>• Recopilación, procesamiento y administración datos telemáticos</li>
                                <li>• Marketplace digital servicios mantenimiento y refacciones</li>
                                <li>• Consultoría tecnológica sector transporte y movilidad</li>
                            </ul>
                        </div>
                        
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                            <h3 class="font-semibold text-green-800 mb-2">Cumplimiento Regulatorio</h3>
                            <div class="grid grid-cols-1 gap-2 text-sm">
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> Políticas PLD (Prevención Lavado Dinero) implementadas y auditadas</div>
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> Normativas Ley Fintech aplicables (no requiere autorización CNBV)</div>
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> REPUVE (Registro Público Vehicular) obligatorio para vagonetas GNV</div>
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> SEMARNAT permisos conversión GNV y emisiones</div>
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> Preparación SOC2-ready desde día 1 (security compliance)</div>
                                <div class="flex items-center"><span class="text-green-600 mr-2">✓</span> Contratos operadores B2B (NO requieren registro PROFECO)</div>
                            </div>
                        </div>
                        
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                            <h3 class="font-semibold text-blue-800 mb-2">Estructura Corporativa S.A.P.I.</h3>
                            <p class="text-sm text-slate-600 mb-2"><strong>Tipo:</strong> S.A.P.I. de C.V. (Sociedad Anónima Promotora de Inversión)</p>
                            <div class="text-sm text-slate-600 space-y-1">
                                <p><strong>Ventajas:</strong></p>
                                <ul class="ml-4 space-y-1">
                                    <li>• Flexibilidad para inversionistas institucionales</li>
                                    <li>• Estructura equity/debt óptima para venture capital</li>
                                    <li>• Gobierno corporativo escalable para Serie A</li>
                                    <li>• Régimen fiscal favorable para reinversión utilidades</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                            <h3 class="font-semibold text-orange-800 mb-2">Preparación Serie A</h3>
                            <div class="text-sm text-slate-600 space-y-1">
                                <div class="flex items-center"><span class="text-orange-600 mr-2">📋</span> Data room legal 100% completo mes 11</div>
                                <div class="flex items-center"><span class="text-orange-600 mr-2">📊</span> Auditorías financieras trimestrales implementadas</div>
                                <div class="flex items-center"><span class="text-orange-600 mr-2">👥</span> Board structure preparada para independientes</div>
                                <div class="flex items-center"><span class="text-orange-600 mr-2">🔍</span> Compliance histórico documentado para due diligence</div>
                            </div>
                        </div>
                        
                        <div class="bg-amber-50 p-4 rounded-lg border border-amber-200">
                            <h3 class="font-semibold text-amber-800 mb-2">CAPEX Vagonetas - Desglose Exacto</h3>
                            <div class="text-sm text-slate-700">
                                <div class="flex justify-between mb-1">
                                    <span>Vagoneta para conversión GNV:</span>
                                    <span class="font-semibold">$730,000</span>
                                </div>
                                <div class="flex justify-between mb-1">
                                    <span>Hardware IoT completo (OBD-II, GPS, sensores):</span>
                                    <span class="font-semibold">$100,000</span>
                                </div>
                                <div class="flex justify-between mb-1">
                                    <span>Seguro cobertura amplia + registro REPUVE:</span>
                                    <span class="font-semibold">$46,667</span>
                                </div>
                                <div class="border-t pt-2 mt-2">
                                    <div class="flex justify-between font-bold">
                                        <span>Costo por unidad:</span>
                                        <span>$876,667</span>
                                    </div>
                                </div>
                                <div class="mt-3 text-xs text-amber-700">
                                    <p><strong>Especificaciones Hardware:</strong></p>
                                    <p>• OBD-II diagnósticos motor + transmisión</p>
                                    <p>• GPS tracking + geofencing + optimización rutas</p>
                                    <p>• Medidores flujo GNV + alertas nivel</p>
                                    <p>• Acelerómetros comportamiento conductor</p>
                                    <p>• Conectividad LTE/4G + backup 3G</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Glossary Modal -->
    <div id="glossary-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-2xl w-full">
                <div class="p-6 border-b flex justify-between items-center">
                    <h2 class="text-xl font-bold text-slate-800">Glosario de Términos</h2>
                    <button id="close-glossary-modal" class="text-slate-500 hover:text-slate-700 text-2xl">&times;</button>
                </div>
                <div class="p-6 max-h-[70vh] overflow-y-auto">
                    <div class="space-y-4">
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">GTM (Go-To-Market)</h3>
                            <p class="text-sm text-slate-600">Estrategia de lanzamiento al mercado y adquisición de clientes objetivo. Define cómo llevaremos el producto al mercado y capturaremos la demanda específica.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">REPUVE</h3>
                            <p class="text-sm text-slate-600">Registro Público Vehicular. Trámite obligatorio SEMARNAT para vehículos conversión GNV. Crítico para operación legal de vagonetas.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">SEMARNAT</h3>
                            <p class="text-sm text-slate-600">Secretaría Medio Ambiente: Permisos oficiales conversión GNV y verificación emisiones. Autoridad regulatoria ambiental México.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">PLD</h3>
                            <p class="text-sm text-slate-600">Prevención Lavado Dinero: Políticas compliance para operaciones financieras. Marco regulatorio obligatorio sector fintech.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">ESOP</h3>
                            <p class="text-sm text-slate-600">Employee Stock Ownership Plan: Programa participación accionaria empleados clave. Alinea incentivos equipo técnico con crecimiento empresarial.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">AUC (Area Under Curve)</h3>
                            <p class="text-sm text-slate-600">Métrica precisión modelos machine learning (0-1, >0.8 excelente). Mide capacidad discriminación algoritmos de scoring de riesgo.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">SLA (Service Level Agreement)</h3>
                            <p class="text-sm text-slate-600">Compromisos tiempo respuesta y disponibilidad sistema. Garantías operativas para clientes (ej: <2min alertas críticas).</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">SOC2</h3>
                            <p class="text-sm text-slate-600">System Organization Controls 2: Estándar auditoría seguridad datos enterprise. Compliance crítico para clientes institucionales.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">API (Application Programming Interface)</h3>
                            <p class="text-sm text-slate-600">Interfaz comunicación entre sistemas software. Permite integración WhatsApp, Stripe, Odoo y otros servicios externos.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">IoT (Internet of Things)</h3>
                            <p class="text-sm text-slate-600">Red dispositivos conectados transmitiendo datos tiempo real. Sensores OBD-II, GPS, acelerómetros en vagonetas.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">MLOps</h3>
                            <p class="text-sm text-slate-600">Machine Learning Operations: Prácticas despliegue y mantenimiento modelos IA. Automatización pipeline ML producción.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">NLP (Natural Language Processing)</h3>
                            <p class="text-sm text-slate-600">Procesamiento lenguaje natural para chatbots. BERT español fine-tuning para Asistente Digital 24/7.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">Computer Vision</h3>
                            <p class="text-sm text-slate-600">Visión computacional: IA para análisis automático imágenes/video. GPT-4 Vision para diagnósticos técnicos premium.</p>
                        </div>
                        
                        <div class="bg-slate-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-slate-800 mb-2">SaaS Backbone</h3>
                            <p class="text-sm text-slate-600">Infraestructura Software como Servicio empresarial. Incluye ERP (Odoo), pagos (Stripe), contabilidad (Xero) y seguridad (Auth0).</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-slate-800 text-white mt-16">
        <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 text-center text-sm">
            <p>&copy; 2025 Rodando a Gas. Plan Maestro Interactivo.</p>
            <div class="mt-2 space-x-4">
                <button id="show-legal" class="text-orange-300 hover:text-orange-100 text-xs underline">Ver Estructura Legal y Corporativa</button>
                <button id="show-glossary" class="text-orange-300 hover:text-orange-100 text-xs underline">Glosario de Términos</button>
            </div>
        </div>
    </footer>

    <script>
        // ===== EPIC COUNTER ANIMATIONS CON INTERSECTION OBSERVER =====
        class EpicCounterAnimator {
            constructor() {
                this.counterTargets = new Map([
                    ['7260000', { format: '$7.26M MXN', duration: 3000, delay: 0 }],
                    ['457', { format: '457%', duration: 2500, delay: 300 }],
                    ['6300000', { format: '$6.3M MXN', duration: 2800, delay: 600 }],
                    ['20', { format: '~20 meses', duration: 2000, delay: 900 }],
                    ['6688', { format: '6,688h', duration: 2200, delay: 1200 }],
                    ['10', { format: '10%', duration: 1800, delay: 1500 }],
                    ['2330000', { format: '$2.33M MXN', duration: 2600, delay: 200 }],
                    ['1700000', { format: '$1.7M', duration: 2400, delay: 400 }],
                    ['12960000', { format: '$12.96M', duration: 3200, delay: 800 }],
                    ['600000', { format: '$600k', duration: 2000, delay: 100 }],
                    ['400000', { format: '$400k', duration: 2000, delay: 200 }],
                    ['450000', { format: '$450k', duration: 2000, delay: 300 }],
                    ['250000', { format: '$250k', duration: 2000, delay: 400 }],
                    ['1440', { format: '1,440', duration: 1800, delay: 100 }],
                    ['976', { format: '976', duration: 1600, delay: 200 }],
                    ['1024', { format: '1,024', duration: 1800, delay: 300 }}
                ]);
                this.initObserver();
            }
            
            initObserver() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach((entry) => {
                        if (entry.isIntersecting && !entry.target.dataset.animated) {
                            entry.target.dataset.animated = 'true';
                            this.animateCounter(entry.target);
                        }
                    });
                }, { threshold: 0.3, rootMargin: '-50px' });
                
                document.querySelectorAll('.counter-number').forEach(el => {
                    observer.observe(el);
                });
            }
            
            animateCounter(element) {
                const target = parseInt(element.dataset.target);
                const config = this.counterTargets.get(target.toString()) || { format: target.toString(), duration: 2000, delay: 0 };
                
                setTimeout(() => {
                    this.runAnimation(element, target, config.duration, config.format);
                }, config.delay);
            }
            
            runAnimation(element, target, duration, format) {
                let start = 0;
                const increment = target / (duration / 16);
                
                const animate = () => {
                    start += increment;
                    if (start >= target) {
                        element.textContent = format;
                        element.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            element.style.transform = 'scale(1)';
                        }, 200);
                        return;
                    }
                    
                    if (format.includes('$') && format.includes('M')) {
                        element.textContent = '$' + (start / 1000000).toFixed(2) + 'M MXN';
                    } else if (format.includes('$') && format.includes('k')) {
                        element.textContent = '$' + (start / 1000).toFixed(0) + 'k';
                    } else if (format.includes('%')) {
                        element.textContent = Math.round(start) + '%';
                    } else if (format.includes('~')) {
                        element.textContent = '~' + Math.round(start) + ' meses';
                    } else if (format.includes(',')) {
                        element.textContent = Math.round(start).toLocaleString() + format.slice(-1);
                    } else {
                        element.textContent = Math.round(start) + format.slice(-1);
                    }
                    
                    requestAnimationFrame(animate);
                };
                animate();
            }
        }

        function formatNumber(value, format) {
            if (format.includes('$') && format.includes('M')) {
                return '$' + (value / 1000000).toFixed(2) + 'M MXN';
            } else if (format.includes('%')) {
                return Math.round(value) + '%';
            } else if (format.includes('~') && format.includes('meses')) {
                return '~' + Math.round(value) + ' meses';
            } else if (format.includes(',') && format.includes('h')) {
                return value.toLocaleString() + 'h';
            }
            return Math.round(value).toLocaleString();
        }

        function animateCounter(element, target, duration, format) {
            let start = 0;
            const increment = target / (duration / 16);
            
            const animate = () => {
                start += increment;
                if (start < target) {
                    element.textContent = formatNumber(start, format);
                    requestAnimationFrame(animate);
                } else {
                    element.textContent = formatNumber(target, format);
                }
            };
            animate();
        }

        // ===== EPIC PARTICLE SYSTEM MEJORADO =====
        class EpicParticleSystem {
            constructor(container) {
                this.container = container;
                this.particles = [];
                this.createParticles(40);  // AUMENTAR de 30 a 40
                this.animate();
            }
            
            createParticles(count) {
                for (let i = 0; i < count; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    
                    const size = Math.random() * 3 + 1;  // 1-4px
                    const opacity = Math.random() * 0.7 + 0.2;  // 0.2-0.9
                    const duration = Math.random() * 25 + 15;  // 15-40s
                    const delay = Math.random() * 5;  // 0-5s delay
                    
                    particle.style.cssText = `
                        position: absolute;
                        width: ${size}px;
                        height: ${size}px;
                        background: linear-gradient(45deg, #3b82f6, #22d3ee, #10b981);
                        border-radius: 50%;
                        pointer-events: none;
                        opacity: ${opacity};
                        left: ${Math.random() * 100}%;
                        top: 100%;
                        animation: floatUp ${duration}s infinite linear ${delay}s;
                        box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
                    `;
                    
                    this.container.appendChild(particle);
                    this.particles.push(particle);
                }
            }
        }

        // ===== EPIC SCROLL ANIMATIONS CON STAGGER EFFECTS =====
        class EpicScrollAnimations {
            constructor() {
                this.initObserver();
                this.addStaggerDelays();
            }
            
            initObserver() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach((entry, index) => {
                        if (entry.isIntersecting && !entry.target.dataset.animated) {
                            entry.target.dataset.animated = 'true';
                            
                            const delay = parseInt(entry.target.dataset.stagger) || 0;
                            setTimeout(() => {
                                entry.target.classList.add('animate-in');
                                
                                // Efecto cascada para children
                                const children = entry.target.querySelectorAll('.stagger-child');
                                children.forEach((child, childIndex) => {
                                    setTimeout(() => {
                                        child.classList.add('animate-in');
                                    }, childIndex * 100);
                                });
                            }, delay);
                        }
                    });
                }, { threshold: 0.1, rootMargin: '-30px' });
                
                document.querySelectorAll('.scroll-animate, .fade-in-up, .scale-in').forEach(el => {
                    observer.observe(el);
                });
            }
            
            addStaggerDelays() {
                const sections = document.querySelectorAll('section');
                sections.forEach((section, index) => {
                    const cards = section.querySelectorAll('.glass-card-advanced, .kpi-card-dark, .agent-card-dark');
                    cards.forEach((card, cardIndex) => {
                        card.dataset.stagger = cardIndex * 150;
                        card.classList.add('scroll-animate');
                        
                        // Marcar children para stagger
                        const children = card.querySelectorAll('p, h3, .counter-number');
                        children.forEach(child => child.classList.add('stagger-child'));
                    });
                });
            }
        }

        // ===== COUNTER OBSERVER =====
        const counterObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !entry.target.dataset.animated) {
                    entry.target.dataset.animated = 'true';
                    const config = counterTargets[entry.target.dataset.counter];
                    if (config) {
                        setTimeout(() => {
                            animateCounter(entry.target, config.target, config.duration, config.format);
                        }, parseInt(entry.target.dataset.delay) || 0);
                    } else {
                        // Legacy counter animation
                        const target = parseInt(entry.target.dataset.target);
                        const prefix = entry.target.dataset.prefix || '';
                        const suffix = entry.target.dataset.suffix || '';
                        setTimeout(() => {
                            animateCounter(entry.target, target, 2000, prefix + 'XXX' + suffix);
                        }, parseInt(entry.target.dataset.delay) || 0);
                    }
                }
            });
        }, { threshold: 0.5 });

        // ===== NAVIGATION BEHAVIOR ÉPICO =====
        class EpicNavigation {
            constructor() {
                this.nav = document.querySelector('.nav-dark');
                this.lastScrollY = 0;
                this.ticking = false;
                this.init();
            }
            
            init() {
                window.addEventListener('scroll', () => {
                    if (!this.ticking) {
                        requestAnimationFrame(() => {
                            this.updateNav();
                            this.ticking = false;
                        });
                        this.ticking = true;
                    }
                });
                
                // Active section highlighting
                this.highlightActiveSection();
            }
            
            updateNav() {
                const currentScrollY = window.scrollY;
                
                if (currentScrollY > 100) {
                    this.nav.style.backgroundColor = 'rgba(15, 23, 42, 0.95)';
                    this.nav.style.backdropFilter = 'blur(20px)';
                    this.nav.style.borderBottom = '1px solid rgba(59, 130, 246, 0.3)';
                    
                    if (currentScrollY < this.lastScrollY) {
                        // Scrolling up - show nav
                        this.nav.style.transform = 'translateY(0)';
                    } else {
                        // Scrolling down - hide nav
                        this.nav.style.transform = 'translateY(-100%)';
                    }
                } else {
                    this.nav.style.backgroundColor = 'rgba(15, 23, 42, 0.8)';
                    this.nav.style.borderBottom = '1px solid rgba(255, 255, 255, 0.1)';
                    this.nav.style.transform = 'translateY(0)';
                }
                
                this.lastScrollY = currentScrollY;
            }
            
            highlightActiveSection() {
                const sections = document.querySelectorAll('section[id]');
                const navLinks = document.querySelectorAll('.nav-link-dark');
                
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const id = entry.target.id;
                            navLinks.forEach(link => {
                                link.classList.remove('active');
                                if (link.getAttribute('href') === `#${id}`) {
                                    link.classList.add('active');
                                }
                            });
                        }
                    });
                }, { threshold: 0.3 });
                
                sections.forEach(section => observer.observe(section));
            }
        }

        // ===== INITIALIZE EPIC FEATURES =====
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize epic particle system
            const particleContainer = document.getElementById('particleContainer');
            if (particleContainer) {
                new EpicParticleSystem(particleContainer);
            }

            // Initialize epic scroll animations
            new EpicScrollAnimations();

            // Initialize epic counter animations
            new EpicCounterAnimator();

            // Initialize epic navigation
            new EpicNavigation();

            // Legacy counter observer for compatibility
            const counterElements = document.querySelectorAll('.counter-number, [data-target]');
            counterElements.forEach(el => counterObserver.observe(el));
        });

        // DEBUGGING SISTEMÁTICO - FUNCIÓN PARA INICIALIZAR CHARTS
        function initCharts() {
            console.log('=== DEBUGGING CHART.JS ===');
            console.log('Chart disponible:', typeof Chart);
            console.log('Chart.version:', Chart?.version);
            console.log('Chart.Chart:', typeof Chart?.Chart);
            
            if (typeof Chart === 'undefined') {
                console.error('Chart.js TODAVÍA no está disponible en initCharts');
                return;
            }

            // ===== EPIC CHART.JS DARK THEME CONFIGURATION =====
            const epicDarkChartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 3000,
                    easing: 'easeOutCubic',
                    delay: (context) => context.dataIndex * 200
                },
                plugins: {
                    legend: {
                        labels: {
                            color: '#f1f5f9',
                            font: { size: 16, weight: '600' },
                            padding: 25
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(15, 23, 42, 0.95)',
                        titleColor: '#ffffff',
                        bodyColor: '#f1f5f9',
                        borderColor: 'rgba(59, 130, 246, 0.5)',
                        borderWidth: 2,
                        cornerRadius: 12,
                        displayColors: true,
                        titleFont: { size: 16, weight: '700' },
                        bodyFont: { size: 14, weight: '500' }
                    }
                },
                scales: {
                    x: {
                        ticks: { 
                            color: '#cbd5e1',
                            font: { size: 14, weight: '500' }
                        },
                        grid: { 
                            color: 'rgba(255, 255, 255, 0.15)',
                            lineWidth: 1
                        }
                    },
                    y: {
                        ticks: { 
                            color: '#cbd5e1',
                            font: { size: 14, weight: '500' }
                        },
                        grid: { 
                            color: 'rgba(255, 255, 255, 0.15)',
                            lineWidth: 1
                        }
                    }
                }
            };
            
            // --- DATA ---
            const financialData = {
                labels: Array.from({ length: 12 }, (_, i) => `Mes ${i + 1}`),
                gastoEquipo: [110000, 125000, 125000, 125000, 125000, 125000, 125000, 125000, 125000, 125000, 125000, 115000],
                gastoDesarrollo: [190000, 210000, 257143, 250143, 250143, 250143, 230143, 230143, 230143, 193333, 193333, 199333],
                gastoCapex: [0, 0, 0, 0, 0, 876667, 876667, 876666, 0, 0, 0, 0],
                gastoTotal: [300000, 335000, 382143, 375143, 375143, 1251810, 1231810, 1231809, 355143, 318333, 318333, 324333],
                gastoAcumulado: [300000, 635000, 1017143, 1392286, 1767429, 3019239, 4251049, 5482858, 5837001, 6155334, 6473667, 6798000],
                efectivoRestante: [6960000, 6625000, 6242857, 5867714, 5492571, 4240761, 3008951, 1777142, 1422001, 1103668, 785335, 476002],
                inversionInicial: 7260000,
                reservaEmergencia: 476000
            };

            // ROI Comparison Data - Complete 5-year analysis
            const roiComparisonData = {
                years: ['Año 1', 'Año 2', 'Año 3', 'Año 4', 'Año 5'],
                tradicional: [3580000, 7339000, 11285950, 15430248, 19781760],
                iaNativo: [3140000, 3994700, 4892135, 5834442, 6823864],
                ahorros: [440000, 3344300, 6393815, 9595806, 12957896],
                details: {
                    inversionTecnologica: 2326000,
                    ahorroAnualRecurrente: 6300000,
                    roiFinalPorcentaje: 457,
                    paybackMeses: 20,
                    costoAnualTradicional: 3580000,
                    costoAnualIaNativo: 814000,
                    equipoTradicionalRequerido: "20+ personas",
                    equipoIaNativo: "4 agentes IA + 8 personas"
                }
            };
            
            const roiData = {
                tradicional: [3580000, 7339000, 11285950, 15430248, 19781760, 24349688, 29142857, 34170262, 39441270, 44965522, 50753042, 56814250],
                iaNativo: [3140000, 3994700, 4892135, 5834442, 6823864, 7862002, 8951634, 10095711, 11297366, 12560008, 13886339, 15279356],
                ahorros: []
            };
            
            // Calculate savings
            for(let i = 0; i < roiData.tradicional.length; i++) {
                roiData.ahorros.push(roiData.tradicional[i] - roiData.iaNativo[i]);
            }

            // Agent Details Data - Ultra-detailed version with tech stack and KPIs
            const agentDetails = {
                hase: {
                    title: 'HASE - Motor de Scoring Hiper-Adaptativo ($600,000)',
                    budget: {
                        softwareDesarrollo: 540000,
                        infraestructuraCloud: 50000,
                        licenciasMLOps: 10000
                    },
                    techStack: ['Python', 'XGBoost', 'scikit-learn', 'Apache Airflow (ETL)', 'FastAPI (<200ms)', 'SHAP (explicabilidad)', 'PostgreSQL', 'TimescaleDB', 'AWS/GCP GPUs'],
                    hours: {
                        total: 1440,
                        breakdown: [
                            { role: 'Científico Datos Senior', hours: 864, period: 'meses 1-4', focus: 'Líder desarrollo, ingesta datos, definición features, entrenamiento modelos' },
                            { role: 'Ingeniero ML', hours: 192, period: 'apoyo meses 2-3', focus: 'Entrenamiento modelos, validación, optimización hiperparámetros' },
                            { role: 'Backend Developer', hours: 384, period: 'APIs meses 3-4', focus: 'FastAPI deployment, integración microservicios, optimización latencia' }
                        ]
                    },
                    cronograma: [
                        { mes: 1, tarea: 'Ingesta datos históricos, definición features', hito: 'Pipeline ETL Apache Airflow funcional' },
                        { mes: 2, tarea: 'Entrenamiento modelos v0.5 con XGBoost', hito: 'Primeros modelos baseline >70% AUC' },
                        { mes: 3, tarea: 'HASE v0.8 optimizado >80% precisión AUC ✓', hito: 'Motor scoring validado offline con explicabilidad SHAP' },
                        { mes: 6, tarea: 'Optimización con datos piloto tiempo real', hito: 'Precisión >90% con streaming data PostgreSQL/TimescaleDB' }
                    ],
                    kpisTecnicos: [
                        'Precisión predicción >80% AUC (mes 3 offline)',
                        'Precisión >90% con datos piloto (mes 6)',
                        'Latencia API FastAPI <200ms constante',
                        'Pipeline ETL Apache Airflow 99.5% uptime',
                        'Explicabilidad SHAP integrada cumplimiento regulatorio',
                        'Escalabilidad AWS/GCP para 1000+ requests/min'
                    ]
                },
                
                pia: {
                    title: 'PIA - Agente Intervención Proactiva ($400,000)',
                    budget: {
                        softwareDesarrollo: 310000,
                        licenciasApis: 75000,
                        infraestructura: 15000
                    },
                    techStack: ['WhatsApp Business API', 'Twilio SMS backup', 'LLMs afinados empáticos', 'Decision Trees escalamiento', 'FastAPI', 'Redis queue', 'Microservicios'],
                    hours: {
                        total: 976,
                        breakdown: [
                            { role: 'Ingeniero ML', hours: 480, period: 'líder desarrollo', focus: 'Motor alertas, LLM training, lógica escalamiento automático' },
                            { role: 'Backend Developer', hours: 240, period: 'APIs integración', focus: 'WhatsApp Business API, Twilio integration, Redis queue management' },
                            { role: 'Full-Stack', hours: 256, period: 'integración frontend', focus: 'Dashboard alertas, UX operadores, monitoring tools' }
                        ]
                    },
                    cronograma: [
                        { mes: 2, tarea: 'Desarrollo motor alertas + arquitectura microservicios', hito: 'Sistema alertas básico funcional' },
                        { mes: 4, tarea: 'Integración WhatsApp Business API + LLMs', hito: 'Mensajes automáticos empáticos funcionales' },
                        { mes: 5, tarea: 'PIA v1.0 con Decision Trees escalamiento', hito: 'Sistema intervención completo + Redis queue optimizada' },
                        { mes: 6, tarea: 'Validación piloto + optimización respuesta', hito: 'Latencia <2min alertas críticas + Twilio backup activo' }
                    ],
                    kpisTecnicos: [
                        'API WhatsApp Business integrada y certificada',
                        'Motor alertas tiempo real <2min latencia SLA',
                        'Cola mensajes Redis optimizada >1000 msg/min',
                        'Decision Trees escalamiento automático funcional',
                        'LLMs afinados mensajes empáticos >85% satisfacción',
                        'Backup Twilio SMS 99.9% reliability',
                        'Microservicios architecture deployed'
                    ]
                },

                superpma: {
                    title: 'Super-PMA - Mantenimiento Predictivo + Marketplace ($450,000)',
                    budget: {
                        softwareDesarrollo: 350000,
                        infraestructuraStreaming: 60000,
                        hardwareDesarrollo: 20000,
                        licenciasIoT: 20000
                    },
                    techStack: ['RandomForest', 'XGBoost series temporales', 'Apache Kafka streaming', 'React marketplace', 'OBD-II sensores', 'GPS tracking', 'Acelerómetros', 'Medidores flujo GNV', 'PostgreSQL IoT', 'InfluxDB'],
                    hours: {
                        total: 1024,
                        breakdown: [
                            { role: 'IoT Engineer', hours: 768, period: 'líder hardware/streaming', focus: 'Sensores installation, Kafka pipeline, streaming optimization, hardware troubleshooting' },
                            { role: 'Científico Datos', hours: 96, period: 'modelos predictivos', focus: 'Algoritmos predicción fallas, series temporales, anomaly detection' },
                            { role: 'Full-Stack', hours: 160, period: 'marketplace MVP', focus: 'Plataforma proveedores, sistema comisiones, APIs integración' }
                        ]
                    },
                    cronograma: [
                        { mes: 3, tarea: 'Diseño integración IoT + setup Apache Kafka', hito: 'Arquitectura streaming datos definida + sensores seleccionados' },
                        { mes: 6, tarea: 'Instalación hardware primera vagoneta + streaming', hito: 'Datos tiempo real OBD-II/GPS flowing a Kafka + InfluxDB' },
                        { mes: 7, tarea: 'Modelos predictivos + marketplace básico React', hito: 'RandomForest/XGBoost trained + MVP marketplace funcional' },
                        { mes: 8, tarea: 'Optimización completa + 3 vagonetas streaming', hito: 'Sistema completo validado + marketplace generando comisiones' }
                    ],
                    kpisTecnicos: [
                        'Apache Kafka streaming >1000 events/sec sin pérdida datos',
                        'Sensores OBD-II/GPS transmitiendo 99.5% uptime',
                        'Modelos RandomForest/XGBoost >85% precisión predicción fallas',
                        'InfluxDB time-series optimizada <100ms query latency',
                        'Marketplace React APIs <500ms response time',
                        'Pipeline ML predicción fallas automated retraining',
                        'IoT devices management platform operational'
                    ],
                    monetization: [
                        'Comisiones marketplace: 15-20% transacciones automatizadas',
                        'Ingresos objetivo: >$300 MXN/vehículo/mes validado',
                        'Reducción costos mantenimiento: ~25% medido vs baseline',
                        'Reducción downtime: 30-50% vs mantenimiento reactivo'
                    ]
                },

                asistente: {
                    title: 'Asistente Digital 24/7 + Diagnósticos Premium ($250,000)',
                    budget: {
                        softwareDesarrollo: 180000,
                        licenciasApis: 55000,
                        infraestructura: 15000
                    },
                    techStack: ['GPT-4 Vision', 'Claude 3 análisis imagen', 'Make/n8n orquestación', 'BERT español NLP', 'WhatsApp chatbot', 'Base conocimiento vectorizada', 'Pinecone/Chroma vector DB'],
                    hours: {
                        total: 1024,
                        breakdown: [
                            { role: 'Ingeniero ML', hours: 320, period: 'núcleo NLP/CV', focus: 'Chatbot core, GPT-4 Vision integration, BERT fine-tuning español, vector embeddings' },
                            { role: 'Full-Stack', hours: 224, period: 'integración sistemas', focus: 'APIs integration, base conocimiento, Make/n8n workflows, vector DB setup' },
                            { role: 'Frontend', hours: 480, period: 'interfaz usuario', focus: 'WhatsApp UX optimization, dashboard diagnósticos, mobile-first design' }
                        ]
                    },
                    cronograma: [
                        { mes: 4, tarea: 'Desarrollo chatbot core + base conocimiento', hito: 'BERT español fine-tuned + 50+ escenarios vectorizados' },
                        { mes: 6, tarea: 'GPT-4 Vision + diagnóstico por texto funcional', hito: 'Multimodal analysis operational + Make/n8n workflows active' },
                        { mes: 7, tarea: 'Análisis imagen avanzado + WhatsApp optimization', hito: 'Computer vision diagnósticos >80% precisión' },
                        { mes: 8, tarea: 'MVP multimodal completo + servicios premium', hito: 'Sistema 24/7 operacional + monetización premium activa' }
                    ],
                    kpisTecnicos: [
                        'GPT-4 Vision API integrada + <3sec response time',
                        'Base conocimiento vectorizada 50+ escenarios searchable',
                        'Chatbot BERT español >90% intent classification accuracy',
                        'Make/n8n workflows automatizados 99.5% success rate',
                        'WhatsApp integration 24/7 uptime SLA',
                        'Vector DB Pinecone/Chroma <200ms similarity search',
                        'Multimodal analysis pipeline functional'
                    ],
                    serviciosPremium: [
                        'Diagnósticos técnicos premium: $500-$800 MXN/consulta',
                        'Automatización: ~70% consultas resueltas sin humano',
                        'Disponibilidad: 24/7 vía WhatsApp con SLA <2min',
                        'Análisis imágenes: Computer vision para fotos fallas/desgaste'
                    ]
                }
            };

            // Detailed Operational Phase Data - GTM + REPUVE/SEMARNAT corrected
            const fasesOperativasCorregidas = {
                1: {
                    periodo: 'Meses 1-3: Fundación y Preparación',
                    color: '#10b981',
                    tareas: {
                        gtm: 'Go-To-Market: Identificación y pre-calificación operadores piloto (red 24,000+ contactos, criterios riesgo establecidos)',
                        legal: 'Trámites REPUVE (Registro Público Vehicular) y SEMARNAT (permisos conversión GNV) - críticos para operación legal',
                        piloto: 'Compra 3 vagonetas para conversión GNV + selección talleres certificados aliados',
                        tecnico: 'HASE v0.8 entrenado >80% precisión + infraestructura cloud + SaaS backbone desplegado'
                    },
                    kpis: [
                        '100% operadores piloto pre-seleccionados y validados ✓',
                        'Trámites REPUVE y SEMARNAT iniciados (documentación completa) ✓',
                        'Equipo técnico 100% operativo + SaaS enterprise-grade funcionando ✓',
                        'Infraestructura AWS/GCP + security SOC2-ready desplegada ✓'
                    ]
                },
                2: {
                    periodo: 'Meses 4-6: Desarrollo y Despliegue',
                    color: '#3b82f6',
                    tareas: {
                        gtm: 'Go-To-Market: Firma contratos operadores piloto + onboarding inicial programa',
                        legal: 'Validación cumplimiento PLD (Prevención Lavado Dinero) + obtención final REPUVE/SEMARNAT',
                        piloto: 'Instalación hardware IoT completo + despliegue 1ra vagoneta con streaming datos',
                        tecnico: 'PIA funcional WhatsApp + SaaS completamente integrado + App Android MVP operativa'
                    },
                    kpis: [
                        '3 contratos piloto firmados con operadores validados ✓',
                        'REPUVE y SEMARNAT obtenidos (vagonetas legalmente operativas) ✓',
                        '1ra vagoneta transmitiendo datos IoT tiempo real a Kafka ✓',
                        'MVP tecnológico + SaaS stack desplegado en producción ✓'
                    ]
                },
                3: {
                    periodo: 'Meses 7-9: Validación y Recolección Datos',
                    color: '#8b5cf6',
                    tareas: {
                        gtm: 'Go-To-Market: Onboarding completo + soporte continuo operadores + feedback loops',
                        legal: 'Auditoría cumplimiento interno + preparación políticas corporativas + compliance monitoring',
                        piloto: '3 vagonetas operando completamente + monitoreo 24/7 + optimización performance',
                        tecnico: 'Ecosistema 4 agentes IA 100% funcional + marketplace generando ingresos + optimización ML models'
                    },
                    kpis: [
                        '3 vagonetas >95% tiempo activo (uptime monitoreado) ✓',
                        'NPS operadores >50 (satisfacción validada) ✓',
                        'Primeros ingresos marketplace Super-PMA documentados ✓',
                        'Morosidad piloto = 0% (objetivo crítico mantenido) ✓'
                    ]
                },
                4: {
                    periodo: 'Meses 10-12: Tracción y Preparación Serie A',
                    color: '#f59e0b',
                    tareas: {
                        gtm: 'Go-To-Market: Documentación casos éxito + testimoniales + métricas tracción + pipeline comercial',
                        legal: 'Data room S.A.P.I. 100% completo + documentación corporativa + compliance histórico auditado',
                        piloto: 'Análisis final economía unitaria + reportes performance + ROI validado con datos reales',
                        tecnico: 'Documentación técnica completa + arquitectura escalable + roadmap post-Serie A definido'
                    },
                    kpis: [
                        'Morosidad final piloto 0% (track record impecable) ✓',
                        'NPS operadores >70 (alta satisfacción comprobada) ✓',
                        'Data room legal y financiero 100% completo para due diligence ✓',
                        'Term sheet Serie A $45M MXN en negociación avanzada ✓'
                    ]
                }
            };

            // HR Matrix Completa - 8 roles x 12 months with ESOP CORRECTED
            const hrMatrixCompleta = {
                roles: [
                    { name: 'Científico de Datos', type: 'ESOP', foco: 'HASE líder + Super-PMA modelos + optimización ML', totalHours: 1440 },
                    { name: 'Ingeniero ML', type: 'ESOP', foco: 'PIA líder + Asistente NLP/CV + LLMs fine-tuning', totalHours: 1200 },
                    { name: 'Full-Stack Developer', type: 'ESOP', foco: 'SaaS arquitecto + integración general + APIs core', totalHours: 1200 },
                    { name: 'Backend Developer', type: 'Contratista', foco: 'APIs Core IA + SaaS connectors + microservicios', totalHours: 960 },
                    { name: 'IoT Engineer', type: 'Contratista', foco: 'Sensores + Kafka streaming + hardware troubleshooting', totalHours: 1024 },
                    { name: 'Frontend Developer', type: 'Contratista', foco: 'App móvil + dashboards + UX optimization', totalHours: 720 },
                    { name: 'DevOps Engineer', type: 'Contratista', foco: 'Infrastructure + SaaS deployment + CI/CD + security', totalHours: 480 },
                    { name: 'QA Engineer', type: 'Contratista', foco: 'Testing Core IA + SaaS integration + automation', totalHours: 384 }
                ],
                allocations: [
                    // Científico de Datos (ESOP) - 12 meses
                    ['HASE (70%) SaaS-Setup (30%)', 'HASE (60%) SaaS-Integration (40%)', 'HASE (80%) Super-PMA (20%)', 'Super-PMA (80%) HASE (20%)', 'Super-PMA (100%)', 'Super-PMA (100%)', 'Análisis Piloto (HASE, PMA)', 'Análisis Piloto (HASE, PMA)', 'Optimización Modelos ML', 'Documentación (Modelos)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    
                    // Ingeniero ML (ESOP) - 12 meses  
                    ['HASE (100%)', 'PIA (50%) HASE (50%)', 'PIA (80%) Asistente (20%)', 'PIA (70%) Asistente (30%)', 'PIA (100%)', 'Asistente (70%) PIA (30%)', 'Asistente (100%)', 'Análisis Piloto (PIA, Asistente)', 'Optimización Modelos IA', 'Documentación (IA)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    
                    // Full-Stack Developer (ESOP) - 12 meses
                    ['SaaS (100%)', 'SaaS (80%) PIA (20%)', 'SaaS (50%) PIA (50%)', 'Asistente (50%) PMA (50%)', 'Asistente (50%) PMA (50%)', 'Integración Piloto', 'Soporte Piloto', 'Optimización General', 'Soporte GTM', 'Soporte (Serie A)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    
                    // Backend Developer (Contratista) - 12 meses
                    ['-', 'HASE (API) SaaS-Integration', 'HASE (API) SaaS-Optimization', 'PIA (API)', 'PIA (API)', 'Integración General SaaS', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Backend', 'Documentación API', 'Mantenimiento', 'Mantenimiento'],
                    
                    // IoT Engineer (Contratista) - 12 meses
                    ['-', 'Super-PMA (HW)', 'Super-PMA (HW)', 'Super-PMA (Streaming)', 'Super-PMA (Streaming)', 'Despliegue Piloto', 'Monitoreo Piloto', 'Monitoreo Piloto', 'Optimización Datos', 'Documentación HW', 'Mantenimiento', 'Mantenimiento'],
                    
                    // Frontend Developer (Contratista) - 10 meses activo
                    ['-', '-', 'App (UI/UX)', 'App (Dashboard)', 'App (Backend Connect)', 'App (QA)', 'App (Feedback)', 'App (Feedback)', 'App (Ajustes)', 'Finalización App', '-', 'Soporte (Serie A)'],
                    
                    // DevOps Engineer (Contratista) - 8 meses activo
                    ['Infra (Cloud, CI/CD) SaaS-Setup', 'Infra (DBs) SaaS-Config', 'Infra (Seguridad) SOC2', 'Monitoreo SaaS', 'Monitoreo SaaS', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Infra', '-', '-', '-', '-'],
                    
                    // QA Engineer (Contratista) - 7 meses activo
                    ['-', '-', '-', '-', '-', 'Pruebas (Carga) SaaS-IA', 'Pruebas (Piloto)', 'Pruebas (Piloto)', 'Pruebas (Regresión)', 'Documentación QA', '-', '-']
                ]
            };

            // Presupuesto por Capas Ultra-Detallado
            const presupuestoCapasDetallado = {
                coreIA: {
                    total: 1890000,
                    hase: {
                        software: 540000, // Científico Datos 864h + ML 192h + Backend 384h
                        infraestructura: 50000, // AWS/GCP GPUs + PostgreSQL/TimescaleDB
                        licencias: 10000, // MLflow versionamiento modelos
                        total: 600000
                    },
                    pia: {
                        software: 310000, // ML 480h + Backend 240h + Full-Stack 256h  
                        licenciasApis: 75000, // WhatsApp Business + Twilio + LLMs
                        infraestructura: 15000, // hosting servicios intervención
                        total: 400000
                    },
                    superpma: {
                        software: 350000, // IoT 768h + Científico Datos 96h + Full-Stack 160h
                        infraestructuraStreaming: 60000, // Apache Kafka tempo real
                        hardwareDesarrollo: 20000, // sensores OBD-II, GPS, acelerómetros
                        licenciasIoT: 20000, // gestión dispositivos
                        total: 450000
                    },
                    asistente: {
                        software: 180000, // ML 320h + Full-Stack 224h + Frontend 480h
                        licenciasApis: 55000, // GPT-4 Vision, Claude 3, Make/n8n
                        infraestructura: 15000, // hosting chatbot
                        total: 250000
                    },
                    integracionSaaS: {
                        software: 190000, // Backend + Full-Stack conectores APIs
                        total: 190000
                    }
                },
                saasOperativo: {
                    total: 436000,
                    odooEnterprise: {
                        costo: 216000,
                        descripcion: 'ERP completo: Contabilidad, Finanzas, Inventario, Proyectos, RRHH',
                        implementacion: 'Meses 1-3: Setup + configuración. Meses 4-12: Operación completa'
                    },
                    financialAI: {
                        costo: 120000,
                        descripcion: 'Stripe (pagos), Xero (contabilidad NIIF), DocuSign (contratos)',
                        implementacion: 'Mes 2: Integración APIs. Mes 4+: Procesamiento transacciones piloto'
                    },
                    seguridadEmpresarial: {
                        costo: 60000,
                        descripcion: 'Auth0 (identidad), SOC2-ready security stack, monitoring',
                        implementacion: 'Mes 1: Deployment. Mes 3: Hardening. Ongoing: Compliance'
                    },
                    comunicacionBasica: {
                        costo: 40000,
                        descripcion: 'Slack, Google Workspace, herramientas colaboración',
                        implementacion: 'Mes 1: Setup. Mes 2+: Productividad equipo'
                    }
                }
            };

            // CAPEX Vagonetas Detallado (sin marca específica)
            const capexVagonetasDetallado = {
                costoUnidad: 876667,
                desglose: {
                    vagoneta: 730000, // Vagoneta para conversión GNV (sin especificar marca)
                    hardwareIoT: 100000, // Sensores telemáticos, GPS, OBD-II, medidores flujo GNV, acelerómetros
                    seguroLegal: 46667 // Seguro cobertura amplia, registro REPUVE, formalización contrato
                },
                cronograma: [
                    { 
                        mes: 6, 
                        unidad: 1, 
                        monto: 876667,
                        descripcion: 'Primera vagoneta + kit IoT completo + instalación sensores + seguros',
                        hito: 'Streaming datos tiempo real iniciado'
                    },
                    { 
                        mes: 7, 
                        unidad: 2, 
                        monto: 876667,
                        descripcion: 'Segunda vagoneta + instalación sensores + validación sistema',
                        hito: 'Piloto expandido 2 unidades operativas'
                    },
                    { 
                        mes: 8, 
                        unidad: 3, 
                        monto: 876666,
                        descripcion: 'Tercera vagoneta + validación completa ecosistema',
                        hito: 'Piloto completo 3 unidades + economía unitaria validada'
                    }
                ],
                especificacionesHardware: {
                    sensoresTelemáticos: 'OBD-II para diagnósticos motor + transmisión',
                    gps: 'Tracking tiempo real + geofencing + optimización rutas',
                    medidoresGNV: 'Flujo combustible + eficiencia + alertas nivel',
                    acelerómetros: 'Comportamiento conductor + mantenimiento predictivo',
                    conectividad: 'LTE/4G + backup 3G + WiFi hotspot opcional'
                }
            };

            // Estructura Legal Completa
            const estructuraLegalCompleta = {
                entidadLegal: {
                    razonSocial: 'CONDUCTORES DEL MUNDO S.A.P.I. de C.V.',
                    rfc: 'CMU201119DD6',
                    fechaConstitucion: '19 noviembre 2020',
                    modificacionObjeto: '24 julio 2025 (ampliación actividades IA/ML)'
                },
                objetoSocialDetallado: [
                    'Operaciones financiamiento activos y servicios (leasing vagonetas)',
                    'Servicios movilidad y transporte como servicio (MaaS)',
                    'Desarrollo y comercialización soluciones IA/ML propietarias',
                    'Sistemas computacionales y tecnológicos especializados',
                    'Recopilación, procesamiento y administración datos telemáticos',
                    'Marketplace digital servicios mantenimiento y refacciones',
                    'Consultoría tecnológica sector transporte y movilidad'
                ],
                cumplimientoRegulatorio: [
                    'Políticas PLD (Prevención Lavado Dinero) implementadas y auditadas ✓',
                    'Normativas Ley Fintech aplicables (no requiere autorización CNBV para modelo actual) ✓',
                    'REPUVE (Registro Público Vehicular) obligatorio para vagonetas GNV en proceso ✓',
                    'SEMARNAT permisos conversión GNV y emisiones en trámite ✓',
                    'Preparación SOC2-ready desde día 1 (security compliance) ✓',
                    'Contratos operadores B2B (NO requieren registro PROFECO) ✓'
                ],
                estructuraCorporativa: {
                    tipoSociedad: 'S.A.P.I. de C.V. (Sociedad Anónima Promotora de Inversión)',
                    ventajas: [
                        'Flexibilidad para inversionistas institucionales',
                        'Estructura equity/debt óptima para venture capital',
                        'Gobierno corporativo escalable para Serie A',
                        'Régimen fiscal favorable para reinversión utilidades'
                    ],
                    preparacionSerieA: [
                        'Data room legal 100% completo mes 11',
                        'Auditorías financieras trimestrales implementadas',
                        'Board structure preparada para independientes',
                        'Compliance histórico documentado para due diligence'
                    ]
                }
            };

            // Glosario para Tooltips
            const glosarioTerminos = {
                'GTM': 'Go-To-Market: Estrategia de lanzamiento al mercado y adquisición de clientes objetivo',
                'REPUVE': 'Registro Público Vehicular: Trámite obligatorio SEMARNAT para vehículos conversión GNV',
                'SEMARNAT': 'Secretaría Medio Ambiente: Permisos oficiales conversión GNV y verificación emisiones',
                'PLD': 'Prevención Lavado Dinero: Políticas compliance para operaciones financieras',
                'ESOP': 'Employee Stock Ownership Plan: Programa participación accionaria empleados clave',
                'AUC': 'Area Under Curve: Métrica precisión modelos machine learning (0-1, >0.8 excelente)',
                'SLA': 'Service Level Agreement: Compromisos tiempo respuesta y disponibilidad sistema',
                'SOC2': 'System Organization Controls 2: Estándar auditoría seguridad datos enterprise',
                'API': 'Application Programming Interface: Interfaz comunicación entre sistemas software',
                'IoT': 'Internet of Things: Red dispositivos conectados transmitiendo datos tiempo real',
                'MLOps': 'Machine Learning Operations: Prácticas despliegue y mantenimiento modelos IA',
                'NLP': 'Natural Language Processing: Procesamiento lenguaje natural para chatbots',
                'Computer Vision': 'Visión computacional: IA para análisis automático imágenes/video'
            };

            // Detailed Phase Data (for backwards compatibility)
            const phaseDetails = {
                1: {
                    title: 'Meses 1-3: Fundación y Preparación',
                    tasks: [
                        'Go-To-Market: Identificación y pre-calificación operadores piloto (red 24,000+ contactos, criterios riesgo establecidos)',
                        'Legal: Trámites REPUVE (Registro Público Vehicular) y SEMARNAT (permisos conversión GNV) - críticos para operación legal',
                        'Piloto: Compra 3 vagonetas para conversión GNV + selección talleres certificados aliados',
                        'Técnico: HASE v0.8 entrenado >80% precisión + infraestructura cloud + SaaS backbone desplegado'
                    ],
                    kpis: [
                        '100% operadores piloto pre-seleccionados y validados ✓',
                        'Trámites REPUVE y SEMARNAT iniciados (documentación completa) ✓',
                        'Equipo técnico 100% operativo + SaaS enterprise-grade funcionando ✓',
                        'Infraestructura AWS/GCP + security SOC2-ready desplegada ✓'
                    ]
                },
                2: {
                    title: 'Meses 4-6: Desarrollo y Despliegue',
                    tasks: [
                        'Go-To-Market: Firma contratos operadores piloto + onboarding inicial programa',
                        'Legal: Validación cumplimiento PLD (Prevención Lavado Dinero) + obtención final REPUVE/SEMARNAT',
                        'Piloto: Instalación hardware IoT completo + despliegue 1ra vagoneta con streaming datos',
                        'Técnico: PIA funcional WhatsApp + SaaS completamente integrado + App Android MVP operativa'
                    ],
                    kpis: [
                        '3 contratos piloto firmados con operadores validados ✓',
                        'REPUVE y SEMARNAT obtenidos (vagonetas legalmente operativas) ✓',
                        '1ra vagoneta transmitiendo datos IoT tiempo real a Kafka ✓',
                        'MVP tecnológico + SaaS stack desplegado en producción ✓'
                    ]
                },
                3: {
                    title: 'Meses 7-9: Validación y Recolección de Datos',
                    tasks: [
                        'Go-To-Market: Onboarding completo + soporte continuo operadores + feedback loops',
                        'Legal: Auditoría cumplimiento interno + preparación políticas corporativas + compliance monitoring',
                        'Piloto: 3 vagonetas operando completamente + monitoreo 24/7 + optimización performance',
                        'Técnico: Ecosistema 4 agentes IA 100% funcional + marketplace generando ingresos + optimización ML models'
                    ],
                    kpis: [
                        '3 vagonetas >95% tiempo activo (uptime monitoreado) ✓',
                        'NPS operadores >50 (satisfacción validada) ✓',
                        'Primeros ingresos marketplace Super-PMA documentados ✓',
                        'Morosidad piloto = 0% (objetivo crítico mantenido) ✓'
                    ]
                },
                4: {
                    title: 'Meses 10-12: Tracción y Preparación Serie A',
                    tasks: [
                        'Go-To-Market: Documentación casos éxito + testimoniales + métricas tracción + pipeline comercial',
                        'Legal: Data room S.A.P.I. 100% completo + documentación corporativa + compliance histórico auditado',
                        'Piloto: Análisis final economía unitaria + reportes performance + ROI validado con datos reales',
                        'Técnico: Documentación técnica completa + arquitectura escalable + roadmap post-Serie A definido'
                    ],
                    kpis: [
                        'Morosidad final piloto 0% (track record impecable) ✓',
                        'NPS operadores >70 (alta satisfacción comprobada) ✓',
                        'Data room legal y financiero 100% completo para due diligence ✓',
                        'Term sheet Serie A $45M MXN en negociación avanzada ✓'
                    ]
                }
            };

            // Enhanced HR Data with detailed monthly assignments (for backwards compatibility)
            const enhancedHrData = {
                roles: ['Científico de Datos', 'Ingeniero de ML', 'Desarrollador Full-Stack', 'Desarrollador Backend', 'Desarrollador IoT', 'Desarrollador Frontend', 'Ingeniero DevOps', 'Ingeniero QA'],
                allocations: [
                    ['HASE (70%) SaaS-Setup (30%)', 'HASE (60%) SaaS-Integration (40%)', 'HASE (80%) Super-PMA (20%)', 'Super-PMA (80%) HASE (20%)', 'Super-PMA (100%)', 'Super-PMA (100%)', 'Análisis Piloto (HASE, PMA)', 'Análisis Piloto (HASE, PMA)', 'Optimización Modelos ML', 'Documentación (Modelos)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['HASE (100%)', 'PIA (50%) HASE (50%)', 'PIA (80%) Asistente (20%)', 'PIA (70%) Asistente (30%)', 'PIA (100%)', 'Asistente (70%) PIA (30%)', 'Asistente (100%)', 'Análisis Piloto (PIA, Asistente)', 'Optimización Modelos IA', 'Documentación (IA)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['SaaS (100%)', 'SaaS (80%) PIA (20%)', 'SaaS (50%) PIA (50%)', 'Asistente (50%) PMA (50%)', 'Asistente (50%) PMA (50%)', 'Integración Piloto', 'Soporte Piloto', 'Optimización General', 'Soporte GTM', 'Soporte (Serie A)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['-', 'HASE (API) SaaS-Integration', 'HASE (API) SaaS-Optimization', 'PIA (API)', 'PIA (API)', 'Integración General SaaS', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Backend', 'Documentación API', 'Mantenimiento', 'Mantenimiento'],
                    ['-', 'Super-PMA (HW)', 'Super-PMA (HW)', 'Super-PMA (Streaming)', 'Super-PMA (Streaming)', 'Despliegue Piloto', 'Monitoreo Piloto', 'Monitoreo Piloto', 'Optimización Datos', 'Documentación HW', 'Mantenimiento', 'Mantenimiento'],
                    ['-', '-', 'App (UI/UX)', 'App (Dashboard)', 'App (Backend Connect)', 'App (QA)', 'App (Feedback)', 'App (Feedback)', 'App (Ajustes)', 'Finalización App', '-', 'Soporte (Serie A)'],
                    ['Infra (Cloud, CI/CD) SaaS-Setup', 'Infra (DBs) SaaS-Config', 'Infra (Seguridad) SOC2', 'Monitoreo SaaS', 'Monitoreo SaaS', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Infra', '-', '-', '-', '-'],
                    ['-', '-', '-', '-', '-', 'Pruebas (Carga) SaaS-IA', 'Pruebas (Piloto)', 'Pruebas (Piloto)', 'Pruebas (Regresión)', 'Documentación QA', '-', '-']
                ],
                esopRoles: ['Científico de Datos', 'Ingeniero de ML', 'Desarrollador Full-Stack'],
                totalHours: [1440, 1200, 1200, 960, 1024, 720, 480, 384]
            };

            // Financial data is now pre-calculated with exact values

            // INVESTMENT DONUT CHART - COLORES ÉPICOS CON GLOW
            const investmentDataEpic = {
                labels: ['Desarrollo Core IA + SaaS', 'Inversión Piloto (CAPEX)', 'Equipo y Operaciones', 'Reserva de Emergencia'],
                datasets: [{
                    data: [2326000, 2630000, 1828000, 476000],
                    backgroundColor: [
                        'rgba(16, 185, 129, 0.8)',  // Teal con transparencia
                        'rgba(59, 130, 246, 0.8)',  // Blue con transparencia  
                        'rgba(139, 92, 246, 0.8)',  // Purple con transparencia
                        'rgba(245, 158, 11, 0.8)'   // Orange con transparencia
                    ],
                    borderColor: [
                        'rgba(16, 185, 129, 1)',
                        'rgba(59, 130, 246, 1)', 
                        'rgba(139, 92, 246, 1)',
                        'rgba(245, 158, 11, 1)'
                    ],
                    borderWidth: 3,
                    hoverBorderWidth: 5,
                    hoverBorderColor: '#ffffff'
                }]
            };
            
            const techTimelineData = [
                { category: 'HASE (Motor Scoring)', start: 1, end: 3, color: '#10b981', tasks: 'Mes 1: Ingesta datos + Apache Airflow. Mes 2: XGBoost training v0.5. Mes 3: HASE v0.8 >80% AUC + SHAP explicabilidad.', milestone: 'Hito: Motor scoring validado offline con FastAPI <200ms.' },
                { category: 'SaaS Backbone Empresarial', start: 1, end: 6, color: '#0d9488', tasks: 'Mes 1-2: Odoo ERP + Auth0 security. Mes 3-4: Stripe/Xero + CI/CD. Mes 5-6: Integración completa + SOC2-ready.', milestone: 'Hito: Stack empresarial operativo + seguridad institucional.' },
                { category: 'PIA (Intervención Proactiva)', start: 2, end: 5, color: '#0f766e', tasks: 'Mes 2: Motor alertas + arquitectura. Mes 4: WhatsApp API + LLMs. Mes 5: Decision Trees + Redis queue optimizada.', milestone: 'Hito: Sistema intervención <2min latencia + backup Twilio.' },
                { category: 'Super-PMA (Predictivo + Marketplace)', start: 3, end: 8, color: '#115e59', tasks: 'Mes 3: Kafka + IoT design. Mes 6: Sensores streaming. Mes 7: RandomForest + React marketplace. Mes 8: 3 vagonetas validadas.', milestone: 'Hito: Marketplace funcional + modelos predictivos >85% precisión.' },
                { category: 'Asistente Digital 24/7', start: 4, end: 8, color: '#134e4a', tasks: 'Mes 4: BERT español + base conocimiento. Mes 6: GPT-4 Vision. Mes 7: Computer vision. Mes 8: Servicios premium.', milestone: 'Hito: Sistema multimodal 24/7 + monetización premium activa.' },
                { category: 'Optimización & Preparación Serie A', start: 9, end: 12, color: '#f59e0b', tasks: 'Mes 9-10: Refinamiento 4 agentes + análisis datos piloto. Mes 11-12: Documentación técnica + roadmap Serie A.', milestone: 'Hito: Platform stable + term sheet $45M en negociación.' }
            ];

            const opsTimelineData = [
                { phase: 'Meses 1-3: Fundación y Preparación', color: '#0d9488', tasks: 'Go-To-Market: Identificación y pre-calificación operadores piloto (red 24,000+ contactos, criterios riesgo establecidos).\nLegales: Trámites REPUVE (Registro Público Vehicular) y SEMARNAT (permisos conversión GNV) - críticos para operación legal.\nPiloto: Compra 3 vagonetas para conversión GNV + selección talleres certificados aliados.\nProducto: HASE v0.8 entrenado >80% precisión + infraestructura cloud + SaaS backbone desplegado.', kpi: 'KPI: 100% operadores piloto pre-seleccionados y validados. Trámites REPUVE/SEMARNAT iniciados (documentación completa). Equipo técnico 100% operativo + SaaS enterprise-grade funcionando.' },
                { phase: 'Meses 4-6: Desarrollo y Despliegue', color: '#0f766e', tasks: 'Go-To-Market: Firma contratos operadores piloto + onboarding inicial programa.\nLegales: Validación cumplimiento PLD (Prevención Lavado Dinero) + obtención final REPUVE/SEMARNAT.\nPiloto: Instalación hardware IoT completo + despliegue 1ra vagoneta con streaming datos.\nProducto: PIA funcional WhatsApp + SaaS completamente integrado + App Android MVP operativa.', kpi: 'KPI: 3 contratos piloto firmados con operadores validados. REPUVE y SEMARNAT obtenidos (vagonetas legalmente operativas). 1ra vagoneta transmitiendo datos IoT tiempo real a Kafka.' },
                { phase: 'Meses 7-9: Validación y Recolección de Datos', color: '#115e59', tasks: 'Go-To-Market: Onboarding completo + soporte continuo operadores + feedback loops.\nLegales: Auditoría cumplimiento interno + preparación políticas corporativas + compliance monitoring.\nPiloto: 3 vagonetas operando completamente + monitoreo 24/7 + optimización performance.\nProducto: Ecosistema 4 agentes IA 100% funcional + marketplace generando ingresos + optimización ML models.', kpi: 'KPI: 3 vagonetas >95% tiempo activo (uptime monitoreado). NPS operadores >50 (satisfacción validada). Primeros ingresos marketplace Super-PMA documentados. Morosidad piloto = 0% (objetivo crítico mantenido).' },
                { phase: 'Meses 10-12: Tracción y Preparación Serie A', color: '#f59e0b', tasks: 'Go-To-Market: Documentación casos éxito + testimoniales + métricas tracción + pipeline comercial.\nLegales: Data room S.A.P.I. 100% completo + documentación corporativa + compliance histórico auditado.\nPiloto: Análisis final economía unitaria + reportes performance + ROI validado con datos reales.\nProducto: Documentación técnica completa + arquitectura escalable + roadmap post-Serie A definido.', kpi: 'KPI: Morosidad final piloto 0% (track record impecable). NPS operadores >70 (alta satisfacción comprobada). Data room legal y financiero 100% completo para due diligence. Term sheet Serie A $45M MXN en negociación avanzada.' }
            ];

            const hrData = {
                roles: ['Científico de Datos', 'Ingeniero de ML', 'Desarrollador Full-Stack', 'Desarrollador Backend', 'Desarrollador IoT', 'Desarrollador Frontend', 'Ingeniero DevOps', 'Ingeniero QA'],
                allocations: [
                    ['HASE (70%) SaaS-Setup (30%)', 'HASE (60%) SaaS-Integration (40%)', 'HASE (80%) Super-PMA (20%)', 'Super-PMA (80%) HASE (20%)', 'Super-PMA (100%)', 'Super-PMA (100%)', 'Análisis Piloto (HASE, PMA)', 'Análisis Piloto (HASE, PMA)', 'Optimización Modelos ML', 'Documentación (Modelos)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['HASE (100%)', 'PIA (50%) HASE (50%)', 'PIA (80%) Asistente (20%)', 'PIA (70%) Asistente (30%)', 'PIA (100%)', 'Asistente (70%) PIA (30%)', 'Asistente (100%)', 'Análisis Piloto (PIA, Asistente)', 'Optimización Modelos IA', 'Documentación (IA)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['SaaS (100%)', 'SaaS (80%) PIA (20%)', 'SaaS (50%) PIA (50%)', 'Asistente (50%) PMA (50%)', 'Asistente (50%) PMA (50%)', 'Integración Piloto', 'Soporte Piloto', 'Optimización General', 'Soporte GTM', 'Soporte (Serie A)', 'Soporte (Serie A)', 'Soporte (Serie A)'],
                    ['-', 'HASE (API) SaaS-Integration', 'HASE (API) SaaS-Optimization', 'PIA (API)', 'PIA (API)', 'Integración General SaaS', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Backend', 'Documentación API', 'Mantenimiento', 'Mantenimiento'],
                    ['-', 'Super-PMA (HW)', 'Super-PMA (HW)', 'Super-PMA (Streaming)', 'Super-PMA (Streaming)', 'Despliegue Piloto', 'Monitoreo Piloto', 'Monitoreo Piloto', 'Optimización Datos', 'Documentación HW', 'Mantenimiento', 'Mantenimiento'],
                    ['-', '-', 'App (UI/UX)', 'App (Dashboard)', 'App (Backend Connect)', 'App (QA)', 'App (Feedback)', 'App (Feedback)', 'App (Ajustes)', 'Finalización App', '-', 'Soporte (Serie A)'],
                    ['Infra (Cloud, CI/CD) SaaS-Setup', 'Infra (DBs) SaaS-Config', 'Infra (Seguridad) SOC2', 'Monitoreo SaaS', 'Monitoreo SaaS', 'Soporte Piloto', 'Soporte Piloto', 'Optimización Infra', '-', '-', '-', '-'],
                    ['-', '-', '-', '-', '-', 'Pruebas (Carga) SaaS-IA', 'Pruebas (Piloto)', 'Pruebas (Piloto)', 'Pruebas (Regresión)', 'Documentación QA', '-', '-']
                ]
            };

            // Update the hrMatrixDetallada to use the corrected data structure
            const hrMatrixDetallada = hrMatrixCompleta;

            // --- CHARTS ---

            // Investment Donut Chart - DEBUGGING ELEMENTOS DOM
            console.log('Creando Investment Chart...');
            const donutCanvas = document.getElementById('investmentDonutChart');
            console.log('Canvas:', donutCanvas);
            console.log('Canvas parent:', donutCanvas?.parentElement);
            console.log('Canvas computed style:', donutCanvas ? window.getComputedStyle(donutCanvas) : 'null');
            console.log('Canvas dimensions:', donutCanvas ? `${donutCanvas.offsetWidth}x${donutCanvas.offsetHeight}` : 'null');
            
            if (!donutCanvas) {
                console.error('Investment donut chart canvas not found');
                
                // FALLBACK VISUAL PARA DEBUGGING
                const fallbackDiv = document.createElement('div');
                fallbackDiv.innerHTML = 'INVESTMENT CHART FAILED TO LOAD';
                fallbackDiv.style.cssText = 'background: red; color: white; padding: 20px; text-align: center;';
                document.querySelector('.chart-container').appendChild(fallbackDiv);
                return;
            }
            const donutCtx = donutCanvas.getContext('2d');
            if (!donutCtx) {
                console.error('Cannot get 2D context for investment donut chart');
                return;
            }
            
            try {
                new Chart(donutCtx, {
                type: 'doughnut',
                data: investmentDataEpic,
                options: {
                    ...epicDarkChartOptions,
                    cutout: '60%',
                    plugins: {
                        ...epicDarkChartOptions.plugins,
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 25,
                                color: '#f1f5f9',
                                font: { size: 16, weight: '600' }
                            }
                        },
                        tooltip: {
                            ...epicDarkChartOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' }).format(context.parsed);
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
            console.log('✅ Investment donut chart created successfully');
            } catch (error) {
                console.error('❌ Chart error:', error);
                
                // FALLBACK VISUAL PARA DEBUGGING
                const fallbackDiv = document.createElement('div');
                fallbackDiv.innerHTML = 'INVESTMENT CHART FAILED TO LOAD - ERROR: ' + error.message;
                fallbackDiv.style.cssText = 'background: red; color: white; padding: 20px; text-align: center;';
                donutCanvas.parentElement.appendChild(fallbackDiv);
            }

            // ROI Comparison Chart - DEBUGGING ELEMENTOS DOM
            console.log('Creando ROI Chart...');
            const roiCanvas = document.getElementById('roiComparisonChart');
            console.log('ROI Canvas:', roiCanvas);
            console.log('ROI Canvas parent:', roiCanvas?.parentElement);
            console.log('ROI Canvas computed style:', roiCanvas ? window.getComputedStyle(roiCanvas) : 'null');
            console.log('ROI Canvas dimensions:', roiCanvas ? `${roiCanvas.offsetWidth}x${roiCanvas.offsetHeight}` : 'null');
            
            if (!roiCanvas) {
                console.error('ROI comparison chart canvas not found');
                
                // FALLBACK VISUAL PARA DEBUGGING
                const fallbackDiv = document.createElement('div');
                fallbackDiv.innerHTML = 'ROI CHART FAILED TO LOAD';
                fallbackDiv.style.cssText = 'background: red; color: white; padding: 20px; text-align: center;';
                document.querySelector('#roiComparisonChart').parentElement.appendChild(fallbackDiv);
                return;
            }
            const roiCtx = roiCanvas.getContext('2d');
            if (!roiCtx) {
                console.error('Cannot get 2D context for ROI comparison chart');
                return;
            }
            
            let roiChart;
            // ROI CHART - GRADIENTES Y GLOW EFFECTS
            const roiDatasetEpic = [
                {
                    label: 'Modelo Tradicional',
                    data: roiData.tradicional.slice(0, 10),
                    borderColor: '#ef4444',
                    backgroundColor: 'rgba(239, 68, 68, 0.2)',
                    borderWidth: 4,
                    pointBackgroundColor: '#ef4444',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 3,
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    tension: 0.4,
                    fill: true,
                    shadowColor: 'rgba(239, 68, 68, 0.5)',
                    shadowBlur: 10
                },
                {
                    label: 'Modelo IA-Nativo',
                    data: roiData.iaNativo.slice(0, 10),
                    borderColor: '#10b981', 
                    backgroundColor: 'rgba(16, 185, 129, 0.2)',
                    borderWidth: 4,
                    pointBackgroundColor: '#10b981',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 3,
                    pointRadius: 6,
                    pointHoverRadius: 8,
                    tension: 0.4,
                    fill: true,
                    shadowColor: 'rgba(16, 185, 129, 0.5)',
                    shadowBlur: 10
                }
            ];

            try {
                roiChart = new Chart(roiCtx, {
                type: 'line',
                data: {
                    labels: ['Año 1', 'Año 2', 'Año 3', 'Año 4', 'Año 5', 'Año 6', 'Año 7', 'Año 8', 'Año 9', 'Año 10'],
                    datasets: roiDatasetEpic
                },
                options: {
                    ...epicDarkChartOptions,
                    plugins: {
                        ...epicDarkChartOptions.plugins,
                        tooltip: {
                            ...epicDarkChartOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + 
                                           new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN', minimumFractionDigits: 0 }).format(context.parsed.y);
                                }
                            }
                        },
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#f1f5f9',
                                font: { size: 16, weight: '600' },
                                padding: 25
                            }
                        }
                    },
                    scales: {
                        ...epicDarkChartOptions.scales,
                        y: {
                            ...epicDarkChartOptions.scales.y,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Costo Acumulado (MXN)',
                                color: '#cbd5e1',
                                font: { size: 14, weight: '500' }
                            },
                            ticks: {
                                ...epicDarkChartOptions.scales.y.ticks,
                                callback: value => `$${(value / 1000000).toFixed(1)}M`
                            }
                        }
                    }
                }
            });
            console.log('✅ ROI comparison chart created successfully');
            } catch (error) {
                console.error('❌ ROI Chart error:', error);
                
                // FALLBACK VISUAL PARA DEBUGGING
                const fallbackDiv = document.createElement('div');
                fallbackDiv.innerHTML = 'ROI CHART FAILED TO LOAD - ERROR: ' + error.message;
                fallbackDiv.style.cssText = 'background: red; color: white; padding: 20px; text-align: center;';
                roiCanvas.parentElement.appendChild(fallbackDiv);
            }

            // Financial Plan Chart - DEBUGGING ELEMENTOS DOM
            console.log('Creando Financial Chart...');
            const financialCanvas = document.getElementById('financialPlanChart');
            console.log('Financial Canvas:', financialCanvas);
            console.log('Financial Canvas parent:', financialCanvas?.parentElement);
            console.log('Financial Canvas computed style:', financialCanvas ? window.getComputedStyle(financialCanvas) : 'null');
            console.log('Financial Canvas dimensions:', financialCanvas ? `${financialCanvas.offsetWidth}x${financialCanvas.offsetHeight}` : 'null');
            
            if (!financialCanvas) {
                console.error('Financial plan chart canvas not found');
                
                // FALLBACK VISUAL PARA DEBUGGING
                const fallbackDiv = document.createElement('div');
                fallbackDiv.innerHTML = 'FINANCIAL CHART FAILED TO LOAD';
                fallbackDiv.style.cssText = 'background: red; color: white; padding: 20px; text-align: center;';
                document.querySelector('#financialPlanChart').parentElement.appendChild(fallbackDiv);
                return;
            }
            const financialCtx = financialCanvas.getContext('2d');
            if (!financialCtx) {
                console.error('Cannot get 2D context for financial plan chart');
                return;
            }
            
            // FINANCIAL CHART - GRADIENTES EN BARRAS
            const financialDatasetsEpic = [
                {
                    label: 'Gasto en Equipo',
                    data: financialData.gastoEquipo,
                    backgroundColor: 'rgba(20, 184, 166, 0.8)',
                    borderColor: 'rgba(20, 184, 166, 1)',
                    borderWidth: 2,
                    stack: 'Stack 0'
                },
                {
                    label: 'Gasto en Desarrollo', 
                    data: financialData.gastoDesarrollo,
                    backgroundColor: 'rgba(13, 148, 136, 0.8)',
                    borderColor: 'rgba(13, 148, 136, 1)',
                    borderWidth: 2,
                    stack: 'Stack 0'
                },
                {
                    label: 'Gasto CAPEX',
                    data: financialData.gastoCapex,
                    backgroundColor: 'rgba(15, 118, 110, 0.8)',
                    borderColor: 'rgba(15, 118, 110, 1)',
                    borderWidth: 2,
                    stack: 'Stack 0'
                },
                {
                    label: 'Efectivo Restante',
                    data: financialData.efectivoRestante,
                    type: 'line',
                    borderColor: '#f97316',
                    backgroundColor: 'rgba(249, 115, 22, 0.3)',
                    borderWidth: 4,
                    pointBackgroundColor: '#f97316',
                    pointBorderColor: '#ffffff',
                    pointBorderWidth: 3,
                    pointRadius: 6,
                    fill: true,
                    yAxisID: 'y1',
                    tension: 0.4
                }
            ];

            let financialChart;
            try {
                financialChart = new Chart(financialCtx, {
                type: 'bar',
                data: {
                    labels: financialData.labels,
                    datasets: financialDatasetsEpic
                },
                options: {
                    ...epicDarkChartOptions,
                    plugins: {
                        ...epicDarkChartOptions.plugins,
                        tooltip: {
                            ...epicDarkChartOptions.plugins.tooltip,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN', minimumFractionDigits: 0 }).format(context.parsed.y);
                                    }
                                    return label;
                                }
                            }
                        },
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#f1f5f9',
                                font: { size: 16, weight: '600' },
                                padding: 25
                            }
                        }
                    },
                    scales: {
                        x: {
                            ...epicDarkChartOptions.scales.x,
                            stacked: true,
                            grid: { display: false }
                        },
                        y: {
                            ...epicDarkChartOptions.scales.y,
                            stacked: true,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Gasto Mensual (MXN)',
                                color: '#cbd5e1',
                                font: { size: 14, weight: '500' }
                            },
                            ticks: {
                                ...epicDarkChartOptions.scales.y.ticks,
                                callback: value => `${value / 1000}k`
                            }
                        },
                        y1: {
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Efectivo Restante (MXN)',
                                color: '#cbd5e1',
                                font: { size: 14, weight: '500' }
                            },
                            grid: {
                                drawOnChartArea: false,
                                color: 'rgba(255, 255, 255, 0.15)'
                            },
                            ticks: {
                                color: '#cbd5e1',
                                font: { size: 14, weight: '500' },
                                callback: value => `${value / 1000000}M`
                            }
                        }
                    }
                }
            });
            console.log('✅ Financial chart created successfully');
            } catch (error) {
                console.error('❌ Financial Chart error:', error);
                
                // FALLBACK VISUAL PARA DEBUGGING
                const fallbackDiv = document.createElement('div');
                fallbackDiv.innerHTML = 'FINANCIAL CHART FAILED TO LOAD - ERROR: ' + error.message;
                fallbackDiv.style.cssText = 'background: red; color: white; padding: 20px; text-align: center;';
                financialCanvas.parentElement.appendChild(fallbackDiv);
            }

            // --- INTERACTIONS ---

            // Agent Modal Functionality
            const agentCards = document.querySelectorAll('.agent-card');
            const agentModal = document.getElementById('agent-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            const closeModal = document.getElementById('close-modal');

            function createAgentModalContent(agent) {
                const data = agentDetails[agent];
                const budgetTotal = Object.values(data.budget).reduce((a, b) => a + b, 0);
                const hoursTotal = data.hours.total || data.hours;
                const hoursBreakdown = data.hours.breakdown || [];
                
                return `
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">Presupuesto Detallado</h3>
                                ${Object.entries(data.budget).map(([key, value]) => `
                                    <div class="flex justify-between text-sm mb-2">
                                        <span class="capitalize">${key.replace(/([A-Z])/g, ' $1').toLowerCase()}:</span>
                                        <span class="font-semibold">$${value.toLocaleString()}</span>
                                    </div>
                                `).join('')}
                                <div class="border-t pt-2 mt-2">
                                    <div class="flex justify-between font-bold">
                                        <span>Total:</span>
                                        <span>$${budgetTotal.toLocaleString()}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">Tech Stack</h3>
                                <div class="flex flex-wrap gap-2">
                                    ${data.techStack.map(tech => `
                                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">${tech}</span>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">Horas Desarrollo</h3>
                                <div class="text-center">
                                    <div class="text-3xl font-bold text-teal-600">${hoursTotal}h</div>
                                    <div class="text-sm text-slate-600">Total estimadas</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">Asignación por Rol</h3>
                                ${hoursBreakdown.length > 0 ? hoursBreakdown.map(member => `
                                    <div class="mb-3 p-3 bg-white rounded border">
                                        <div class="font-semibold text-sm">${member.role}</div>
                                        <div class="text-xs text-slate-600">${member.hours}h • ${member.period}</div>
                                        <div class="text-xs text-slate-500 mt-1">${member.focus}</div>
                                    </div>
                                `).join('') : (data.team || []).map(member => `
                                    <div class="mb-3 p-3 bg-white rounded border">
                                        <div class="font-semibold text-sm">${member.role}</div>
                                        <div class="text-xs text-slate-600">${member.hours}h • ${member.months}</div>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <div class="bg-slate-50 p-4 rounded-lg">
                                <h3 class="font-semibold text-slate-800 mb-3">
                                    ${data.cronograma ? 'Cronograma Detallado' : data.kpisTecnicos ? 'KPIs Técnicos' : data.kpis ? 'KPIs Específicos' : data.monetization ? 'Monetización' : data.serviciosPremium ? 'Servicios Premium' : 'Detalles'}
                                </h3>
                                ${data.cronograma ? data.cronograma.map(item => `
                                    <div class="mb-3 p-2 bg-white rounded border-l-4 border-teal-500">
                                        <div class="font-semibold text-sm">Mes ${item.mes}: ${item.tarea}</div>
                                        <div class="text-xs text-slate-600 mt-1">🎯 ${item.hito}</div>
                                    </div>
                                `).join('') : (data.kpisTecnicos || data.kpis || data.monetization || data.serviciosPremium || data.services || []).map(item => `
                                    <div class="mb-2 text-sm text-slate-700">• ${item}</div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            agentCards.forEach(card => {
                card.addEventListener('click', () => {
                    const agent = card.dataset.agent;
                    modalTitle.textContent = agentDetails[agent].title;
                    modalContent.innerHTML = createAgentModalContent(agent);
                    agentModal.classList.remove('hidden');
                });
            });

            closeModal.addEventListener('click', () => {
                agentModal.classList.add('hidden');
            });

            // ROI Calculator Functionality
            const roiSlider = document.getElementById('roi-years');
            const yearsLabel = document.getElementById('years-label');
            const roiTradicional = document.getElementById('roi-tradicional');
            const roiIaNativo = document.getElementById('roi-ia-nativo');
            const roiAhorro = document.getElementById('roi-ahorro');
            const paybackPeriod = document.getElementById('payback-period');
            const finalRoi = document.getElementById('final-roi');

            function updateROI(years) {
                const yearIndex = years - 1;
                yearsLabel.textContent = years;
                roiTradicional.textContent = `$${(roiData.tradicional[yearIndex] / 1000000).toFixed(2)}M`;
                roiIaNativo.textContent = `$${(roiData.iaNativo[yearIndex] / 1000000).toFixed(2)}M`;
                roiAhorro.textContent = `$${(roiData.ahorros[yearIndex] / 1000000).toFixed(2)}M`;
                
                // Update chart data
                roiChart.data.datasets[0].data = roiData.tradicional.slice(0, years);
                roiChart.data.datasets[1].data = roiData.iaNativo.slice(0, years);
                roiChart.data.labels = Array.from({length: years}, (_, i) => `Año ${i + 1}`);
                roiChart.update();
                
                // Calculate ROI percentage
                const investmentTech = 2326000;
                const savings = roiData.ahorros[yearIndex];
                const roi = ((savings / investmentTech) * 100).toFixed(0);
                finalRoi.textContent = `${roi}%`;
            }

            roiSlider.addEventListener('input', (e) => updateROI(parseInt(e.target.value)));
            updateROI(5);

            // Phase Details Functionality
            const phaseCards = document.querySelectorAll('.phase-card');
            const phaseDetailsDiv = document.getElementById('phase-details');
            const phaseTitle = document.getElementById('phase-title');
            const phaseTasks = document.getElementById('phase-tasks');
            const phaseKpis = document.getElementById('phase-kpis');

            phaseCards.forEach(card => {
                card.addEventListener('click', () => {
                    const phase = parseInt(card.dataset.phase);
                    const details = phaseDetails[phase];
                    
                    phaseTitle.textContent = details.title;
                    phaseTasks.innerHTML = details.tasks.map(task => `<div class="flex items-start"><span class="text-teal-600 mr-2">•</span>${task}</div>`).join('');
                    phaseKpis.innerHTML = details.kpis.map(kpi => `<div class="flex items-center"><span class="text-green-600 mr-2">✓</span>${kpi}</div>`).join('');
                    phaseDetailsDiv.classList.remove('hidden');
                });
            });

            // Legal Modal
            const showLegalBtn = document.getElementById('show-legal');
            const legalModal = document.getElementById('legal-modal');
            const closeLegalModal = document.getElementById('close-legal-modal');

            showLegalBtn.addEventListener('click', () => {
                legalModal.classList.remove('hidden');
            });

            closeLegalModal.addEventListener('click', () => {
                legalModal.classList.add('hidden');
            });

            // Glossary Modal
            const showGlossaryBtn = document.getElementById('show-glossary');
            const glossaryModal = document.getElementById('glossary-modal');
            const closeGlossaryModal = document.getElementById('close-glossary-modal');

            if (showGlossaryBtn && glossaryModal && closeGlossaryModal) {
                showGlossaryBtn.addEventListener('click', () => {
                    glossaryModal.classList.remove('hidden');
                });

                closeGlossaryModal.addEventListener('click', () => {
                    glossaryModal.classList.add('hidden');
                });
            }

            // Close modals on outside click
            [agentModal, legalModal, glossaryModal].forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.add('hidden');
                    }
                });
            });

            // Financial Slider
            const slider = document.getElementById('month-slider');
            const monthLabel = document.getElementById('month-label');
            const kpiGastoMes = document.getElementById('kpi-gasto-mes');
            const kpiGastoAcumulado = document.getElementById('kpi-gasto-acumulado');
            const kpiEfectivo = document.getElementById('kpi-efectivo');

            function formatCurrency(value) {
                if (value >= 1000000) return `$${(value / 1000000).toFixed(2)}M`;
                if (value >= 1000) return `$${(value / 1000).toFixed(0)}k`;
                return `$${value}`;
            }

            function updateFinancials(month) {
                const index = month - 1;
                monthLabel.textContent = month;
                kpiGastoMes.textContent = formatCurrency(financialData.gastoTotal[index]);
                kpiGastoAcumulado.textContent = formatCurrency(financialData.gastoAcumulado[index]);
                kpiEfectivo.textContent = formatCurrency(financialData.efectivoRestante[index]);
                
                financialChart.data.datasets.forEach(dataset => {
                    dataset.borderWidth = Array(12).fill(1);
                });
                financialChart.data.datasets.forEach(dataset => {
                    if(dataset.type !== 'line') {
                        dataset.borderWidth[index] = 3;
                        dataset.borderColor = '#1f2937';
                    }
                });
                financialChart.update();
            }

            slider.addEventListener('input', (e) => updateFinancials(parseInt(e.target.value)));
            updateFinancials(1);

            // Tech Timeline
            const techContainer = document.getElementById('tech-timeline-container');
            const techDetailsPane = document.getElementById('tech-details-pane');
            const techDetailsTitle = document.getElementById('tech-details-title');
            const techDetailsTasks = document.getElementById('tech-details-tasks');
            const techDetailsMilestone = document.getElementById('tech-details-milestone');
            
            techTimelineData.forEach(item => {
                const itemEl = document.createElement('div');
                itemEl.className = 'timeline-item cursor-pointer p-3 rounded-lg hover:bg-slate-50';
                const width = ((item.end - item.start + 1) / 12) * 100;
                const left = ((item.start - 1) / 12) * 100;

                itemEl.innerHTML = `
                    <div class="flex justify-between items-center mb-1">
                        <span class="font-semibold text-sm">${item.category}</span>
                        <span class="text-xs text-slate-500">Mes ${item.start} - ${item.end}</span>
                    </div>
                    <div class="timeline-bar h-4 w-full bg-slate-200">
                        <div class="timeline-progress" style="width: ${width}%; left: ${left}%; background-color: ${item.color};"></div>
                    </div>
                `;
                itemEl.addEventListener('click', () => {
                    techDetailsTitle.textContent = item.category;
                    techDetailsTasks.textContent = item.tasks;
                    techDetailsMilestone.textContent = item.milestone;
                    techDetailsPane.classList.remove('hidden');
                });
                techContainer.appendChild(itemEl);
            });

            // Ops Timeline
            const opsContainer = document.getElementById('ops-timeline-container');
            const opsDetailsPane = document.getElementById('ops-details-pane');
            const opsDetailsTitle = document.getElementById('ops-details-title');
            const opsDetailsTasks = document.getElementById('ops-details-tasks');
            const opsDetailsKpi = document.getElementById('ops-details-kpi');

            opsTimelineData.forEach(item => {
                const itemEl = document.createElement('div');
                itemEl.className = 'ops-item cursor-pointer p-4 rounded-lg border border-slate-200 hover:bg-slate-50 hover:border-slate-300 transition-colors';
                itemEl.style.borderLeft = `5px solid ${item.color}`;
                itemEl.innerHTML = `<h4 class="font-semibold">${item.phase}</h4>`;
                
                itemEl.addEventListener('click', () => {
                    opsDetailsTitle.textContent = item.phase;
                    opsDetailsTasks.textContent = item.tasks;
                    opsDetailsKpi.textContent = item.kpi;
                    opsDetailsPane.classList.remove('hidden');
                });
                opsContainer.appendChild(itemEl);
            });

            // Enhanced HR Table
            const hrTable = document.getElementById('hr-table');
            const roleFilter = document.getElementById('role-filter');
            const monthFilter = document.getElementById('month-filter');
            const theadRow = hrTable.querySelector('thead tr');
            const tbody = hrTable.querySelector('tbody');

            // Populate filters and table header
            hrMatrixDetallada.roles.forEach(roleData => {
                const option = document.createElement('option');
                option.value = roleData.name;
                option.textContent = roleData.name;
                roleFilter.appendChild(option);
            });
            for(let i = 1; i <= 12; i++) {
                const th = document.createElement('th');
                th.className = 'px-3 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider';
                th.textContent = `M${i}`;
                theadRow.appendChild(th);
            }

            // Populate table body with enhanced data using new detailed structure
            hrMatrixDetallada.allocations.forEach((alloc, i) => {
                const tr = document.createElement('tr');
                const roleData = hrMatrixDetallada.roles[i];
                const roleName = roleData.name;
                const isEsop = roleData.type === 'ESOP';
                
                tr.dataset.role = roleName;
                tr.className = isEsop ? 'bg-amber-50' : '';
                
                const roleCell = document.createElement('td');
                roleCell.className = 'px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900';
                roleCell.innerHTML = `
                    <div class="flex items-center">
                        ${isEsop ? '<span class="text-amber-500 mr-2">★</span>' : ''}
                        ${roleName}
                        <div class="ml-2 text-xs text-slate-600">
                            ${roleData.totalHours}h
                            ${isEsop ? '<span class="text-amber-600"> • ESOP</span>' : ''}
                        </div>
                    </div>
                `;
                tr.appendChild(roleCell);
                
                alloc.forEach((task, monthIndex) => {
                    const td = document.createElement('td');
                    td.className = 'px-3 py-2 whitespace-nowrap text-xs text-center text-gray-500';
                    td.textContent = task;
                    td.dataset.month = monthIndex + 1;
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });

            // Enhanced filtering functionality
            function updateTableDisplay() {
                const selectedRole = roleFilter.value;
                const selectedMonth = monthFilter.value;
                
                tbody.querySelectorAll('tr').forEach(tr => {
                    const role = tr.dataset.role;
                    const roleData = hrMatrixDetallada.roles.find(r => r.name === role);
                    const isEsop = roleData && roleData.type === 'ESOP';
                    
                    // Role filtering
                    const roleMatch = selectedRole === 'all' || role === selectedRole;
                    tr.style.display = roleMatch ? '' : 'none';
                    
                    if (roleMatch) {
                        // Reset background
                        tr.className = isEsop ? 'bg-amber-50' : '';
                        
                        // Highlight selected role
                        if (selectedRole !== 'all') {
                            tr.style.backgroundColor = '#fef3c7';
                        }
                        
                        // Month highlighting
                        tr.querySelectorAll('td').forEach((td, index) => {
                            if (index > 0) { // Skip role column
                                td.style.backgroundColor = '';
                                td.style.fontWeight = '';
                                
                                if (selectedMonth !== 'all' && td.dataset.month === selectedMonth) {
                                    td.style.backgroundColor = '#dbeafe';
                                    td.style.fontWeight = 'bold';
                                }
                            }
                        });
                    }
                });
            }

            roleFilter.addEventListener('change', updateTableDisplay);
            monthFilter.addEventListener('change', updateTableDisplay);

            // Team member hover effects
            document.querySelectorAll('.team-member').forEach(member => {
                member.addEventListener('mouseenter', () => {
                    const equity = member.dataset.equity;
                    member.style.transform = 'scale(1.02)';
                    member.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
                });
                
                member.addEventListener('mouseleave', () => {
                    member.style.transform = 'scale(1)';
                    member.style.boxShadow = '';
                });
            });

            // ===== EPIC COUNTER ANIMATIONS ===== 
            function animateCounter(element, target, duration = 2500, prefix = '', suffix = '') {
                const start = 0;
                const increment = target / (duration / 16); // 60fps
                let current = start;
                
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    
                    // Format numbers with appropriate decimals
                    let displayValue;
                    if (target >= 1000000) {
                        displayValue = (current / 1000000).toFixed(2);
                    } else if (target >= 1000 && suffix === '%') {
                        displayValue = Math.round(current);
                    } else if (target >= 1000) {
                        displayValue = (current / 1000).toFixed(0) + 'k';
                        suffix = suffix.replace('M', '');
                    } else {
                        displayValue = Math.round(current);
                    }
                    
                    element.textContent = prefix + displayValue + suffix;
                }, 16);
            }

            // ===== INTERSECTION OBSERVER FOR SCROLL ANIMATIONS =====
            const observerOptions = {
                threshold: 0.2,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        
                        // Trigger counter animations when cards become visible
                        if (entry.target.classList.contains('scale-in')) {
                            const counterElements = entry.target.querySelectorAll('.counter-number');
                            counterElements.forEach((el, index) => {
                                setTimeout(() => {
                                    const target = parseInt(el.dataset.target);
                                    const prefix = el.dataset.prefix || '';
                                    const suffix = el.dataset.suffix || '';
                                    animateCounter(el, target, 2000 + (index * 200), prefix, suffix);
                                }, index * 200);
                            });
                        }
                    }
                });
            }, observerOptions);

            // Observe all fade-in and scale-in elements
            document.querySelectorAll('.fade-in-up, .scale-in').forEach(el => {
                observer.observe(el);
            });

            // ===== SCROLL PROGRESS BAR =====
            const scrollProgress = document.querySelector('.scroll-progress');
            
            function updateScrollProgress() {
                const scrollTop = window.pageYOffset;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = (scrollTop / docHeight) * 100;
                scrollProgress.style.width = scrollPercent + '%';
            }

            window.addEventListener('scroll', updateScrollProgress);

            // ===== ENHANCED NAVIGATION WITH DARK THEME =====
            const sections = document.querySelectorAll('section');
            const navLinks = document.querySelectorAll('.nav-link-dark');
            
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 80) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').includes(current)) {
                        link.classList.add('active');
                    }
                });
                
                // Update scroll progress
                updateScrollProgress();
            });

            // ===== STAGGERED CARD ANIMATIONS =====
            function staggerCards() {
                const cards = document.querySelectorAll('.agent-card-dark, .kpi-card-dark');
                cards.forEach((card, index) => {
                    setTimeout(() => {
                        observer.observe(card);
                    }, index * 100);
                });
            }

            // Initialize staggered animations
            setTimeout(staggerCards, 500);

            // ===== EPIC HOVER SOUND EFFECTS (VISUAL) =====
            document.querySelectorAll('.agent-card-dark, .kpi-card-dark').forEach(card => {
                card.addEventListener('mouseenter', () => {
                    card.style.transform = 'translateY(-12px) scale(1.03) rotateX(5deg)';
                });
                
                card.addEventListener('mouseleave', () => {
                    card.style.transform = '';
                });
            });

            // ===== SMOOTH SCROLL FOR NAVIGATION =====
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // ===== INITIALIZE EPIC COUNTERS ON LOAD =====
            setTimeout(() => {
                const heroCounters = document.querySelectorAll('#tesis .counter-number');
                heroCounters.forEach((el, index) => {
                    setTimeout(() => {
                        const target = parseInt(el.dataset.target);
                        const prefix = el.dataset.prefix || '';
                        const suffix = el.dataset.suffix || '';
                        animateCounter(el, target, 3000 + (index * 300), prefix, suffix);
                    }, 1000 + (index * 300));
                });
            }, 2000);

        } // END OF initCharts FUNCTION

        // DEBUGGING SISTEMÁTICO - WINDOW LOAD + TIMEOUT APPROACH
        window.addEventListener('load', function() {
            console.log('=== WINDOW LOAD EVENT ===');
            console.log('Window fully loaded');
            console.log('Chart en window load:', typeof Chart);
            
            // Esperar 100ms más para asegurar que Chart.js esté listo
            setTimeout(function() {
                console.log('=== TIMEOUT DESPUÉS DE WINDOW LOAD ===');
                console.log('Chart después de timeout:', typeof Chart);
                
                if (typeof Chart === 'undefined') {
                    console.error('Chart.js TODAVÍA no está disponible después de window.load');
                    
                    // Intentar cargar manualmente
                    console.log('Intentando cargar Chart.js manualmente...');
                    const script = document.createElement('script');
                    script.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js';
                    script.onload = function() {
                        console.log('Chart.js cargado manualmente');
                        setTimeout(() => {
                            console.log('Chart después de carga manual:', typeof Chart);
                            initCharts();
                        }, 100);
                    };
                    script.onerror = function() {
                        console.error('Error cargando Chart.js manualmente');
                    };
                    document.head.appendChild(script);
                    return;
                }
                
                console.log('Chart.js disponible, iniciando charts...');
                window.chartsInitialized = true;
                initCharts();
            }, 100);
        });

        // FALLBACK - SI WINDOW LOAD NO FUNCIONA, USAR DOMCONTENTLOADED
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== DOMCONTENTLOADED FALLBACK ===');
            console.log('DOM loaded, Chart disponible:', typeof Chart);
            
            // Solo ejecutar si window.load no se ejecutó en 2 segundos
            setTimeout(function() {
                if (typeof Chart !== 'undefined' && !window.chartsInitialized) {
                    console.log('Ejecutando fallback DOMContentLoaded...');
                    window.chartsInitialized = true;
                    initCharts();
                }
            }, 2000);
        });
    </script>
</body>
</html>
