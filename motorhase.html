<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explorador Interactivo: Motor HASE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Dark Slate & Vibrant Accents (from Pitch Deck) -->
    <!-- Application Structure Plan: Se ha dise√±ado una SPA con navegaci√≥n por pesta√±as para segmentar la complejidad del informe HASE en √°reas tem√°ticas y digeribles: 1) Visi√≥n General (KPIs y filosof√≠a), 2) Foso de Datos (visualizaci√≥n de placas y campos requeridos, ingenier√≠a de features), 3) Arquitectura y Rendimiento (diagrama de flujo interactivo y especificaciones t√©cnicas, gesti√≥n de proveedores, MLOps), 4) Simulador de Riesgo (demostraci√≥n interactiva del modelo HASE), 5) Procesos Clave (simulaciones de onboarding y protecci√≥n Rodando), 6) Monitoreo y Dashboards (visualizaci√≥n de KPIs de flota, tendencias, PMA, salud de datos y deriva del modelo) y 7) Roadmap (timeline visual, inferencia causal). Esta estructura no lineal prioriza la exploraci√≥n y el entendimiento del usuario sobre el orden del documento original, permitiendo a diferentes perfiles (estrat√©gicos, t√©cnicos) acceder directamente a la informaci√≥n de su inter√©s. -->
    <!-- Visualization & Content Choices:
        - Evoluci√≥n de Placas: Reporte Info (Formatos de placas a lo largo del tiempo) -> Goal (Mostrar cambio y complejidad) -> Viz (L√≠nea de tiempo interactiva HTML/CSS) -> Interaction (Click en cada hito para ver detalles) -> Justification (M√°s atractivo y claro que una tabla est√°tica).
        - Arquitectura de Datos: Reporte Info (Flujo Kafka -> Flink -> HASE) -> Goal (Explicar el flujo de datos) -> Viz (Diagrama de flujo con HTML/Tailwind) -> Interaction (Hover sobre cada componente para mostrar descripci√≥n) -> Justification (Evita el uso de MermaidJS/SVG y es m√°s interactivo).
        - Simulador de Riesgo: Reporte Info (F√≥rmula P_default y variables) -> Goal (Demostrar c√≥mo HASE eval√∫a el riesgo) -> Viz (Sliders HTML y Gr√°fico de Gauge con Chart.js) -> Interaction (Mover sliders para actualizar el score de riesgo y la acci√≥n de PIA en tiempo real) -> Justification (Convierte un concepto abstracto en una experiencia tangible y memorable; el "wow factor").
        - Requerimientos T√©cnicos: Reporte Info (Listas de SLA, seguridad, etc.) -> Goal (Presentar informaci√≥n densa de forma organizada) -> Viz (Acorde√≥n colapsable HTML/JS) -> Interaction (Click para expandir/colapsar secciones) -> Justification (Mantiene la UI limpia y evita abrumar al usuario).
        - Roadmap: Reporte Info (Fases 1, 2, 3) -> Goal (Visualizar el plan de implementaci√≥n) -> Viz (L√≠nea de tiempo horizontal HTML/CSS) -> Interaction (Click para resaltar detalles de cada fase) -> Justification (M√°s visual y f√°cil de seguir que una lista).
        - Procesos Clave (Onboarding/Protecci√≥n Rodando): Reporte Info (Descripciones de wireframes) -> Goal (Demostrar flujos de usuario) -> Viz (Descripciones HTML estructuradas como mockups) -> Interaction (N/A for mockups) -> Justification (Visualiza interacciones clave del operador y del agente).
        - Monitoreo y Dashboards: Reporte Info (Descripciones de wireframes para dashboards) -> Goal (Proporcionar vista de KPIs y tendencias) -> Viz (HTML/CSS layout con Chart.js para gr√°ficos) -> Interaction (Click en segmentos de mapa simulado, filtros de tiempo) -> Justification (Presenta visualmente los datos cr√≠ticos de monitoreo de flota).
        - Gesti√≥n de Proveedores: Reporte Info (Criterios de selecci√≥n de proveedores) -> Goal (Mostrar la rigurosidad en la selecci√≥n) -> Viz (Lista expandible/Acorde√≥n) -> Interaction (Expandir para ver detalles) -> Justification (Organiza informaci√≥n densa de manera interactiva).
        - Integraci√≥n PMA: Reporte Info (Rol del PMA) -> Goal (Destacar su importancia) -> Viz (Texto descriptivo y ejemplo) -> Interaction (N/A) -> Justification (Aclara la funci√≥n del tercer pilar de IA).
        - Salud de Datos y Drift: Reporte Info (Calidad de datos, deriva del modelo) -> Goal (Demostrar monitoreo proactivo) -> Viz (Texto conceptual, placeholders para gr√°ficos) -> Interaction (N/A) -> Justification (Visualiza conceptos clave de gobernanza de datos).
        - MLOps: Report Info (MLOps tools) -> Goal (Show operational maturity) -> Viz (Text explanation) -> Interaction (N/A) -> Justification (Explains how models are managed and maintained).
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #020617; color: #e2e8f0; } /* slate-950, slate-200 */
        .tab-active { border-color: #0ea5e9; color: #e2e8f0; background-color: #1e293b; } /* sky-500, slate-200, slate-800 */
        .tab-inactive { border-color: transparent; color: #94a3b8; } /* slate-400 */
        .section { display: none; }
        .section-active { display: block; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .roadmap-item-active .roadmap-content { max-height: 500px; opacity: 1; transform: translateY(0); }
        .roadmap-content { max-height: 0; overflow: hidden; transition: all 0.5s ease-in-out; opacity: 0; transform: translateY(-10px); }
        .chart-container { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 300px; max-height: 350px; }
        @media (min-width: 768px) { .chart-container { height: 350px; } }
        /* Styling for the simulated map */
        .simulated-map {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(4, 1fr);
            gap: 4px;
            width: 100%;
            height: 200px;
            border-radius: 8px;
            overflow: hidden;
        }
        .map-cell {
            background-color: #1e293b; /* slate-800 */
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            color: #94a3b8; /* slate-400 */
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .map-cell.risk-low { background-color: #0f172a; border: 1px solid #047857; color: #34d399;} /* slate-950, emerald-700, emerald-300 */
        .map-cell.risk-medium { background-color: #0f172a; border: 1px solid #d97706; color: #fbbf24;} /* slate-950, amber-700, amber-400 */
        .map-cell.risk-high { background-color: #0f172a; border: 1px solid #be123c; color: #f87171;} /* slate-950, rose-700, rose-400 */

        .card-dark {
            background-color: #0f172a; /* slate-900 */
            padding: 1.5rem;
            border-radius: 1rem; /* rounded-2xl */
            border: 1px solid #1e293b; /* slate-800 */
            backdrop-filter: blur(5px);
            height: 100%;
        }
        .highlight-text {
            background: -webkit-linear-gradient(45deg, #22d3ee, #0ea5e9); /* cyan-400 to sky-500 */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .slider-thumb::-webkit-slider-thumb {
            background-color: #0ea5e9; /* sky-500 */
        }
        .slider-thumb::-moz-range-thumb {
            background-color: #0ea5e9; /* sky-500 */
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white">Explorador Interactivo del Motor HASE</h1>
            <p class="text-lg text-slate-400 mt-2">Una visi√≥n din√°mica de la estrategia de "Resiliencia como Servicio" de Rodando a Gas.</p>
        </header>

        <nav class="mb-8 flex flex-wrap justify-center border-b border-slate-700">
            <button data-tab="vision-general" class="nav-tab text-sm md:text-base font-medium py-3 px-3 sm:px-6 border-b-2 transition-all duration-300">Visi√≥n General</button>
            <button data-tab="foso-datos" class="nav-tab text-sm md:text-base font-medium py-3 px-3 sm:px-6 border-b-2 transition-all duration-300">Foso de Datos</button>
            <button data-tab="arquitectura" class="nav-tab text-sm md:text-base font-medium py-3 px-3 sm:px-6 border-b-2 transition-all duration-300">Arquitectura y Rendimiento</button>
            <button data-tab="simulador" class="nav-tab text-sm md:text-base font-medium py-3 px-3 sm:px-6 border-b-2 transition-all duration-300">Simulador de Riesgo</button>
            <button data-tab="procesos-clave" class="nav-tab text-sm md:text-base font-medium py-3 px-3 sm:px-6 border-b-2 transition-all duration-300">Procesos Clave</button>
            <button data-tab="monitoreo-dashboards" class="nav-tab text-sm md:text-base font-medium py-3 px-3 sm:px-6 border-b-2 transition-all duration-300">Monitoreo y Dashboards</button>
            <button data-tab="roadmap" class="nav-tab text-sm md:text-base font-medium py-3 px-3 sm:px-6 border-b-2 transition-all duration-300">Roadmap</button>
        </nav>

        <main>
            <section id="vision-general" class="section">
                <div class="card-dark">
                    <h2 class="text-2xl font-bold mb-4 text-white">Misi√≥n: El Cerebro Predictivo y Proactivo</h2>
                    <p class="text-slate-300 mb-6">HASE (Hyper-Adaptive Scoring Engine) es el n√∫cleo inteligente de Rodando a Gas. Su misi√≥n es transformar la gesti√≥n de riesgo crediticio de un modelo est√°tico a uno din√°mico y predictivo. Al analizar datos operativos en tiempo real, HASE anticipa dificultades financieras y activa proactivamente "Protecci√≥n Rodando", un paquete de flexibilidad que apoya al operador antes de un posible impago. Este enfoque "humanamente tecnol√≥gico" convierte el riesgo en resiliencia, fomentando una relaci√≥n de colaboraci√≥n y asegurando la sostenibilidad del ecosistema.</p>
                
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h3 class="text-lg font-semibold text-sky-400">TIR de Cartera</h3>
                            <p class="text-3xl font-bold text-white mt-1 highlight-text">&ge;22.8%</p>
                            <p class="text-sm text-slate-400">Objetivo de Rentabilidad</p>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h3 class="text-lg font-semibold text-emerald-400">Tasa de Morosidad</h3>
                            <p class="text-3xl font-bold text-white mt-1 highlight-text">&lt;8%</p>
                            <p class="text-sm text-slate-400">vs. 15-20% del Sector</p>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h3 class="text-lg font-semibold text-purple-400">Escalabilidad</h3>
                            <p class="text-3xl font-bold text-white mt-1 highlight-text">1,000+</p>
                            <p class="text-sm text-slate-400">Veh√≠culos Simult√°neos</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="foso-datos" class="section">
                <div class="card-dark">
                    <h2 class="text-2xl font-bold mb-4 text-white">El Foso de Datos: Un Activo Propietario</h2>
                    <p class="text-slate-300 mb-6">La ventaja competitiva de HASE se construye sobre un "foso de datos" √∫nico, que fusiona datos operativos en tiempo real con un profundo conocimiento del sector. Unificar la informaci√≥n, comenzando por la nomenclatura hist√≥rica de las placas, es el primer paso cr√≠tico para construir una visi√≥n 360¬∞ de cada veh√≠culo y operador.</p>
                    
                    <h3 class="text-xl font-semibold mb-4 mt-8 text-white">Evoluci√≥n de la Nomenclatura de Placas (TP Edo. de M√©xico)</h3>
                    <p class="text-slate-300 mb-4">Los formatos de placas para el transporte p√∫blico en el Estado de M√©xico son definidos por la SEMOVI a lo largo del tiempo. Es crucial que los sistemas como Consware y GPS registren las placas seg√∫n el formato vigente en el a√±o correspondiente. **Consware y SEMOVI comparten hist√≥ricamente los mismos formatos de placa en sus respectivos periodos.** La tarea principal ahora es asegurar la validaci√≥n y el **filtrado estricto de las placas para incluir solo vagonetas (TP)**, excluyendo otras modalidades como taxis (TX). Este proceso se gestionar√° a trav√©s de un **Sistema de Gesti√≥n de Datos Maestros (MDM)**. Haz clic en cada hito para ver los detalles de los formatos y su origen.</p>
                    <div id="timeline-placas" class="relative w-full">
                        <div class="absolute left-1/2 h-full w-0.5 bg-slate-700"></div>
                    </div>
                </div>

                <div class="card-dark mt-8">
                     <h3 class="text-xl font-semibold mb-4 text-white">Campos de Datos Obligatorios</h3>
                     <p class="text-slate-300 mb-6">HASE se nutre de un conjunto de datos rico y diverso para construir su visi√≥n 360. Cada fuente de datos aporta piezas cr√≠ticas al rompecabezas del riesgo.</p>
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg text-sky-400">üõ∞Ô∏è GPS</h4>
                            <ul class="mt-2 space-y-1 text-slate-300 list-disc list-inside">
                                <li><code>placa</code> (Com√∫n)</li>
                                <li><code>timestamp</code> (Com√∫n)</li>
                                <li><code>id_financiamiento</code> (Com√∫n)</li>
                                <li><code>latitud</code></li>
                                <li><code>longitud</code></li>
                                <li><code>od√≥metro</code></li>
                                <li><code>estado_motor</code></li>
                                <li><code>velocidad</code></li>
                            </ul>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg text-emerald-400">‚õΩ GNV</h4>
                             <ul class="mt-2 space-y-1 text-slate-300 list-disc list-inside">
                                <li><code>placa</code> (Com√∫n)</li>
                                <li><code>timestamp</code> (Com√∫n)</li>
                                <li><code>id_financiamiento</code> (Com√∫n)</li>
                                <li><code>litros_cargados</code></li>
                                <li><code>precio_por_litro</code></li>
                                <li><code>sobreprecio_por_litro</code></li>
                                <li><code>id_estacion</code></li>
                            </ul>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg text-amber-400">üóÇÔ∏è Consware (Hist√≥ricos)</h4>
                             <ul class="mt-2 space-y-1 text-slate-300 list-disc list-inside">
                                <li><code>fecha</code></li>
                                <li><code>consumo_gnv_diario</code></li>
                                <li><code>municipio</code>, <code>ruta</code></li>
                                <li><code>tipo_financiamiento</code></li>
                                <li><code>nombre_financiera</code></li>
                                <li><code>recaudo_por_litro</code></li>
                                <li><code>marca</code>, <code>modelo</code>, <code>a√±o</code></li>
                                <li><code>eventos_criticos</code></li>
                            </ul>
                        </div>
                     </div>
                     <p class="text-slate-300 mt-6">La <strong>"carta aval de ruta"</strong> es un documento culturalmente relevante que, emitido por el l√≠der de la ruta, funciona como un poderoso colateral social y un valioso predictor de riesgo que los modelos crediticios tradicionales suelen ignorar por completo. Su integraci√≥n en el foso de datos es una ventaja competitiva √∫nica para HASE.</p>
                     <p class="text-slate-300 mt-4">**Ingenier√≠a de Caracter√≠sticas Avanzada:** Adem√°s de los campos base, Flink calcular√° **ratios derivados en tiempo real** (ej., <code>consumo_gnv_por_km</code>, <code>frecuencia_cambios_ruta</code>, <code>patrones_recarga_an√≥malos</code>) para enriquecer el an√°lisis predictivo de HASE.</p>
                </div>
            </section>

            <section id="arquitectura" class="section">
                 <div class="card-dark">
                    <h2 class="text-2xl font-bold mb-4 text-white">Arquitectura de Datos y Rendimiento</h2>
                    <p class="text-slate-300 mb-6">El sistema se basa en una arquitectura Kappa, dise√±ada para procesar datos como un flujo de eventos inmutables. Esto garantiza consistencia, escalabilidad y baja latencia, permitiendo que HASE act√∫e en tiempo real. Pasa el cursor sobre cada componente para m√°s detalles.</p>
                    
                    <div id="architecture-diagram" class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4 my-8 p-4 bg-slate-800 rounded-lg border border-slate-700">
                        <!-- Diagram elements will be injected here by JS -->
                    </div>
                </div>
                <div class="card-dark mt-8">
                     <h3 class="text-xl font-semibold mb-4 text-white">Requerimientos de Plataforma</h3>
                     <p class="text-slate-300 mb-6">Para garantizar un servicio de misi√≥n cr√≠tica, la plataforma HASE debe cumplir con estrictos est√°ndares de rendimiento, confiabilidad y seguridad.</p>
                     <div id="accordion-container" class="space-y-2">
                        <!-- Accordion items will be injected here by JS -->
                     </div>
                </div>
                <div class="card-dark mt-8">
                    <h3 class="text-xl font-semibold mb-4 text-white">Gesti√≥n Estrat√©gica de Proveedores</h3>
                    <p class="text-slate-300 mb-6">La debida diligencia y la gesti√≥n continua de proveedores externos son fundamentales para asegurar la calidad de los datos, la capacidad de integraci√≥n y el cumplimiento normativo. Esto minimiza riesgos y fortalece nuestro "Foso Operacional".</p>
                    <div id="providers-accordion-container" class="space-y-2">
                        <!-- Providers accordion items will be injected here by JS -->
                    </div>
                </div>
                <div class="card-dark mt-8">
                    <h3 class="text-xl font-semibold mb-4 text-white">Principios MLOps: Operaci√≥n y Mejora Continua de IA a Escala</h3>
                    <p class="text-slate-300 mb-4">MLOps (Machine Learning Operations) es nuestra metodolog√≠a para la gesti√≥n del ciclo de vida de los modelos de IA de HASE en producci√≥n. Asegura que nuestros modelos sean robustos, escalables y se adapten continuamente.</p>
                    <ul class="list-disc list-inside text-sm text-slate-300 space-y-2">
                        <li>**Versionamiento de Modelos (con MLflow):** Trazamos cada iteraci√≥n del modelo HASE, sus par√°metros y rendimiento, garantizando la reproducibilidad y la auditor√≠a.</li>
                        <li>**Gesti√≥n de Experimentos:** Utilizamos plataformas para comparar el rendimiento de diferentes versiones del modelo y nuevas caracter√≠sticas, acelerando la investigaci√≥n y el desarrollo.</li>
                        <li>**Despliegue Continuo (CI/CD para Modelos):** Automatizamos el proceso de llevar los modelos validados desde el desarrollo a producci√≥n de forma segura y eficiente.</li>
                        <li>**Monitoreo en Producci√≥n:** Vigilamos constantemente la precisi√≥n, el *recall* y otros KPIs del modelo para detectar degradaciones (deriva) y activar reentrenamientos.</li>
                    </ul>
                    <p class="text-slate-300 mt-4">Estos principios, habilitados por herramientas como **MLflow** y **Kubeflow**, son esenciales para la evoluci√≥n de HASE hacia modelos h√≠bridos y la integraci√≥n de la inferencia causal.</p>
                </div>
            </section>

            <section id="simulador" class="section">
                 <div class="card-dark">
                    <h2 class="text-2xl font-bold mb-4 text-white">HASE en Acci√≥n: Simulador de Riesgo</h2>
                    <p class="text-slate-300 mb-6">Experimenta c√≥mo HASE eval√∫a el riesgo din√°micamente. Ajusta las variables operativas clave para ver c√≥mo afectan el score de riesgo del operador y qu√© acci√≥n proactiva desencadenar√≠a el Agente de Intervenci√≥n Proactiva (PIA). La f√≥rmula conceptual es: <br> <code class="bg-slate-800 text-sm p-1 rounded text-white">P_default(t) = f(Factores_Est√°ticos, Score_Conductual(t-1), Flag_Intervenci√≥n(t))</code></p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div class="space-y-6">
                            <div>
                                <label for="gnv-slider" class="block font-medium mb-1 text-slate-300">Consumo de GNV (vs. Promedio Hist√≥rico)</label>
                                <input id="gnv-slider" type="range" min="-50" max="10" value="0" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider-thumb">
                                <div class="flex justify-between text-xs text-slate-400 mt-1">
                                    <span>-50%</span>
                                    <span>Normal</span>
                                    <span>+10%</span>
                                </div>
                            </div>
                             <div>
                                <label for="ruta-slider" class="block font-medium mb-1 text-slate-300">Desviaci√≥n de Ruta</label>
                                <input id="ruta-slider" type="range" min="0" max="40" value="5" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider-thumb">
                                 <div class="flex justify-between text-xs text-slate-400 mt-1">
                                    <span>Sin desviaci√≥n</span>
                                    <span>Alta desviaci√≥n (40%)</span>
                                </div>
                            </div>
                             <div>
                                <label for="proteccion-slider" class="block font-medium mb-1 text-slate-300">Uso de "Protecci√≥n Rodando" (√∫ltimos 3 meses)</label>
                                <input id="proteccion-slider" type="range" min="0" max="3" value="0" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer slider-thumb">
                                 <div class="flex justify-between text-xs text-slate-400 mt-1">
                                    <span>0 veces</span>
                                    <span>3 veces</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col items-center">
                            <div class="chart-container w-full h-64 md:h-80">
                                <canvas id="riskGaugeChart"></canvas>
                            </div>
                             <div id="pia-action" class="mt-4 text-center p-4 rounded-lg w-full transition-all duration-300">
                                <h4 class="font-bold text-lg text-white">Acci√≥n PIA</h4>
                                <p class="text-md text-slate-300"></p>
                            </div>
                        </div>
                    </div>
                 </div>
            </section>

            <section id="procesos-clave" class="section">
                <div class="card-dark">
                    <h2 class="text-2xl font-bold mb-4 text-white">Procesos Clave: Onboarding y Protecci√≥n Rodando</h2>
                    <p class="text-slate-300 mb-6">Explora c√≥mo Rodando a Gas facilita la experiencia del operador a trav√©s de procesos √°giles y proactivos, dise√±ados con una filosof√≠a "digital-first" y un profundo entendimiento de sus necesidades.</p>

                    <h3 class="text-xl font-semibold mb-4 mt-8 text-white">1. Proceso de Onboarding</h3>
                    <p class="text-slate-300 mb-4">El onboarding est√° dise√±ado para completarse en menos de 72 horas, priorizando una experiencia fluida para el operador.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg mb-2 text-sky-400">üì± Pantalla de Carga de Documentos (Operador)</h4>
                            <p class="text-slate-300 text-sm mb-2">Interfaz m√≥vil limpia para cargar documentos. El campo para la "carta de antig√ºedad de ruta" se destaca por su importancia estrat√©gica.</p>
                            <div class="border border-dashed border-slate-600 p-4 rounded-md text-center text-slate-400 text-xs">
                                <p class="mb-1"><strong>Simulaci√≥n de UI:</strong></p>
                                <p>T√≠tulo: Carga tus Documentos</p>
                                <p>Carga INE: [Bot√≥n Subir Archivo] ‚úÖ</p>
                                <p>Comprobante Domicilio: [Bot√≥n Subir Archivo] ‚úÖ</p>
                                <p>Concesi√≥n/Tarj. Circulaci√≥n: [Bot√≥n Subir Archivo] ‚è≥</p>
                                <p class="font-bold text-sky-400">Carta de Antig√ºedad de Ruta: [Bot√≥n Subir Archivo]</p>
                                <p class="text-slate-400"><em>(Un valioso filtro de riesgo social)</em></p>
                                <button class="mt-3 px-4 py-2 bg-sky-600 text-white rounded-md hover:bg-sky-500">Enviar Solicitud</button>
                                <p class="mt-2 text-slate-400 text-xs">Progreso: 75% completado</p>
                            </div>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg mb-2 text-sky-400">üíª Dashboard de Revisi√≥n (Agente Interno)</h4>
                            <p class="text-slate-300 text-sm mb-2">Vista para agentes internos para revisar y validar solicitudes, con scoring inicial de HASE.</p>
                            <div class="border border-dashed border-slate-600 p-4 rounded-md text-center text-slate-400 text-xs">
                                <p class="mb-1"><strong>Simulaci√≥n de UI:</strong></p>
                                <p>T√≠tulo: Revisi√≥n de Solicitudes Pendientes</p>
                                <ul class="list-disc list-inside text-left mb-2 text-slate-300">
                                    <li>Solicitud #12345 (Operador Juan P.) - Status: Pendiente</li>
                                    <li>Solicitud #12346 (Operador Ana R.) - Status: En Revisi√≥n</li>
                                </ul>
                                <p class="text-left font-semibold text-white">Detalle Solicitud #12345:</p>
                                <p class="text-left text-slate-300">INE: Validado ‚úÖ</p>
                                <p class="text-left text-slate-300">Carta Aval Ruta: Pendiente de Revisi√≥n ‚è≥</p>
                                <p class="text-left font-semibold mt-1 text-white">Score HASE Inicial: <span class="text-emerald-400">Bajo Riesgo</span></p>
                                <p class="text-left text-slate-300">Notas: [Campo de texto]</p>
                                <div class="flex justify-around mt-3">
                                    <button class="px-3 py-1 bg-emerald-600 text-white rounded-md hover:bg-emerald-500">Aprobar</button>
                                    <button class="px-3 py-1 bg-rose-600 text-white rounded-md hover:bg-rose-500">Rechazar</button>
                                    <button class="px-3 py-1 bg-amber-600 text-white rounded-md hover:bg-amber-500">Solicitar M√°s Info</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-xl font-semibold mb-4 mt-8 text-white">2. Activaci√≥n de "Protecci√≥n Rodando"</h3>
                    <p class="text-slate-300 mb-4">Un proceso automatizado y emp√°tico en cuatro pasos: Disparador de Datos, Intervenci√≥n Proactiva, Activaci√≥n Flexible y Equilibrio de TIR.</p>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg mb-2 text-sky-400">üí¨ Notificaci√≥n Proactiva de PIA (WhatsApp)</h4>
                            <p class="text-slate-300 text-sm mb-2">Mensaje de WhatsApp enviado por PIA cuando HASE detecta una anomal√≠a (ej. ca√≠da 30% GNV).</p>
                            <div class="border border-dashed border-slate-600 p-4 rounded-md text-center text-slate-400 text-xs">
                                <p class="mb-1"><strong>Simulaci√≥n de Chat:</strong></p>
                                <div class="bg-emerald-800 p-2 rounded-lg text-left mb-2">
                                    <p class="font-semibold text-emerald-300">Rodando a Gas</p>
                                    <p class="text-emerald-200 text-xs">Hola Juan, vimos que tu van recorri√≥ menos km. ¬øHay alg√∫n problema? ¬øNecesitas usar Protecci√≥n Rodando? Estamos para apoyarte. Responde 'S√≠' para activar.</p>
                                </div>
                                <p class="text-right text-slate-300 text-xs mt-1">"S√≠" [Operador]</p>
                            </div>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg mb-2 text-sky-400">‚úÖ Confirmaci√≥n de Activaci√≥n y Resumen (WhatsApp)</h4>
                            <p class="text-slate-300 text-sm mb-2">Respuesta de confirmaci√≥n a trav√©s de WhatsApp, indicando el ajuste realizado y que no habr√° multas.</p>
                            <div class="border border-dashed border-slate-600 p-4 rounded-md text-center text-slate-400 text-xs">
                                <p class="mb-1"><strong>Simulaci√≥n de Chat:</strong></p>
                                <div class="bg-sky-800 p-2 rounded-lg text-left mb-2">
                                    <p class="font-semibold text-sky-300">Rodando a Gas</p>
                                    <p class="text-sky-200 text-xs">¬°Excelente! Protecci√≥n Rodando ha sido activada. Tu plazo se extender√° 5 d√≠as. Sin multas ni intereses adicionales. Revisa tu app para el nuevo plan de pagos.</p>
                                </div>
                                <p class="text-right text-slate-300 text-xs mt-1">"Gracias!" [Operador]</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="monitoreo-dashboards" class="section">
                <div class="card-dark">
                    <h2 class="text-2xl font-bold mb-4 text-white">Monitoreo y Dashboards: Visi√≥n en Tiempo Real de la Flota</h2>
                    <p class="text-slate-300 mb-6">El dashboard de HASE transforma los datos crudos en inteligencia accionable, permitiendo a Rodando a Gas monitorear la salud operativa de la flota, anticipar riesgos y asegurar la calidad del "foso de datos".</p>

                    <h3 class="text-xl font-semibold mb-4 mt-8 text-white">1. Dashboard Principal de HASE (Vista de Flota)</h3>
                    <p class="text-slate-300 mb-4">Una visi√≥n consolidada del rendimiento y riesgo de toda la flota, con capacidad de drill-down.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg mb-2 text-sky-400">üìä KPIs de Riesgo y Alertas</h4>
                            <div class="flex justify-around items-center mb-4">
                                <div>
                                    <p class="text-sm text-slate-400">Tasa de Morosidad</p>
                                    <p class="text-2xl font-bold text-rose-400">8.5% <span class="text-xs text-slate-500">(Obj: &lt;8%)</span></p>
                                </div>
                                <div>
                                    <p class="text-sm text-slate-400">TIR de Cartera</p>
                                    <p class="text-2xl font-bold text-emerald-400">23.1% <span class="text-xs text-slate-500">(Obj: &ge;22.8%)</span></p>
                                </div>
                            </div>
                            <div class="text-center">
                                <p class="text-lg font-semibold text-white">Alertas Activas: <span class="text-rose-400">12</span></p>
                                <p class="text-sm text-slate-400">(Ca√≠da GNV: 8, Desviaci√≥n Ruta: 4)</p>
                            </div>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg mb-2 text-sky-400">üìç Mapa de Flota Simulado</h4>
                            <p class="text-slate-300 text-sm mb-2">Visualizaci√≥n de veh√≠culos por nivel de riesgo o estado (Ej: Verde = Bajo Riesgo, Amarillo = Riesgo Moderado, Rojo = Alto Riesgo)</p>
                            <div class="simulated-map shadow-inner bg-slate-900">
                                <div class="map-cell risk-low">TP-A1</div>
                                <div class="map-cell risk-low">TP-A2</div>
                                <div class="map-cell risk-medium">TP-B1</div>
                                <div class="map-cell risk-low">TP-A3</div>
                                <div class="map-cell risk-high">TP-C1</div>
                                <div class="map-cell risk-low">TP-A4</div>
                                <div class="map-cell risk-low">TP-A5</div>
                                <div class="map-cell risk-medium">TP-B2</div>
                                <div class="map-cell risk-low">TP-A6</div>
                                <div class="map-cell risk-high">TP-C2</div>
                                <div class="map-cell risk-low">TP-A7</div>
                                <div class="map-cell risk-low">TP-A8</div>
                                <div class="map-cell risk-medium">TP-B3</div>
                                <div class="map-cell risk-low">TP-A9</div>
                                <div class="map-cell risk-high">TP-C3</div>
                                <div class="map-cell risk-low">TP-B4</div>
                                <div class="map-cell risk-low">TP-A10</div>
                                <div class="map-cell risk-medium">TP-B5</div>
                                <div class="map-cell risk-low">TP-A11</div>
                                <div class="map-cell risk-high">TP-C4</div>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-xl font-semibold mb-4 mt-8 text-white">2. An√°lisis de Tendencias de Consumo GNV (Flota)</h3>
                    <p class="text-slate-300 mb-4">Gr√°fico que representa el consumo total de GNV de la flota a lo largo del tiempo, esencial para identificar patrones y anomal√≠as.</p>
                    <div class="bg-slate-800 p-4 rounded-lg border border-slate-700 chart-container">
                        <canvas id="fleetGnvTrendChart"></canvas>
                    </div>

                    <h3 class="text-xl font-semibold mb-4 mt-8 text-white">3. Vista Detallada de Veh√≠culo</h3>
                    <p class="text-slate-300 mb-4">Informaci√≥n granular sobre un veh√≠culo individual, incluyendo su score de riesgo, historial de consumo y telemetr√≠a clave.</p>
                    <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                        <h4 class="font-bold text-lg mb-2 text-sky-400">üîé Ejemplo de Detalle de Veh√≠culo (Placa: EM¬∑153¬∑TP)</h4>
                        <ul class="list-disc list-inside text-sm text-slate-300 space-y-1">
                            <li><strong>Modelo:</strong> Nissan Urvan 2020, <strong>Financiamiento ID:</strong> FIN-2023-001</li>
                            <li><strong>Score de Riesgo Actual:</strong> <span class="text-emerald-400 font-semibold">Bajo (15%)</span></li>
                            <li><strong>Historial Consumo GNV:</strong> Gr√°fico de l√≠neas con picos y valles, marcadores de sobreprecio y activaciones de Protecci√≥n Rodando.</li>
                            <li><strong>Patr√≥n de Ruta:</strong> Mapa que muestra el recorrido con posibles desviaciones resaltadas.</li>
                            <li><strong>Telemetr√≠a Clave:</strong> Od√≥metro (125,450 km), Estado Motor (Encendido: 8 hrs/d√≠a).</li>
                            <li><strong>Alertas Recientes:</strong> 15/06/2025 - Ca√≠da GNV 25% (Intervenci√≥n PIA: Mensaje de apoyo).</li>
                        </ul>
                    </div>
                </div>
                <div class="card-dark mt-8">
                    <h3 class="text-xl font-semibold mb-4 text-white">4. Integraci√≥n del PMA (Predictive Maintenance Advisor)</h3>
                    <p class="text-slate-300 mb-4">El PMA es el tercer pilar de la inteligencia artificial de Rodando a Gas, enfocado en la **prevenci√≥n proactiva de fallas mec√°nicas** y la optimizaci√≥n de la vida √∫til de las vagonetas. Al igual que HASE, el PMA se nutre de datos operativos en tiempo real para anticipar problemas de mantenimiento.</p>
                    <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                        <h4 class="font-bold text-lg mb-2 text-sky-400">üîß Ejemplo de Detecci√≥n PMA</h4>
                        <p class="text-slate-300 text-sm mb-2">El PMA analiza la telemetr√≠a del veh√≠culo (ej., `temperatura_motor`, `presion_aceite`, `vibracion`) en busca de patrones an√≥malos o desviaciones de los umbrales esperados. Al detectar una posible anomal√≠a, genera una alerta y sugiere una acci√≥n.</p>
                        <ul class="list-disc list-inside text-sm text-slate-300 space-y-1 mt-2">
                            <li><strong>Alerta:</strong> Lectura consistente de `temperatura_motor` un 15% por encima del promedio normal para `Modelo_A` en ruta `Ruta_X`.</li>
                            <li><strong>Acci√≥n Sugerida:</strong> Notificaci√≥n autom√°tica al operador para agendar revisi√≥n preventiva en un taller aliado. Esto evita una falla mayor y un posible impago.</li>
                        </ul>
                    </div>
                </div>
                <div class="card-dark mt-8">
                    <h3 class="text-xl font-semibold mb-4 text-white">5. Salud del Foso de Datos y Monitoreo de Deriva del Modelo</h3>
                    <p class="text-slate-300 mb-4">La vitalidad de HASE depende directamente de la calidad y la relevancia continua de su foso de datos. Monitoreamos activamente la salud de los datos y la "deriva" de nuestros modelos para asegurar precisi√≥n constante.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg mb-2 text-sky-400">‚ú® KPIs de Calidad de Datos</h4>
                            <ul class="list-disc list-inside text-sm text-slate-300 space-y-1">
                                <li>**Completitud:** % de campos sin valores nulos (Objetivo: >95%).</li>
                                <li>**Validez:** % de datos dentro de rangos esperados (Ej: `consumo_gnv` > 0).</li>
                                <li>**Consistencia:** % de `placas` unificadas y sin duplicados.</li>
                                <li>**Puntualidad:** Latencia promedio de ingesta (`GPS`, `GNV`).</li>
                            </ul>
                            <p class="text-slate-400 text-xs mt-2"><em>(Aqu√≠ se mostrar√≠an gr√°ficos de tendencia para cada KPI de calidad de datos y cumplimiento de Data Contracts.)</em></p>
                        </div>
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700">
                            <h4 class="font-bold text-lg mb-2 text-sky-400">üìâ Monitoreo de Deriva del Modelo (Model Drift)</h4>
                            <p class="text-slate-300 text-sm mb-2">Monitoreamos continuamente c√≥mo las caracter√≠sticas de entrada y el rendimiento del modelo cambian con el tiempo.</p>
                            <ul class="list-disc list-inside text-sm text-slate-300 space-y-1">
                                <li>**Deriva de Datos (Data Drift):** Cambios en la distribuci√≥n de `consumo_gnv` o `patrones_ruta`.</li>
                                <li>**Deriva de Concepto (Concept Drift):** El modelo `P_default(t)` comienza a predecir menos preciso debido a cambios en el comportamiento del operador no anticipados.</li>
                            </ul>
                            <p class="text-slate-400 text-xs mt-2"><em>(Aqu√≠ se visualizar√≠an gr√°ficos de monitoreo de deriva, disparando alertas para reentrenamiento o recalibraci√≥n de modelos.)</em></p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="roadmap" class="section">
                 <div class="card-dark">
                    <h2 class="text-2xl font-bold mb-4 text-white">Roadmap de Implementaci√≥n</h2>
                    <p class="text-slate-300 mb-6">Hemos ajustado el roadmap para optimizar el desarrollo y aprovechar la disponibilidad temprana de los datos hist√≥ricos de Consware. Ahora, nuestra primera fase se enfocar√° en sentar una base de datos s√≥lida para que HASE pueda ser entrenado con un contexto completo de riesgo desde el inicio.</p>
                     <div id="roadmap-container" class="space-y-8">
                        <!-- Roadmap items will be injected here by JS -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.nav-tab');
            const sections = document.querySelectorAll('.section');

            const appData = {
                placas: [
                    { year: "2010-2015", format: "ABC-12-34", source: "SEMOVI", desc: "Formato de placa alfanum√©rica convencional definido por SEMOVI. Consware y GPS registran las placas de vagonetas (TP) bajo esta normativa." },
                    { year: "2010-2016", format: "XXX-EM-TP", source: "Consware", desc: "Formato de placa hist√≥rico registrado en el sistema de Consware para vagonetas (TP), consistente con la normativa de SEMOVI del periodo." },
                    { year: "2016-2020", format: "TP-EDOMEX-123A", source: "SEMOVI", desc: "Transici√≥n a placas √∫nicas para transporte p√∫blico definida por SEMOVI, incluyendo c√≥digo de municipio. Consware y GPS registran las placas de vagonetas (TP) bajo esta normativa." },
                    { year: "2017-Ahora", format: "EM¬∑XXX¬∑TP", source: "Consware", desc: "Formato actual de placa registrado en el sistema de Consware para vagonetas (TP), consistente con la normativa de SEMOVI." },
                    { year: "2021-Presente", format: "Digital (QR, RFID)", source: "SEMOVI", desc: "Implementaci√≥n de placas digitales definidas por SEMOVI (NOM-001-SCT) con QR y RFID. Consware y GPS deben registrar las placas de vagonetas (TP) bajo este formato." }
                ],
                architecture: [
                    { name: 'Fuentes de Datos', desc: 'GPS, GNV y Consware env√≠an datos hist√≥ricos y en tiempo real.', icon: 'üì°' },
                    { name: 'Apache Kafka', desc: 'Act√∫a como el bus de eventos central. Ingiere y persiste todos los flujos de datos de forma tolerante a fallos.', icon: 'üîÑ' },
                    { name: 'Apache Flink', desc: 'Procesa y enriquece los datos en tiempo real (ej. cruce de placa con ID de financiamiento).', icon: '‚ú®' },
                    { name: 'Motor HASE', desc: 'Calcula el score de riesgo din√°mico (P_default) utilizando modelos de IA (ej. XGBoost).', icon: 'üß†' },
                    { name: 'PIA: Agente Proactivo', desc: 'Recibe triggers de HASE ante anomal√≠as y activa la comunicaci√≥n emp√°tica con el operador v√≠a WhatsApp.', icon: 'ü§ñ' },
                    { name: 'TimescaleDB', desc: 'Base de datos optimizada para almacenar las series temporales de datos operativos y scores de riesgo.', icon: 'üíæ' }
                ],
                accordion: [
                    { title: "Rendimiento y Confiabilidad", content: "<strong>Disponibilidad (SLA):</strong> 99.9%.<br><strong>Latencia M√°xima (GPS/GNV):</strong> &lt; 500 ms.<br><strong>Tolerancia a Fallos:</strong> Reintentos autom√°ticos (exponential backoff) y colas de mensajes con Apache Kafka para prevenir p√©rdida de datos.<br><strong>Escalabilidad:</strong> Soporte para m√°s de 1,000 veh√≠culos simult√°neos." },
                    { title: "Seguridad y Privacidad", content: "<strong>Cifrado en Tr√°nsito:</strong> TLS 1.3+.<br><strong>Cifrado en Reposo:</strong> AES-256.<br><strong>Autenticaci√≥n:</strong> API Keys, JWT y OAuth 2.0 para GNV.<br><strong>Privacidad:</strong> Anonimizaci√≥n de la 'placa' con hash SHA-256.<br><strong>Cumplimiento:</strong> Adherencia a normativas como LGPD (M√©xico) y GDPR." },
                    { title: "Endpoints Cr√≠ticos", content: "<strong>GNV:</strong> <code>POST /api/v1/transactions</code> (env√≠o de recargas).<br><strong>GPS:</strong> <code>POST /api/v1/telemetry</code> (streaming de ubicaci√≥n).<br><strong>Consware:</strong> <code>GET /api/v1/historical?fecha=YYYY-MM-DD</code> (extracci√≥n diaria)." }
                ],
                providers: [
                    { category: "Seguridad", questions: [
                        { q: "¬øSoportan autenticaci√≥n OAuth 2.0 y/o API Keys?", justification: "Asegura m√©todos de acceso seguros y controlados.", requirement: "OAuth 2.0 para GNV, API Keys + JWT para otros." },
                        { q: "¬øC√≥mo manejan el cifrado de datos en tr√°nsito y en reposo?", justification: "Protege la confidencialidad de la informaci√≥n sensible.", requirement: "TLS 1.3+ en tr√°nsito, AES-256 en reposo." },
                        { q: "¬øC√≥mo manejan la anonimizaci√≥n de datos sensibles como la placa?", justification: "Crucial para la privacidad del operador y el cumplimiento normativo.", requirement: "Anonimizaci√≥n de placa con hash SHA-256." }
                    ]},
                    { category: "Rendimiento", questions: [
                        { q: "¬øCu√°l es su SLA para disponibilidad y latencia?", justification: "Vital para la operaci√≥n en tiempo real y la proactividad de HASE.", requirement: "Disponibilidad 99.9%, latencia <500ms para GPS/GNV." },
                        { q: "¬øCu√°l es su capacidad de throughput (transmisiones simult√°neas)?", justification: "Asegura la escalabilidad para la flota creciente de Rodando a Gas.", requirement: "Soporte para 1,000+ veh√≠culos simult√°neos." }
                    ]},
                    { category: "Datos", questions: [
                        { q: "¬øMantienen registros hist√≥ricos de datos? ¬øPor cu√°nto tiempo?", justification: "Necesario para el entrenamiento y ajuste de los modelos de HASE en periodos de crisis.", requirement: "Cobertura temporal extensa (ej. 2013-2022 para Consware/GPS)." },
                        { q: "¬øPermiten acceso a metadatos de veh√≠culos (a√±o, modelo, n√∫mero de serie)?", justification: "Enriquece el scoring de HASE y el an√°lisis de mantenimiento predictivo.", requirement: "Acceso a metadatos de veh√≠culos (a√±o, modelo, n√∫mero de serie)." },
                        { q: "¬øC√≥mo manejan la conciliaci√≥n de datos en caso de fallos de red?", justification: "Esencial para la tolerancia a fallos y la prevenci√≥n de p√©rdida de datos.", requirement: "Mecanismos de reintento, colas de mensajes (Kafka)." },
                        { q: "¬øC√≥mo aseguran la calidad de los datos (ej. valores nulos, rangos)?", justification: "Impacta directamente la precisi√≥n del modelo HASE.", requirement: "M√°ximo 5% de valores nulos por campo, auditor√≠a de rangos." },
                        { q: "¬øPueden entregar datos en los formatos y frecuencias requeridos?", justification: "Asegura la compatibilidad con la arquitectura de ingesta de HASE.", requirement: "Parquet/CSV, actualizaciones mensuales incrementales para Consware." }
                    ]},
                    { category: "Cumplimiento", questions: [
                        { q: "¬øCumplen con est√°ndares de protecci√≥n de datos (LGPD/GDPR)?", justification: "Garantiza la privacidad y el cumplimiento legal de los datos personales.", requirement: "Cumplimiento con LGPD (M√©xico) y GDPR." }
                    ]}
                ],
                 roadmap: [
                    { phase: "Fase 1: Preparaci√≥n del Foso de Datos Hist√≥ricos", period: "Meses 1-3", goal: "Ingestar, limpiar y estandarizar la totalidad de los datos hist√≥ricos de Consware. Realizar el entrenamiento inicial del modelo HASE con esta base de datos completa, incluyendo periodos de estr√©s.", components: "Adquisici√≥n e ingesta de datos hist√≥ricos Consware. Limpieza y estandarizaci√≥n de placas. Configuraci√≥n de TimescaleDB para datos hist√≥ricos. Entrenamiento inicial de HASE (v0.8) y validaci√≥n *offline*.", kpis: "Completitud de datos Consware (>95%), Precisi√≥n del modelo HASE off-line (AUC, F1-score), Calidad de datos hist√≥ricos." },
                    { phase: "Fase 2: Integraci√≥n en Tiempo Real y MVP Operativo", period: "Meses 4-6", goal: "Integrar GPS y GNV en tiempo real. Desplegar una versi√≥n funcional de HASE para alertas b√°sicas y validaci√≥n en entorno de producci√≥n.", components: "Ingesta de datos GPS y GNV en tiempo real (Kafka). Enriquecimiento de datos en stream. Despliegue HASE (v1.0) para scoring en tiempo real. PIA (mensajes de alerta b√°sicos v√≠a WhatsApp).", kpis: "Latencia de datos GPS/GNV (<500ms), Tasa de detecci√≥n de anomal√≠as en tiempo real, Eficiencia del pipeline de datos." },
                    { phase: "Fase 3: Optimizaci√≥n de Protecci√≥n Rodando y Escala Empresarial", period: "Meses 7+", goal: "Integrar HASE con el Algoritmo de Equilibrio de TIR para optimizar la rentabilidad y escalar la plataforma a gran volumen.", components: "Integraci√≥n con 'Protecci√≥n Rodando'. Adopci√≥n de Flink (si no se hizo antes) y herramientas MLOps (MLflow, Kubeflow) para versionamiento, gesti√≥n de experimentos, despliegue continuo y monitoreo. Habilitaci√≥n de Inferencia Causal para cuantificar impacto.", kpis: "TIR de cartera (‚â•22.8%), Tasa de morosidad (<8%), Escalabilidad de la plataforma (>1000 veh√≠culos activos)." }
                ]
            };

            function setActiveTab(tabId) {
                tabs.forEach(tab => {
                    const isTabActive = tab.dataset.tab === tabId;
                    tab.classList.toggle('tab-active', isTabActive);
                    tab.classList.toggle('tab-inactive', !isTabActive);
                });
                sections.forEach(section => {
                    section.classList.toggle('section-active', section.id === tabId);
                });
            }

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    setActiveTab(tab.dataset.tab);
                });
            });

            setActiveTab('vision-general');
            
            const timelineContainer = document.getElementById('timeline-placas');
            timelineContainer.innerHTML = ''; // Clear existing content
            appData.placas.forEach((item, index) => {
                const side = index % 2 === 0 ? 'left' : 'right';
                
                timelineContainer.innerHTML += `
                <div class="timeline-event cursor-pointer">
                    <div class="absolute w-4 h-4 bg-slate-500 rounded-full mt-3 -ml-2 left-1/2"></div>
                    <div class="w-full text-center py-4">
                        <div class="inline-block relative w-10/12 md:w-5/12">
                             <div class="bg-slate-800 p-4 rounded-lg shadow-md border border-slate-700">
                                <p class="font-bold text-white">${item.year}</p>
                                <p class="text-sm text-slate-400">Fuente: ${item.source}</p>
                                <div class="placa-details hidden mt-2 text-sm text-slate-300 text-left">
                                    <p><strong>Formato:</strong> <code class="bg-slate-700 text-xs p-1 rounded text-white">${item.format}</code></p>
                                    <p>${item.desc}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                `;
            });
            
            document.querySelectorAll('.timeline-event').forEach(item => {
                item.addEventListener('click', () => {
                    item.querySelector('.placa-details').classList.toggle('hidden');
                });
            });

            const accordionContainer = document.getElementById('accordion-container');
            accordionContainer.innerHTML = ''; // Clear existing content
            appData.accordion.forEach(item => {
                const accordionItem = document.createElement('div');
                accordionItem.className = 'border border-slate-700 rounded-lg bg-slate-900';
                accordionItem.innerHTML = `
                    <button class="accordion-header w-full flex justify-between items-center p-4 text-left font-semibold text-white bg-slate-800 hover:bg-slate-700 transition-colors">
                        <span>${item.title}</span>
                        <span class="accordion-icon text-xl text-slate-400 transform transition-transform duration-300">+</span>
                    </button>
                    <div class="accordion-content p-4 pt-0 text-slate-300 bg-slate-900">
                        <p>${item.content}</p>
                    </div>
                `;
                accordionContainer.appendChild(accordionItem);
            });
            
            document.querySelectorAll('.accordion-header').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('.accordion-icon');
                    const isOpen = content.style.maxHeight;
                    
                    document.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
                    document.querySelectorAll('.accordion-icon').forEach(i => i.textContent = '+');
                    
                    if (!isOpen) {
                        content.style.maxHeight = content.scrollHeight + "px";
                        icon.textContent = '-';
                    }
                });
            });

            const providersAccordionContainer = document.getElementById('providers-accordion-container');
            providersAccordionContainer.innerHTML = ''; // Clear existing content
            appData.providers.forEach(category => {
                const categoryItem = document.createElement('div');
                categoryItem.className = 'border border-slate-700 rounded-lg bg-slate-900';
                categoryItem.innerHTML = `
                    <button class="accordion-header w-full flex justify-between items-center p-4 text-left font-semibold text-white bg-slate-800 hover:bg-slate-700 transition-colors">
                        <span>${category.category}</span>
                        <span class="accordion-icon text-xl text-slate-400 transform transition-transform duration-300">+</span>
                    </button>
                    <div class="accordion-content p-4 pt-0 bg-slate-900">
                        <ul class="space-y-4">
                            ${category.questions.map(q => `
                                <li>
                                    <p class="font-bold text-sky-400 text-sm mb-1">${q.q}</p>
                                    <p class="text-slate-300 text-xs"><strong>Justificaci√≥n:</strong> ${q.justification}</p>
                                    <p class="text-slate-300 text-xs"><strong>Requerimiento HASE:</strong> ${q.requirement}</p>
                                </li>
                            `).join('')}
                        </ul>
                    </div>
                `;
                providersAccordionContainer.appendChild(categoryItem);
            });

            document.querySelectorAll('#providers-accordion-container .accordion-header').forEach(button => {
                button.addEventListener('click', () => {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('.accordion-icon');
                    const isOpen = content.style.maxHeight;
                    
                    document.querySelectorAll('#providers-accordion-container .accordion-content').forEach(c => c.style.maxHeight = null);
                    document.querySelectorAll('#providers-accordion-container .accordion-icon').forEach(i => i.textContent = '+');
                    
                    if (!isOpen) {
                        content.style.maxHeight = content.scrollHeight + "px";
                        icon.textContent = '-';
                    }
                });
            });

            const architectureDiagram = document.getElementById('architecture-diagram');
            architectureDiagram.innerHTML = ''; // Clear existing content
            appData.architecture.forEach((item, index) => {
                const node = document.createElement('div');
                node.className = 'architecture-node relative flex flex-col items-center text-center p-3 border-2 border-slate-700 rounded-lg bg-slate-800 shadow-sm w-40 h-28 justify-center';
                node.innerHTML = `
                    <span class="text-3xl mb-1 text-sky-400">${item.icon}</span>
                    <p class="font-semibold text-sm text-white">${item.name}</p>
                    <div class="absolute bottom-full mb-2 w-64 bg-slate-900 text-white text-xs rounded py-2 px-3 opacity-0 invisible transition-opacity duration-300 z-10 border border-slate-700">
                        ${item.desc}
                    </div>
                `;
                architectureDiagram.appendChild(node);

                if (index < appData.architecture.length - 1) {
                    const arrow = document.createElement('div');
                    arrow.className = 'text-slate-400 text-2xl font-bold transform md:rotate-0 rotate-90 mx-2';
                    arrow.innerHTML = `&rarr;`;
                    architectureDiagram.appendChild(arrow);
                }
            });
            
            document.querySelectorAll('.architecture-node').forEach(node => {
                const tooltip = node.querySelector('div');
                node.addEventListener('mouseenter', () => {
                    tooltip.classList.remove('invisible');
                    tooltip.classList.add('opacity-100');
                });
                node.addEventListener('mouseleave', () => {
                    tooltip.classList.remove('opacity-100');
                    tooltip.classList.add('invisible');
                });
            });
            
            const roadmapContainer = document.getElementById('roadmap-container');
            roadmapContainer.innerHTML = ''; // Clear existing content
            appData.roadmap.forEach((item, index) => {
                const roadmapItem = document.createElement('div');
                roadmapItem.className = 'roadmap-item cursor-pointer';
                roadmapItem.innerHTML = `
                    <div class="flex items-center">
                        <div class="flex-shrink-0 w-12 h-12 rounded-full bg-sky-600 text-white flex items-center justify-center font-bold text-lg">${index + 1}</div>
                        <div class="ml-4">
                            <h4 class="text-xl font-bold text-white">${item.phase}</h4>
                            <p class="text-sm text-slate-400">${item.period}</p>
                        </div>
                    </div>
                    <div class="roadmap-content pl-16 mt-2">
                        <p class="text-slate-300"><strong>Objetivo:</strong> ${item.goal}</p>
                        <p class="text-slate-300 mt-1"><strong>Componentes:</strong> ${item.components}</p>
                        <p class="text-slate-300 mt-1"><strong>KPIs de √âxito:</strong> ${item.kpis}</p>
                    </div>
                `;
                roadmapContainer.appendChild(roadmapItem);
            });

            document.querySelectorAll('.roadmap-item').forEach(item => {
                item.addEventListener('click', () => {
                     document.querySelectorAll('.roadmap-item').forEach(i => i.classList.remove('roadmap-item-active'));
                     item.classList.add('roadmap-item-active');
                });
            });


            const riskGaugeCtx = document.getElementById('riskGaugeChart').getContext('2d');
            const gnvSlider = document.getElementById('gnv-slider');
            const rutaSlider = document.getElementById('ruta-slider');
            const proteccionSlider = document.getElementById('proteccion-slider');
            const piaAction = document.getElementById('pia-action');
            const piaActionTitle = piaAction.querySelector('h4');
            const piaActionText = piaAction.querySelector('p');
            
            const riskGaugeChart = new Chart(riskGaugeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Riesgo', 'Seguridad'],
                    datasets: [{
                        data: [10, 90],
                        backgroundColor: ['#f43f5e', '#34d399'], /* rose-500, emerald-400 */
                        borderColor: ['#020617'], /* slate-950 */
                        borderWidth: 4,
                        circumference: 180,
                        rotation: 270,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    aspectRatio: 2,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: '#1e293b', /* slate-800 */
                            titleFont: { size: 16, weight: 'bold' },
                            bodyFont: { size: 14 },
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        label += context.parsed.toFixed(0) + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    cutout: '70%',
                }
            });

            function updateRiskScore() {
                const gnvValue = parseInt(gnvSlider.value); // from -50 to 10
                const rutaValue = parseInt(rutaSlider.value); // from 0 to 40
                const proteccionValue = parseInt(proteccionSlider.value); // from 0 to 3

                const gnvScore = ((gnvValue - (-50)) / (10 - (-50))) * 100; // normalize 0-100, lower is worse
                const rutaScore = 100 - ((rutaValue / 40) * 100); // normalize 0-100, lower is worse
                const proteccionScore = 100 - ((proteccionValue / 3) * 100); // normalize 0-100, lower is worse

                const finalScore = (0.5 * (100 - gnvScore)) + (0.3 * (100-rutaScore)) + (0.2 * (100-proteccionScore));
                
                const riskValue = Math.min(100, Math.max(0, finalScore));

                riskGaugeChart.data.datasets[0].data = [riskValue, 100 - riskValue];

                if (riskValue < 20) {
                    riskGaugeChart.data.datasets[0].backgroundColor = ['#34d399', '#1e293b']; /* emerald-400, slate-800 */
                    piaAction.className = 'mt-4 text-center p-4 rounded-lg w-full transition-all duration-300 bg-emerald-900 text-emerald-300 border border-emerald-700';
                    piaActionTitle.textContent = 'Estado Normal';
                    piaActionText.textContent = 'El operador muestra un comportamiento estable. No se requiere intervenci√≥n.';
                } else if (riskValue < 50) {
                    riskGaugeChart.data.datasets[0].backgroundColor = ['#fbbf24', '#1e293b']; /* amber-400, slate-800 */
                     piaAction.className = 'mt-4 text-center p-4 rounded-lg w-full transition-all duration-300 bg-amber-900 text-amber-300 border border-amber-700';
                    piaActionTitle.textContent = 'Alerta Temprana';
                    piaActionText.textContent = 'Se detectan ligeras anomal√≠as. Monitorear de cerca. PIA prepara comunicaci√≥n de seguimiento.';
                } else {
                    riskGaugeChart.data.datasets[0].backgroundColor = ['#f43f5e', '#1e293b']; /* rose-500, slate-800 */
                     piaAction.className = 'mt-4 text-center p-4 rounded-lg w-full transition-all duration-300 bg-rose-900 text-rose-300 border border-rose-700';
                    piaActionTitle.textContent = '¬°Riesgo Alto!';
                    piaActionText.textContent = 'Ca√≠da significativa en indicadores. PIA env√≠a mensaje de apoyo para activar "Protecci√≥n Rodando".';
                }

                riskGaugeChart.update();
            }

            gnvSlider.addEventListener('input', updateRiskScore);
            rutaSlider.addEventListener('input', updateRiskScore);
            proteccionSlider.addEventListener('input', updateRiskScore);
            
            updateRiskScore();


            // Chart for Fleet GNV Trend
            const fleetGnvTrendCtx = document.getElementById('fleetGnvTrendChart').getContext('2d');
            const fleetGnvTrendChart = new Chart(fleetGnvTrendCtx, {
                type: 'line',
                data: {
                    labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4', 'Semana 5', 'Semana 6', 'Semana 7', 'Semana 8'],
                    datasets: [{
                        label: 'Consumo Total GNV (Litros)',
                        data: [5000, 5200, 4800, 5500, 4900, 5300, 4700, 5100],
                        borderColor: '#0ea5e9', /* sky-500 */
                        backgroundColor: 'rgba(14, 165, 233, 0.2)', /* sky-500 with opacity */
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: { color: '#94a3b8' } /* slate-400 */
                        },
                        tooltip: {
                            backgroundColor: '#1e293b', /* slate-800 */
                            titleFont: { size: 16, weight: 'bold' },
                            bodyFont: { size: 14 },
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += context.parsed.y + ' L';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Per√≠odo',
                                color: '#94a3b8' /* slate-400 */
                            },
                            ticks: { color: '#94a3b8' }, /* slate-400 */
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Litros de GNV',
                                color: '#94a3b8' /* slate-400 */
                            },
                            beginAtZero: true,
                            ticks: { color: '#94a3b8' }, /* slate-400 */
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>
