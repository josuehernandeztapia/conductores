<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modelo Financiero - Rodando a Gas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.4/build/global/luxon.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1e3a8a',
                        secondary: '#3b82f6',
                        accent: '#10b981',
                        dark: '#0f172a',
                        light: '#f8fafc'
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #0f172a;
        }
        
        .sidebar {
            transition: all 0.3s ease;
            background: linear-gradient(180deg, #1e3a8a 0%, #0f172a 100%);
        }
        
        .dashboard-card {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border-radius: 12px;
            background: white;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .tab-content {
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        
        .tab-content.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
        
        .nav-item {
            transition: all 0.2s ease;
            border-radius: 8px;
        }
        
        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .nav-item.active {
            background-color: rgba(59, 130, 246, 0.2);
        }
        
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .finance-table {
            border-collapse: separate;
            border-spacing: 0;
        }
        
        .finance-table th {
            background-color: #e2e8f0;
        }
        
        .finance-table tr:nth-child(even) {
            background-color: #f1f5f9;
        }
        
        .finance-table tr:hover {
            background-color: #ebf8ff;
        }
        
        .badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        
        .badge-success {
            background-color: #dcfce7;
            color: #166534;
        }
        
        .badge-warning {
            background-color: #fef9c3;
            color: #854d0e;
        }
        
        .badge-info {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .scenario-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .scenario-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .scenario-card.active {
            border-color: #3b82f6;
            background-color: #dbeafe;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
            
            .sidebar .nav-text {
                display: none;
            }
            
            .sidebar .logo-text {
                display: none;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="sidebar w-64 flex-shrink-0 text-white p-4 flex flex-col">
            <div class="mb-8 text-center">
                <div class="flex items-center justify-center mb-2">
                    <i class="fas fa-gas-pump text-3xl text-secondary"></i>
                    <h1 class="text-xl font-bold ml-2 logo-text">Rodando a Gas</h1>
                </div>
                <p class="text-indigo-300 text-sm logo-text">Modelo Financiero</p>
            </div>
            
            <nav class="flex-1">
                <a href="#" class="nav-item flex items-center p-3 mb-2 active" data-tab="dashboard">
                    <i class="fas fa-chart-line mr-3"></i>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="#" class="nav-item flex items-center p-3 mb-2" data-tab="modelo">
                    <i class="fas fa-calculator mr-3"></i>
                    <span class="nav-text">Modelo Financiero</span>
                </a>
                <a href="#" class="nav-item flex items-center p-3 mb-2" data-tab="escenarios">
                    <i class="fas fa-cogs mr-3"></i>
                    <span class="nav-text">Escenarios</span>
                </a>
                <a href="#" class="nav-item flex items-center p-3 mb-2" data-tab="estados">
                    <i class="fas fa-file-invoice-dollar mr-3"></i>
                    <span class="nav-text">Estados Financieros</span>
                </a>
                <a href="#" class="nav-item flex items-center p-3 mb-2" data-tab="sensibilidad">
                    <i class="fas fa-sliders-h mr-3"></i>
                    <span class="nav-text">Análisis de Sensibilidad</span>
                </a>
            </nav>
            
            <div class="mt-auto pt-4 border-t border-indigo-700">
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center">
                        <span class="font-bold">JS</span>
                    </div>
                    <div class="ml-3 nav-text">
                        <p class="font-medium">Juan Solís</p>
                        <p class="text-xs text-indigo-300">Administrador</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 overflow-auto">
            <header class="bg-white shadow">
                <div class="flex justify-between items-center p-4">
                    <div>
                        <h2 class="text-xl font-semibold text-gray-800">Modelo Financiero Interactivo</h2>
                        <p class="text-gray-600">Simulación completa del negocio RAG</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div>
                            <label class="text-sm text-gray-600 font-medium">Escenario:</label>
                            <select id="scenario-select" class="border rounded-lg px-3 py-2 text-sm">
                                <option value="base">Base</option>
                                <option value="conservador">Conservador</option>
                                <option value="optimista">Optimista</option>
                            </select>
                        </div>
                        <button class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-blue-800 flex items-center">
                            <i class="fas fa-download mr-2"></i>Exportar Reporte
                        </button>
                    </div>
                </div>
            </header>

            <main class="p-4 md:p-6">
                <!-- Dashboard Tab -->
                <div id="dashboard" class="tab-content active">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Resumen Financiero</h2>
                        <p class="text-gray-600">Visión general del rendimiento financiero de Rodando a Gas</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="dashboard-card p-5">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-semibold text-gray-700 mb-2">Ingresos Totales (5 años)</h3>
                                    <div class="text-3xl font-bold text-primary">$1,450.8M MXN</div>
                                </div>
                                <div class="bg-blue-100 p-2 rounded-lg">
                                    <i class="fas fa-dollar-sign text-blue-600 text-xl"></i>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="flex items-center text-sm text-gray-500">
                                    <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                                    <span>12.5% vs. previo</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-5">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-semibold text-gray-700 mb-2">EBITDA Promedio</h3>
                                    <div class="text-3xl font-bold text-accent">28.5%</div>
                                </div>
                                <div class="bg-green-100 p-2 rounded-lg">
                                    <i class="fas fa-chart-line text-green-600 text-xl"></i>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="flex items-center text-sm text-gray-500">
                                    <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                                    <span>3.2% vs. previo</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-5">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-semibold text-gray-700 mb-2">TIR Proyecto</h3>
                                    <div class="text-3xl font-bold text-blue-500">34.2%</div>
                                </div>
                                <div class="bg-blue-100 p-2 rounded-lg">
                                    <i class="fas fa-percent text-blue-600 text-xl"></i>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="flex items-center text-sm text-gray-500">
                                    <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                                    <span>4.7% vs. previo</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-5">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h3 class="font-semibold text-gray-700 mb-2">ROIC</h3>
                                    <div class="text-3xl font-bold text-purple-600">22.8%</div>
                                </div>
                                <div class="bg-purple-100 p-2 rounded-lg">
                                    <i class="fas fa-rotate text-purple-600 text-xl"></i>
                                </div>
                            </div>
                            <div class="mt-4">
                                <div class="flex items-center text-sm text-gray-500">
                                    <i class="fas fa-arrow-up text-green-500 mr-1"></i>
                                    <span>2.9% vs. previo</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-6">
                        <div class="dashboard-card p-5">
                            <h3 class="font-semibold text-gray-700 mb-4">Composición de Ingresos</h3>
                            <div class="chart-container">
                                <canvas id="revenue-composition-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-5">
                            <h3 class="font-semibold text-gray-700 mb-4">Proyección de Flujo de Efectivo</h3>
                            <div class="chart-container">
                                <canvas id="cashflow-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 gap-4 mb-6">
                        <div class="dashboard-card p-5">
                            <h3 class="font-semibold text-gray-700 mb-4">Métricas Clave por Año</h3>
                            <div class="overflow-x-auto">
                                <table class="w-full finance-table">
                                    <thead>
                                        <tr>
                                            <th class="text-left p-3">Métrica</th>
                                            <th class="p-3">Año 1</th>
                                            <th class="p-3">Año 2</th>
                                            <th class="p-3">Año 3</th>
                                            <th class="p-3">Año 4</th>
                                            <th class="p-3">Año 5</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left p-3 font-medium">Ingresos Totales (MXN)</td>
                                            <td class="p-3">$185.4M</td>
                                            <td class="p-3">$248.7M</td>
                                            <td class="p-3">$312.5M</td>
                                            <td class="p-3">$368.9M</td>
                                            <td class="p-3">$435.3M</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left p-3 font-medium">EBITDA</td>
                                            <td class="p-3">$42.3M</td>
                                            <td class="p-3">$68.9M</td>
                                            <td class="p-3">$92.5M</td>
                                            <td class="p-3">$112.4M</td>
                                            <td class="p-3">$138.7M</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left p-3 font-medium">Margen EBITDA</td>
                                            <td class="p-3">22.8%</td>
                                            <td class="p-3">27.7%</td>
                                            <td class="p-3">29.6%</td>
                                            <td class="p-3">30.5%</td>
                                            <td class="p-3">31.8%</td>
                                        </tr>
                                        <tr>
                                            <td class="text-left p-3 font-medium">Flujo de Caja Libre</td>
                                            <td class="p-3">-$32.5M</td>
                                            <td class="p-3">$18.4M</td>
                                            <td class="p-3">$45.7M</td>
                                            <td class="p-3">$68.9M</td>
                                            <td class="p-3">$92.3M</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modelo Financiero Tab -->
                <div id="modelo" class="tab-content">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Modelo Financiero</h2>
                        <p class="text-gray-600">Configura y simula el modelo de negocio de Rodando a Gas</p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="dashboard-card p-5 lg:col-span-2">
                            <h3 class="font-semibold text-gray-700 mb-4">Parámetros del Modelo</h3>
                            
                            <div class="space-y-5">
                                <div>
                                    <label class="block text-gray-700 mb-2">Número de Vagonetas</label>
                                    <input type="range" min="10" max="500" value="150" class="w-full slider-thumb">
                                    <div class="flex justify-between text-sm text-gray-500 mt-1">
                                        <span>10</span>
                                        <span>150</span>
                                        <span>500</span>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">Precio por Vagoneta (MXN)</label>
                                    <div class="flex">
                                        <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500">$</span>
                                        <input type="number" value="852000" class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-r-md border-gray-300">
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">Tasa de Interés (%)</label>
                                    <input type="range" min="20" max="30" value="25.5" step="0.1" class="w-full slider-thumb">
                                    <div class="flex justify-between text-sm text-gray-500 mt-1">
                                        <span>20%</span>
                                        <span>25.5%</span>
                                        <span>30%</span>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">Plazo de Financiamiento</label>
                                    <div class="flex space-x-4">
                                        <label class="inline-flex items-center">
                                            <input type="radio" name="plazo" checked class="text-primary">
                                            <span class="ml-2">48 meses</span>
                                        </label>
                                        <label class="inline-flex items-center">
                                            <input type="radio" name="plazo" class="text-primary">
                                            <span class="ml-2">60 meses</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" checked class="text-primary">
                                        <span class="ml-2 font-medium">Incluir Protección Rodando</span>
                                    </label>
                                    <p class="text-sm text-gray-500 mt-1">Reduce la probabilidad de default en un 50%</p>
                                </div>
                                
                                <div>
                                    <label class="block text-gray-700 mb-2">Margen por Vagoneta (MXN)</label>
                                    <div class="flex space-x-3">
                                        <button class="px-3 py-1 border border-gray-300 rounded-lg">+$5,000</button>
                                        <button class="px-3 py-1 border border-gray-300 rounded-lg bg-blue-100 text-primary border-primary">+$10,000</button>
                                        <button class="px-3 py-1 border border-gray-300 rounded-lg">Personalizado</button>
                                    </div>
                                </div>
                                
                                <div>
                                    <button class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-blue-800">
                                        Calcular Modelo
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-5">
                            <h3 class="font-semibold text-gray-700 mb-4">Resultados del Modelo</h3>
                            
                            <div class="space-y-4">
                                <div>
                                    <p class="text-gray-600">Ingreso por Venta Inicial</p>
                                    <p class="text-xl font-bold text-primary">$127.8M MXN</p>
                                </div>
                                
                                <div>
                                    <p class="text-gray-600">Ingresos Financieros Totales</p>
                                    <p class="text-xl font-bold text-primary">$68.4M MXN</p>
                                </div>
                                
                                <div>
                                    <p class="text-gray-600">Costo Protección Rodando</p>
                                    <p class="text-xl font-bold text-primary">$3.0M MXN</p>
                                </div>
                                
                                <div>
                                    <p class="text-gray-600">Ingreso Total por Vagonetas</p>
                                    <p class="text-xl font-bold text-primary">$193.2M MXN</p>
                                </div>
                                
                                <div class="pt-4 border-t border-gray-200">
                                    <p class="text-gray-600">TIR Proyecto</p>
                                    <p class="text-xl font-bold text-green-600">34.2%</p>
                                </div>
                                
                                <div>
                                    <p class="text-gray-600">ROIC</p>
                                    <p class="text-xl font-bold text-green-600">22.8%</p>
                                </div>
                                
                                <div>
                                    <p class="text-gray-600">Payback Period</p>
                                    <p class="text-xl font-bold text-blue-600">3.2 años</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Escenarios Tab -->
                <div id="escenarios" class="tab-content">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Análisis de Escenarios</h2>
                        <p class="text-gray-600">Compara diferentes escenarios financieros para Rodando a Gas</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="scenario-card p-5 active">
                            <div class="flex justify-between items-start mb-3">
                                <h3 class="font-bold text-lg">Escenario Base</h3>
                                <span class="badge badge-info">Activo</span>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-2">
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Ventas: 150 vagonetas/año</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Morosidad: 8%</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Margen: $88,000/vagoneta</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Con Protección Rodando</span>
                                </li>
                            </ul>
                        </div>
                        
                        <div class="scenario-card p-5">
                            <div class="flex justify-between items-start mb-3">
                                <h3 class="font-bold text-lg">Escenario Conservador</h3>
                                <span class="badge badge-warning">Bajo riesgo</span>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-2">
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Ventas: 120 vagonetas/año (-20%)</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Morosidad: 12%</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Margen: $80,000/vagoneta</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Sin Protección Rodando</span>
                                </li>
                            </ul>
                        </div>
                        
                        <div class="scenario-card p-5">
                            <div class="flex justify-between items-start mb-3">
                                <h3 class="font-bold text-lg">Escenario Optimista</h3>
                                <span class="badge badge-success">Alto crecimiento</span>
                            </div>
                            <ul class="text-sm text-gray-600 space-y-2">
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Ventas: 180 vagonetas/año (+20%)</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Morosidad: 5%</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Margen: $98,000/vagoneta</span>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    <span>Con Protección Rodando</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="dashboard-card p-5">
                        <h3 class="font-semibold text-gray-700 mb-4">Comparación de Escenarios</h3>
                        <div class="chart-container">
                            <canvas id="scenario-comparison-chart"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Estados Financieros Tab -->
                <div id="estados" class="tab-content">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Estados Financieros</h2>
                        <p class="text-gray-600">Estado de Resultados, Balance General y Flujo de Efectivo</p>
                    </div>
                    
                    <div class="flex border-b border-gray-200 mb-4">
                        <button class="px-4 py-2 font-medium border-b-2 border-primary text-primary">Estado de Resultados</button>
                        <button class="px-4 py-2 font-medium text-gray-500 hover:text-gray-700">Balance General</button>
                        <button class="px-4 py-2 font-medium text-gray-500 hover:text-gray-700">Flujo de Efectivo</button>
                    </div>
                    
                    <div class="dashboard-card p-5">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-semibold text-gray-700">Estado de Resultados (P&L) - Año 1</h3>
                            <div class="flex space-x-2">
                                <select class="border rounded-lg px-3 py-1 text-sm">
                                    <option>Año 1</option>
                                    <option>Año 2</option>
                                    <option>Año 3</option>
                                    <option>Año 4</option>
                                    <option>Año 5</option>
                                </select>
                                <button class="bg-primary text-white px-3 py-1 rounded-lg text-sm">
                                    Exportar
                                </button>
                            </div>
                        </div>
                        
                        <div class="overflow-x-auto">
                            <table class="w-full finance-table">
                                <thead>
                                    <tr>
                                        <th class="text-left p-3">Concepto</th>
                                        <th class="p-3">Monto (MXN)</th>
                                        <th class="p-3">% de Ingresos</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="text-left p-3 font-medium">Ingresos por Ventas</td>
                                        <td class="p-3">$127,800,000</td>
                                        <td class="p-3">100.0%</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left p-3 pl-6 font-medium">- Costo de Ventas</td>
                                        <td class="p-3">$96,500,000</td>
                                        <td class="p-3">75.5%</td>
                                    </tr>
                                    <tr class="bg-blue-50">
                                        <td class="text-left p-3 font-bold">Utilidad Bruta</td>
                                        <td class="p-3 font-bold">$31,300,000</td>
                                        <td class="p-3 font-bold">24.5%</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left p-3 font-medium">Gastos Operativos</td>
                                        <td class="p-3">$19,100,000</td>
                                        <td class="p-3">14.9%</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left p-3 font-medium">Gastos de Ventas</td>
                                        <td class="p-3">$8,200,000</td>
                                        <td class="p-3">6.4%</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left p-3 font-medium">Gastos Administrativos</td>
                                        <td class="p-3">$6,500,000</td>
                                        <td class="p-3">5.1%</td>
                                    </tr>
                                    <tr class="bg-blue-50">
                                        <td class="text-left p-3 font-bold">EBITDA</td>
                                        <td class="p-3 font-bold">$42,300,000</td>
                                        <td class="p-3 font-bold">33.1%</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left p-3 font-medium">Depreciación y Amortización</td>
                                        <td class="p-3">$12,800,000</td>
                                        <td class="p-3">10.0%</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left p-3 font-medium">Gastos Financieros</td>
                                        <td class="p-3">$9,200,000</td>
                                        <td class="p-3">7.2%</td>
                                    </tr>
                                    <tr class="bg-blue-50">
                                        <td class="text-left p-3 font-bold">Utilidad antes de Impuestos</td>
                                        <td class="p-3 font-bold">$20,300,000</td>
                                        <td class="p-3 font-bold">15.9%</td>
                                    </tr>
                                    <tr>
                                        <td class="text-left p-3 font-medium">Impuestos (30%)</td>
                                        <td class="p-3">$6,090,000</td>
                                        <td class="p-3">4.8%</td>
                                    </tr>
                                    <tr class="bg-green-50">
                                        <td class="text-left p-3 font-bold">Utilidad Neta</td>
                                        <td class="p-3 font-bold">$14,210,000</td>
                                        <td class="p-3 font-bold">11.1%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Análisis de Sensibilidad Tab -->
                <div id="sensibilidad" class="tab-content">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">Análisis de Sensibilidad</h2>
                        <p class="text-gray-600">Evalúa el impacto de cambios en variables clave</p>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="dashboard-card p-5">
                            <h3 class="font-semibold text-gray-700 mb-4">Impacto en TIR</h3>
                            <div class="chart-container">
                                <canvas id="tir-sensitivity-chart"></canvas>
                            </div>
                        </div>
                        
                        <div class="dashboard-card p-5">
                            <h3 class="font-semibold text-gray-700 mb-4">Impacto en EBITDA</h3>
                            <div class="chart-container">
                                <canvas id="ebitda-sensitivity-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dashboard-card p-5">
                        <h3 class="font-semibold text-gray-700 mb-4">Variables de Sensibilidad</h3>
                        
                        <div class="space-y-5">
                            <div>
                                <div class="flex justify-between mb-2">
                                    <label class="text-gray-700">Tasa de Morosidad</label>
                                    <span class="font-medium">8%</span>
                                </div>
                                <input type="range" min="3" max="20" value="8" class="w-full slider-thumb">
                                <div class="flex justify-between text-sm text-gray-500 mt-1">
                                    <span>3%</span>
                                    <span>8%</span>
                                    <span>20%</span>
                                </div>
                            </div>
                            
                            <div>
                                <div class="flex justify-between mb-2">
                                    <label class="text-gray-700">Tasa de Interés</label>
                                    <span class="font-medium">25.5%</span>
                                </div>
                                <input type="range" min="20" max="30" value="25.5" step="0.1" class="w-full slider-thumb">
                                <div class="flex justify-between text-sm text-gray-500 mt-1">
                                    <span>20%</span>
                                    <span>25.5%</span>
                                    <span>30%</span>
                                </div>
                            </div>
                            
                            <div>
                                <div class="flex justify-between mb-2">
                                    <label class="text-gray-700">Margen por Vagoneta (MXN)</label>
                                    <span class="font-medium">$88,000</span>
                                </div>
                                <input type="range" min="70000" max="120000" value="88000" step="1000" class="w-full slider-thumb">
                                <div class="flex justify-between text-sm text-gray-500 mt-1">
                                    <span>$70K</span>
                                    <span>$88K</span>
                                    <span>$120K</span>
                                </div>
                            </div>
                            
                            <div>
                                <div class="flex justify-between mb-2">
                                    <label class="text-gray-700">Crecimiento Anual de Ventas</label>
                                    <span class="font-medium">15%</span>
                                </div>
                                <input type="range" min="5" max="30" value="15" class="w-full slider-thumb">
                                <div class="flex justify-between text-sm text-gray-500 mt-1">
                                    <span>5%</span>
                                    <span>15%</span>
                                    <span>30%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Inicialización de gráficos
        document.addEventListener('DOMContentLoaded', function() {
            // Gráfico de composición de ingresos
            const revenueCtx = document.getElementById('revenue-composition-chart').getContext('2d');
            const revenueChart = new Chart(revenueCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Ventas a Plazo', 'Protección Rodando', 'Comisiones GNV', 'Refacciones'],
                    datasets: [{
                        data: [65, 15, 12, 8],
                        backgroundColor: ['#4F46E5', '#10B981', '#F59E0B', '#EF4444'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.parsed}%`;
                                }
                            }
                        }
                    }
                }
            });

            // Gráfico de flujo de efectivo
            const cashflowCtx = document.getElementById('cashflow-chart').getContext('2d');
            const cashflowChart = new Chart(cashflowCtx, {
                type: 'line',
                data: {
                    labels: ['Año 1', 'Año 2', 'Año 3', 'Año 4', 'Año 5'],
                    datasets: [{
                        label: 'Flujo Operativo',
                        data: [120, 185, 210, 240, 280],
                        borderColor: '#4F46E5',
                        backgroundColor: 'rgba(79, 70, 229, 0.1)',
                        fill: true,
                        tension: 0.3
                    }, {
                        label: 'Flujo Neto',
                        data: [-80, 45, 95, 150, 220],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Millones MXN'
                            }
                        }
                    }
                }
            });

            // Gráfico de comparación de escenarios
            const scenarioCtx = document.getElementById('scenario-comparison-chart').getContext('2d');
            const scenarioChart = new Chart(scenarioCtx, {
                type: 'bar',
                data: {
                    labels: ['Escenario Base', 'Escenario Conservador', 'Escenario Optimista'],
                    datasets: [
                        {
                            label: 'TIR',
                            data: [34.2, 24.5, 42.8],
                            backgroundColor: '#4F46E5',
                        },
                        {
                            label: 'EBITDA',
                            data: [28.5, 20.3, 35.2],
                            backgroundColor: '#10B981',
                        },
                        {
                            label: 'ROIC',
                            data: [22.8, 15.4, 28.7],
                            backgroundColor: '#F59E0B',
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Porcentaje (%)'
                            }
                        }
                    }
                }
            });

            // Gráfico de sensibilidad TIR
            const tirCtx = document.getElementById('tir-sensitivity-chart').getContext('2d');
            const tirChart = new Chart(tirCtx, {
                type: 'radar',
                data: {
                    labels: ['Morosidad', 'Tasa de Interés', 'Margen', 'Crecimiento', 'Costo GNV'],
                    datasets: [{
                        label: 'Impacto en TIR',
                        data: [85, 70, 95, 90, 75],
                        fill: true,
                        backgroundColor: 'rgba(79, 70, 229, 0.2)',
                        borderColor: '#4F46E5',
                        pointBackgroundColor: '#4F46E5',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#4F46E5'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    }
                }
            });

            // Gráfico de sensibilidad EBITDA
            const ebitdaCtx = document.getElementById('ebitda-sensitivity-chart').getContext('2d');
            const ebitdaChart = new Chart(ebitdaCtx, {
                type: 'bar',
                data: {
                    labels: ['-20%', '-10%', 'Base', '+10%', '+20%'],
                    datasets: [{
                        label: 'Morosidad',
                        data: [18.2, 23.4, 28.5, 31.7, 33.8],
                        backgroundColor: '#4F46E5',
                    }, {
                        label: 'Tasa Interés',
                        data: [25.3, 26.9, 28.5, 29.8, 30.5],
                        backgroundColor: '#10B981',
                    }, {
                        label: 'Margen',
                        data: [22.7, 25.6, 28.5, 31.4, 34.3],
                        backgroundColor: '#F59E0B',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'EBITDA (%)'
                            }
                        }
                    }
                }
            });

            // Navegación por pestañas
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remover clase activa de todos los ítems
                    document.querySelectorAll('.nav-item').forEach(el => {
                        el.classList.remove('active');
                    });
                    
                    // Añadir clase activa al ítem clickeado
                    this.classList.add('active');
                    
                    // Ocultar todos los contenidos de pestañas
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Mostrar el contenido de la pestaña correspondiente
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // Selección de escenarios
            document.querySelectorAll('.scenario-card').forEach(card => {
                card.addEventListener('click', function() {
                    document.querySelectorAll('.scenario-card').forEach(c => {
                        c.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });
        });

        // Funciones financieras
        function calcularValorPresente(cuotas, tasaInteres) {
            return cuotas.reduce((vp, cuota, mes) => 
                vp + cuota / Math.pow(1 + tasaInteres / 12, mes + 1), 0);
        }

        function calcularAmortizacion(montoCredito, tasaInteresAnual, plazoMeses) {
            const tasaMensual = tasaInteresAnual / 12 / 100;
            const pagoMensual = montoCredito * 
                (tasaMensual * Math.pow(1 + tasaMensual, plazoMeses)) / 
                (Math.pow(1 + tasaMensual, plazoMeses) - 1);
            
            let saldoPendiente = montoCredito;
            const cronograma = [];
            
            for (let mes = 1; mes <= plazoMeses; mes++) {
                const interesMes = saldoPendiente * tasaMensual;
                const capitalMes = pagoMensual - interesMes;
                saldoPendiente -= capitalMes;
                
                cronograma.push({
                    mes,
                    pagoMensual,
                    interesMes,
                    capitalMes,
                    saldoPendiente: Math.max(0, saldoPendiente)
                });
            }
            
            return { pagoMensual, cronograma };
        }
    </script>
</body>
</html>
