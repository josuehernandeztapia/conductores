<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modelo Financiero Interactivo - Rodando a Gas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f8f9fa; 
        }
        .tab-button { 
            transition: all 0.3s ease; 
            cursor: pointer;
        }
        .tab-button.active { 
            border-color: #2563eb; 
            color: #2563eb; 
            background-color: #eff6ff; 
        }
        .tab-button:not(.active):hover { 
            background-color: #f3f4f6; 
        }
        .content-section { 
            display: none; 
        }
        .content-section.active { 
            display: block; 
        }
        .card { 
            background-color: white; 
            border-radius: 0.75rem; 
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); 
            padding: 1.5rem; 
            margin-bottom: 1.5rem;
        }
        .input-slider { 
            -webkit-appearance: none; 
            appearance: none; 
            width: 100%; 
            height: 8px; 
            background: #e5e7eb; 
            border-radius: 9999px; 
            outline: none; 
            transition: opacity .2s; 
        }
        .input-slider::-webkit-slider-thumb { 
            -webkit-appearance: none; 
            appearance: none; 
            width: 20px; 
            height: 20px; 
            background: #2563eb; 
            border-radius: 9999px; 
            cursor: pointer; 
        }
        .input-slider::-moz-range-thumb { 
            width: 20px; 
            height: 20px; 
            background: #2563eb; 
            border-radius: 9999px; 
            cursor: pointer; 
            border: none;
        }
        .chart-container { 
            position: relative; 
            width: 100%; 
            max-width: 800px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 350px; 
            max-height: 50vh; 
        }
        .financial-table {
            width: 100%;
            border-collapse: collapse;
        }
        .financial-table th,
        .financial-table td {
            padding: 0.75rem;
            text-align: right;
            border-bottom: 1px solid #e5e7eb;
        }
        .financial-table th {
            background-color: #f9fafb;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        .financial-table td:first-child,
        .financial-table th:first-child {
            text-align: left;
        }
        .positive { color: #16a34a; }
        .negative { color: #dc2626; }
        .metric-card {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            border-left: 4px solid #2563eb;
        }
    </style>
</head>
<body class="text-gray-800">

    <div id="app" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        
        <header class="mb-8 text-center">
            <h1 class="text-3xl font-bold text-gray-900">Modelo Financiero Interactivo</h1>
            <p class="text-lg text-gray-600">Rodando a Gas: Resiliencia como Servicio</p>
            <p class="text-sm text-gray-500 mt-2">Cumplimiento NIIF 15 & NIIF 9 | Proyecciones a 5 a√±os</p>
        </header>

        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="metric-card p-4 rounded-lg">
                <div class="text-sm text-gray-500">EBITDA A√±o 5</div>
                <div class="text-2xl font-bold" id="ebitda-year5">$15.2M MXN</div>
            </div>
            <div class="metric-card p-4 rounded-lg">
                <div class="text-sm text-gray-500">TIR Proyectada</div>
                <div class="text-2xl font-bold" id="tir-proyectada">22.8%</div>
            </div>
            <div class="metric-card p-4 rounded-lg">
                <div class="text-sm text-gray-500">Unidades Financiadas (A√±o 5)</div>
                <div class="text-2xl font-bold" id="unidades-year5">500</div>
            </div>
            <div class="metric-card p-4 rounded-lg">
                <div class="text-sm text-gray-500">Patrimonio Neto</div>
                <div class="text-2xl font-bold" id="patrimonio-neto">$78.3M MXN</div>
            </div>
        </div>

        <main>
            <div class="mb-6 border-b border-gray-200">
                <nav class="flex flex-wrap -mb-px" aria-label="Tabs">
                    <button id="tab-control" class="tab-button active text-lg font-medium mr-2 inline-block p-4 border-b-2 border-transparent rounded-t-lg">üöÄ Panel de Control</button>
                    <button id="tab-financieros" class="tab-button text-lg font-medium mr-2 inline-block p-4 border-b-2 border-transparent rounded-t-lg">üìä Estados Financieros</button>
                    <button id="tab-graficos" class="tab-button text-lg font-medium mr-2 inline-block p-4 border-b-2 border-transparent rounded-t-lg">üìà An√°lisis Gr√°fico</button>
                    <button id="tab-resumen" class="tab-button text-lg font-medium mr-2 inline-block p-4 border-b-2 border-transparent rounded-t-lg">üìñ Resumen Estrat√©gico</button>
                </nav>
            </div>

            <!-- Panel de Control -->
            <div id="content-control" class="content-section active">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="card lg:col-span-3">
                         <div class="flex items-center justify-between mb-4">
                            <h3 class="text-xl font-semibold text-gray-800">Par√°metros Globales y Escenarios</h3>
                            <div class="flex items-center space-x-4">
                               <select id="select-escenario" class="block rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm p-2">
                                    <option value="base">Escenario Base</option>
                                    <option value="optimista">Escenario Optimista</option>
                                    <option value="conservador">Escenario Conservador</option>
                                </select>
                                <select id="select-vista" class="block rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm p-2">
                                    <option value="anual">Vista Anual</option>
                                    <option value="mensual">Vista Mensual</option>
                                </select>
                            </div>
                        </div>
                        <p class="text-sm text-gray-500">Ajuste las variables clave para simular diferentes condiciones de mercado. Los cambios se reflejar√°n en todos los estados financieros y gr√°ficos en tiempo real.</p>
                        <div id="scenario-details" class="text-sm text-gray-600 mt-2 p-2 bg-gray-50 rounded-md">
                            <strong>Escenario Base:</strong> Tasa de morosidad 8%, Margen por vagoneta $88,000 MXN, TIR objetivo ‚â•22.8%
                        </div>
                    </div>

                    <div class="card">
                        <h4 class="font-semibold text-lg mb-1">Cr√©dito y Riesgo</h4>
                        <p class="text-xs text-gray-500 mb-4">Ajuste las condiciones del financiamiento y las provisiones por riesgo (NIIF 9).</p>
                        <div class="space-y-4">
                            <div>
                                <label for="tasa-interes" class="flex justify-between text-sm font-medium text-gray-700">Tasa de Inter√©s Anual <span id="tasa-interes-valor" class="font-bold text-indigo-600">25.5%</span></label>
                                <input type="range" id="tasa-interes" min="23.9" max="26.9" step="0.1" value="25.5" class="input-slider mt-1">
                            </div>
                             <div>
                                <label for="tasa-morosidad" class="flex justify-between text-sm font-medium text-gray-700">Tasa de Morosidad <span id="tasa-morosidad-valor" class="font-bold text-indigo-600">8%</span></label>
                                <input type="range" id="tasa-morosidad" min="4" max="15" step="0.5" value="8" class="input-slider mt-1">
                            </div>
                             <div class="flex items-center">
                                <input id="check-proteccion" type="checkbox" checked class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                                <label for="check-proteccion" class="ml-2 block text-sm text-gray-900">Incluir "Protecci√≥n Rodando"</label>
                                <span class="ml-2 text-xs text-green-600">(Reduce morosidad hasta 50%)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h4 class="font-semibold text-lg mb-1">Operaciones y M√°rgenes</h4>
                        <p class="text-xs text-gray-500 mb-4">Configure los m√°rgenes de ganancia para las l√≠neas de ingreso.</p>
                        <div class="space-y-4">
                            <div>
                                <label for="margen-vagoneta" class="flex justify-between text-sm font-medium text-gray-700">Margen por Vagoneta <span id="margen-vagoneta-valor" class="font-bold text-indigo-600">$88,000</span></label>
                                <input type="range" id="margen-vagoneta" min="50000" max="120000" step="1000" value="88000" class="input-slider mt-1">
                            </div>
                            <div>
                                <label for="comision-gnv" class="flex justify-between text-sm font-medium text-gray-700">Comisi√≥n GNV <span id="comision-gnv-valor" class="font-bold text-indigo-600">8%</span></label>
                                <input type="range" id="comision-gnv" min="7" max="10" step="0.5" value="8" class="input-slider mt-1">
                            </div>
                             <div>
                                <label for="margen-refacciones" class="flex justify-between text-sm font-medium text-gray-700">Margen Refacciones <span id="margen-refacciones-valor" class="font-bold text-indigo-600">25%</span></label>
                                <input type="range" id="margen-refacciones" min="25" max="35" step="1" value="25" class="input-slider mt-1">
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h4 class="font-semibold text-lg mb-1">Estructura de Capital (Post-Serie A)</h4>
                        <p class="text-xs text-gray-500 mb-4">Simule el impacto de la financiaci√≥n con venture debt vs. equity.</p>
                        <div class="space-y-4">
                            <div>
                                <label for="venture-debt-pct" class="flex justify-between text-sm font-medium text-gray-700">% Venture Debt <span id="venture-debt-pct-valor" class="font-bold text-indigo-600">0%</span></label>
                                <input type="range" id="venture-debt-pct" min="0" max="50" step="5" value="0" class="input-slider mt-1">
                            </div>
                            <div>
                                <label for="venture-debt-rate" class="flex justify-between text-sm font-medium text-gray-700">Tasa Venture Debt <span id="venture-debt-rate-valor" class="font-bold text-indigo-600">12%</span></label>
                                <input type="range" id="venture-debt-rate" min="12" max="18" step="0.5" value="12" class="input-slider mt-1">
                            </div>
                            <div class="bg-blue-50 p-3 rounded-md">
                                <p class="text-xs text-blue-700"><strong>Estrategia RAG:</strong> Usar venture debt para flota, preservar equity para tecnolog√≠a e IA.</p>
                            </div>
                        </div>
                        <div class="text-center mt-4">
                            <p class="text-lg font-bold text-gray-800">TIR de la Cartera: <span id="irr-value" class="text-indigo-600">22.8%</span></p>
                        </div>
                    </div>

                    <div class="card lg:col-span-3">
                        <h4 class="font-semibold text-lg mb-4">Validaci√≥n Contable en Tiempo Real</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="bg-green-50 p-3 rounded-md border-l-4 border-green-400">
                                <p class="text-sm text-green-700">‚úÖ <strong>NIIF 15:</strong> Reconocimiento de ingresos al valor presente</p>
                            </div>
                            <div class="bg-green-50 p-3 rounded-md border-l-4 border-green-400">
                                <p class="text-sm text-green-700">‚úÖ <strong>NIIF 9:</strong> Provisiones por p√©rdidas crediticias esperadas</p>
                            </div>
                            <div id="balance-validation" class="bg-green-50 p-3 rounded-md border-l-4 border-green-400">
                                <p class="text-sm text-green-700">‚úÖ <strong>Balance:</strong> Activo = Pasivo + Capital</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Estados Financieros -->
            <div id="content-financieros" class="content-section">
                <div class="space-y-6">
                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">Estado de Resultados (P&L)</h3>
                        <div class="overflow-x-auto">
                            <table class="financial-table">
                                <thead>
                                    <tr>
                                        <th>Concepto</th>
                                        <th>A√±o 1</th>
                                        <th>A√±o 2</th>
                                        <th>A√±o 3</th>
                                        <th>A√±o 4</th>
                                        <th>A√±o 5</th>
                                    </tr>
                                </thead>
                                <tbody id="pl-table-body">
                                    <tr>
                                        <td><strong>Ingresos por Financiamiento</strong></td>
                                        <td class="positive">$2,500,000</td>
                                        <td class="positive">$7,200,000</td>
                                        <td class="positive">$12,800,000</td>
                                        <td class="positive">$18,900,000</td>
                                        <td class="positive">$25,600,000</td>
                                    </tr>
                                    <tr>
                                        <td>Margen por Vagoneta</td>
                                        <td class="positive">$3,080,000</td>
                                        <td class="positive">$8,800,000</td>
                                        <td class="positive">$15,600,000</td>
                                        <td class="positive">$22,880,000</td>
                                        <td class="positive">$31,680,000</td>
                                    </tr>
                                    <tr>
                                        <td>Comisiones GNV</td>
                                        <td class="positive">$120,000</td>
                                        <td class="positive">$340,000</td>
                                        <td class="positive">$600,000</td>
                                        <td class="positive">$880,000</td>
                                        <td class="positive">$1,200,000</td>
                                    </tr>
                                    <tr>
                                        <td>Ingresos por Refacciones (PMA)</td>
                                        <td class="positive">$90,000</td>
                                        <td class="positive">$260,000</td>
                                        <td class="positive">$460,000</td>
                                        <td class="positive">$680,000</td>
                                        <td class="positive">$920,000</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td><strong>Total Ingresos</strong></td>
                                        <td><strong>$5,790,000</strong></td>
                                        <td><strong>$16,600,000</strong></td>
                                        <td><strong>$29,460,000</strong></td>
                                        <td><strong>$43,340,000</strong></td>
                                        <td><strong>$59,400,000</strong></td>
                                    </tr>
                                    <tr>
                                        <td>Costo de Ventas</td>
                                        <td class="negative">($2,244,350)</td>
                                        <td class="negative">($6,412,000)</td>
                                        <td class="negative">($11,361,500)</td>
                                        <td class="negative">($16,661,000)</td>
                                        <td class="negative">($22,926,500)</td>
                                    </tr>
                                    <tr>
                                        <td>Gastos Operativos (15%)</td>
                                        <td class="negative">($868,500)</td>
                                        <td class="negative">($2,490,000)</td>
                                        <td class="negative">($4,419,000)</td>
                                        <td class="negative">($6,501,000)</td>
                                        <td class="negative">($8,910,000)</td>
                                    </tr>
                                    <tr>
                                        <td>Provisiones NIIF 9 (8%)</td>
                                        <td class="negative">($200,000)</td>
                                        <td class="negative">($576,000)</td>
                                        <td class="negative">($1,024,000)</td>
                                        <td class="negative">($1,512,000)</td>
                                        <td class="negative">($2,048,000)</td>
                                    </tr>
                                    <tr class="bg-blue-50">
                                        <td><strong>EBITDA</strong></td>
                                        <td><strong class="positive">$2,477,150</strong></td>
                                        <td><strong class="positive">$7,122,000</strong></td>
                                        <td><strong class="positive">$12,655,500</strong></td>
                                        <td><strong class="positive">$18,666,000</strong></td>
                                        <td><strong class="positive">$25,515,500</strong></td>
                                    </tr>
                                    <tr>
                                        <td>Intereses Venture Debt</td>
                                        <td class="negative">($0)</td>
                                        <td class="negative">($0)</td>
                                        <td class="negative">($0)</td>
                                        <td class="negative">($0)</td>
                                        <td class="negative">($0)</td>
                                    </tr>
                                    <tr class="bg-green-50">
                                        <td><strong>Utilidad Neta</strong></td>
                                        <td><strong class="positive">$2,477,150</strong></td>
                                        <td><strong class="positive">$7,122,000</strong></td>
                                        <td><strong class="positive">$12,655,500</strong></td>
                                        <td><strong class="positive">$18,666,000</strong></td>
                                        <td><strong class="positive">$25,515,500</strong></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">Flujo de Efectivo</h3>
                        <div class="overflow-x-auto">
                            <table class="financial-table">
                                <thead>
                                    <tr>
                                        <th>Concepto</th>
                                        <th>A√±o 1</th>
                                        <th>A√±o 2</th>
                                        <th>A√±o 3</th>
                                        <th>A√±o 4</th>
                                        <th>A√±o 5</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Flujo Operativo</td>
                                        <td class="positive">$2,677,150</td>
                                        <td class="positive">$7,698,000</td>
                                        <td class="positive">$13,679,500</td>
                                        <td class="positive">$20,178,000</td>
                                        <td class="positive">$27,563,500</td>
                                    </tr>
                                    <tr>
                                        <td>Flujo de Inversi√≥n</td>
                                        <td class="negative">($22,435,000)</td>
                                        <td class="negative">($64,120,000)</td>
                                        <td class="negative">($113,615,000)</td>
                                        <td class="negative">($166,610,000)</td>
                                        <td class="negative">($229,265,000)</td>
                                    </tr>
                                    <tr>
                                        <td>Flujo Financiero</td>
                                        <td class="positive">$45,000,000</td>
                                        <td class="positive">$0</td>
                                        <td class="positive">$0</td>
                                        <td class="positive">$0</td>
                                        <td class="positive">$0</td>
                                    </tr>
                                    <tr class="bg-blue-50">
                                        <td><strong>Flujo Neto</strong></td>
                                        <td><strong class="positive">$25,242,150</strong></td>
                                        <td><strong class="negative">($56,422,000)</strong></td>
                                        <td><strong class="negative">($99,935,500)</strong></td>
                                        <td><strong class="negative">($146,432,000)</strong></td>
                                        <td><strong class="negative">($201,701,500)</strong></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Flujo Acumulado</strong></td>
                                        <td><strong class="positive">$25,242,150</strong></td>
                                        <td><strong class="negative">($31,179,850)</strong></td>
                                        <td><strong class="negative">($131,115,350)</strong></td>
                                        <td><strong class="negative">($277,547,350)</strong></td>
                                        <td><strong class="negative">($479,248,850)</strong></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">Balance General</h3>
                        <div class="overflow-x-auto">
                            <table class="financial-table">
                                <thead>
                                    <tr>
                                        <th>Concepto</th>
                                        <th>A√±o 1</th>
                                        <th>A√±o 2</th>
                                        <th>A√±o 3</th>
                                        <th>A√±o 4</th>
                                        <th>A√±o 5</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="bg-gray-50">
                                        <td><strong>ACTIVOS</strong></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>Efectivo</td>
                                        <td>$25,242,150</td>
                                        <td>$31,179,850</td>
                                        <td>$131,115,350</td>
                                        <td>$277,547,350</td>
                                        <td>$479,248,850</td>
                                    </tr>
                                    <tr>
                                        <td>Cuentas por Cobrar (Netas)</td>
                                        <td>$15,000,000</td>
                                        <td>$43,200,000</td>
                                        <td>$76,800,000</td>
                                        <td>$113,400,000</td>
                                        <td>$153,600,000</td>
                                    </tr>
                                    <tr>
                                        <td>Activos Fijos</td>
                                        <td>$20,191,500</td>
                                        <td>$57,708,000</td>
                                        <td>$102,253,500</td>
                                        <td>$149,949,000</td>
                                        <td>$206,338,500</td>
                                    </tr>
                                    <tr class="bg-blue-50">
                                        <td><strong>Total Activos</strong></td>
                                        <td><strong>$60,433,650</strong></td>
                                        <td><strong>$132,087,850</strong></td>
                                        <td><strong>$310,168,850</strong></td>
                                        <td><strong>$540,896,350</strong></td>
                                        <td><strong>$839,187,350</strong></td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td><strong>PASIVOS</strong></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>Venture Debt</td>
                                        <td>$0</td>
                                        <td>$0</td>
                                        <td>$0</td>
                                        <td>$0</td>
                                        <td>$0</td>
                                    </tr>
                                    <tr>
                                        <td>Provisiones</td>
                                        <td>$200,000</td>
                                        <td>$776,000</td>
                                        <td>$1,800,000</td>
                                        <td>$3,312,000</td>
                                        <td>$5,360,000</td>
                                    </tr>
                                    <tr class="bg-gray-50">
                                        <td><strong>PATRIMONIO</strong></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                    <tr>
                                        <td>Capital Social</td>
                                        <td>$45,000,000</td>
                                        <td>$45,000,000</td>
                                        <td>$45,000,000</td>
                                        <td>$45,000,000</td>
                                        <td>$45,000,000</td>
                                    </tr>
                                    <tr>
                                        <td>Utilidades Retenidas</td>
                                        <td>$15,233,650</td>
                                        <td>$86,311,850</td>
                                        <td>$263,368,850</td>
                                        <td>$492,584,350</td>
                                        <td>$788,827,350</td>
                                    </tr>
                                    <tr class="bg-green-50">
                                        <td><strong>Total Pasivo + Capital</strong></td>
                                        <td><strong>$60,433,650</strong></td>
                                        <td><strong>$132,087,850</strong></td>
                                        <td><strong>$310,168,850</strong></td>
                                        <td><strong>$540,896,350</strong></td>
                                        <td><strong>$839,187,350</strong></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- An√°lisis Gr√°fico -->
            <div id="content-graficos" class="content-section">
                <div class="space-y-6">
                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">Evoluci√≥n de Ingresos y EBITDA</h3>
                        <div class="chart-container">
                            <canvas id="revenue-ebitda-chart"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">Composici√≥n de L√≠neas de Ingreso</h3>
                        <div class="chart-container">
                            <canvas id="revenue-breakdown-chart"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">An√°lisis de Sensibilidad: Impacto de Morosidad en EBITDA</h3>
                        <div class="chart-container">
                            <canvas id="sensitivity-chart"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">Estructura de Capital vs. TIR</h3>
                        <div class="chart-container">
                            <canvas id="capital-structure-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Resumen Estrat√©gico -->
            <div id="content-resumen" class="content-section">
                <div class="space-y-6">
                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">üéØ Propuesta de Valor: "Resiliencia como Servicio"</h3>
                        <div class="space-y-4">
                            <p class="text-gray-700">Rodando a Gas redefine el financiamiento de activos como un <strong>"Ecosistema de Resiliencia Operativa"</strong>, dise√±ado para asegurar la continuidad y rentabilidad del negocio del operador a largo plazo.</p>
                            
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-blue-900">üß† HASE</h4>
                                    <p class="text-sm text-blue-700">Hyper-Adaptive Scoring Engine: Scoring din√°mico y predictivo con datos propietarios</p>
                                </div>
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-green-900">‚ù§Ô∏è PIA</h4>
                                    <p class="text-sm text-green-700">Proactive Intervention Agent: Comunicaci√≥n emp√°tica y preventiva a escala</p>
                                </div>
                                <div class="bg-yellow-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-yellow-900">üõ°Ô∏è PMA</h4>
                                    <p class="text-sm text-yellow-700">Predictive Maintenance Advisor: Mantenimiento predictivo y nuevos ingresos</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">üöÄ Oportunidad de Mercado</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div class="text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg">
                                <div class="text-2xl font-bold text-blue-900">$10.9B MXN</div>
                                <div class="text-sm text-blue-700">TAM: Mercado Total Direccionable</div>
                            </div>
                            <div class="text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg">
                                <div class="text-2xl font-bold text-green-900">$4.3B MXN</div>
                                <div class="text-sm text-green-700">SAM: Mercado Servible Direccionable</div>
                            </div>
                            <div class="text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg">
                                <div class="text-2xl font-bold text-purple-900">$1.1B MXN</div>
                                <div class="text-sm text-purple-700">SOM: Mercado Obtenible (3-5 a√±os)</div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">üõ°Ô∏è "Protecci√≥n Rodando": El Game Changer</h3>
                        <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-lg">
                            <p class="text-gray-700 mb-4">Sistema de seguro proactivo gestionado por IA que redefine la relaci√≥n prestamista-prestatario, transformando la volatilidad del mercado en un activo gestionado.</p>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <h4 class="font-semibold text-green-900 mb-2">Beneficios Cuantitativos:</h4>
                                    <ul class="text-sm text-green-700 space-y-1">
                                        <li>‚Ä¢ Reducci√≥n de morosidad hasta 50%</li>
                                        <li>‚Ä¢ TIR mantenida ‚â•22.8%</li>
                                        <li>‚Ä¢ Ahorro $5,000 MXN por evento evitado</li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-blue-900 mb-2">Validaci√≥n Multicapa:</h4>
                                    <ul class="text-sm text-blue-700 space-y-1">
                                        <li>‚Ä¢ An√°lisis de Opciones Reales (ROA)</li>
                                        <li>‚Ä¢ Modelos Merton y Vasicek</li>
                                        <li>‚Ä¢ Algoritmo de Equilibrio TIR</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <h3 class="text-xl font-semibold mb-4">üè∞ Los Cuatro Fosos Competitivos</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="border-l-4 border-blue-500 pl-4">
                                <h4 class="font-semibold text-blue-900">üóÉÔ∏è Foso de Datos</h4>
                                <p class="text-sm text-gray-600">Datos operativos (GNV, GPS), "carta aval de ruta", telem√°tica PMA, etiquetado de intervenciones</p>
                            </div>
                            <div class="border-l-4 border-green-500 pl-4">
                                <h4 class="font-semibold text-green-900">ü§ñ Foso Tecnol√≥gico</h4>
                                <p class="text-sm text-gray-600">Ecosistema sin√©rgico HASE-PIA-PMA con mejora continua auto-reforzada</p>
                            </div>
                            <div class="border-l-4 border-yellow-500 pl-4">
                                <h4 class="font-semibold text-yellow-900">‚öôÔ∏è Foso Operacional</h4>
                                <p class="text-sm text-gray-600">Proceso de 6 pasos automatizado, eficiencia ultra-escalable, PMA reduce costos de recuperaci√≥n</p>
                            </div>
                            <div class="border-l-4 border-purple-500 pl-4">
                                <h4 class="font-semibold text-purple-900">üåê Foso de Red</h4>
                                <p class="text-sm text-gray-600">Flywheel de datos: m√°s clientes ‚Üí m√°s datos ‚Üí IA m√°s inteligente ‚Üí mejor producto ‚Üí m√°s clientes</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        // Global variables
        let charts = {};
        let modelData = {
            tasaInteres: 25.5,
            tasaMorosidad: 8,
            proteccionRodando: true,
            margenVagoneta: 88000,
            comisionGNV: 8,
            margenRefacciones: 25,
            ventureDebtPct: 0,
            ventureDebtRate: 12
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            setupTabs();
            setupControls();
            updateScenarioDetails();
            calculateModel();
            initializeCharts();
        });

        // Tab functionality
        function setupTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const contentSections = document.querySelectorAll('.content-section');

            tabButtons.forEach((button, index) => {
                button.addEventListener('click', () => {
                    // Remove active class from all tabs and content sections
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    contentSections.forEach(section => section.classList.remove('active'));

                    // Add active class to clicked tab and corresponding content
                    button.classList.add('active');
                    contentSections[index].classList.add('active');

                    // Update charts if switching to graphics tab
                    if (button.id === 'tab-graficos') {
                        setTimeout(updateCharts, 100);
                    }
                });
            });
        }

        // Setup control listeners
        function setupControls() {
            // Scenario selector
            document.getElementById('select-escenario').addEventListener('change', function() {
                applyScenario(this.value);
            });

            // Sliders and inputs
            const controls = [
                'tasa-interes', 'tasa-morosidad', 'margen-vagoneta', 
                'comision-gnv', 'margen-refacciones', 'venture-debt-pct', 'venture-debt-rate'
            ];

            controls.forEach(controlId => {
                const control = document.getElementById(controlId);
                if (control) {
                    control.addEventListener('input', function() {
                        updateControlValue(controlId, this.value);
                        calculateModel();
                    });
                }
            });

            // Checkbox
            document.getElementById('check-proteccion').addEventListener('change', function() {
                modelData.proteccionRodando = this.checked;
                calculateModel();
            });
        }

        function updateControlValue(controlId, value) {
            const numValue = parseFloat(value);
            
            switch(controlId) {
                case 'tasa-interes':
                    modelData.tasaInteres = numValue;
                    document.getElementById('tasa-interes-valor').textContent = numValue.toFixed(1) + '%';
                    break;
                case 'tasa-morosidad':
                    modelData.tasaMorosidad = numValue;
                    document.getElementById('tasa-morosidad-valor').textContent = numValue + '%';
                    break;
                case 'margen-vagoneta':
                    modelData.margenVagoneta = numValue;
                    document.getElementById('margen-vagoneta-valor').textContent = '$' + numValue.toLocaleString();
                    break;
                case 'comision-gnv':
                    modelData.comisionGNV = numValue;
                    document.getElementById('comision-gnv-valor').textContent = numValue + '%';
                    break;
                case 'margen-refacciones':
                    modelData.margenRefacciones = numValue;
                    document.getElementById('margen-refacciones-valor').textContent = numValue + '%';
                    break;
                case 'venture-debt-pct':
                    modelData.ventureDebtPct = numValue;
                    document.getElementById('venture-debt-pct-valor').textContent = numValue + '%';
                    break;
                case 'venture-debt-rate':
                    modelData.ventureDebtRate = numValue;
                    document.getElementById('venture-debt-rate-valor').textContent = numValue + '%';
                    break;
            }
        }

        function applyScenario(scenario) {
            switch(scenario) {
                case 'base':
                    updateSlider('tasa-morosidad', 8);
                    updateSlider('margen-vagoneta', 88000);
                    break;
                case 'optimista':
                    updateSlider('tasa-morosidad', 5);
                    updateSlider('margen-vagoneta', 100000);
                    break;
                case 'conservador':
                    updateSlider('tasa-morosidad', 12);
                    updateSlider('margen-vagoneta', 75000);
                    break;
            }
            updateScenarioDetails();
            calculateModel();
        }

        function updateSlider(id, value) {
            const slider = document.getElementById(id);
            if (slider) {
                slider.value = value;
                updateControlValue(id, value);
            }
        }

        function updateScenarioDetails() {
            const scenario = document.getElementById('select-escenario').value;
            const details = document.getElementById('scenario-details');
            
            switch(scenario) {
                case 'base':
                    details.innerHTML = '<strong>Escenario Base:</strong> Tasa de morosidad 8%, Margen por vagoneta $88,000 MXN, TIR objetivo ‚â•22.8%';
                    break;
                case 'optimista':
                    details.innerHTML = '<strong>Escenario Optimista:</strong> Tasa de morosidad 5%, Margen por vagoneta $100,000 MXN, crecimiento acelerado';
                    break;
                case 'conservador':
                    details.innerHTML = '<strong>Escenario Conservador:</strong> Tasa de morosidad 12%, Margen por vagoneta $75,000 MXN, crecimiento moderado';
                    break;
            }
        }

        function calculateModel() {
            // Calculate financial metrics
            const unitsYear5 = 500;
            const morosidadFactor = modelData.proteccionRodando ? modelData.tasaMorosidad * 0.5 : modelData.tasaMorosidad;
            
            // Calculate EBITDA Year 5
            const ingresosTotales = 59400000;
            const provisionAdjusted = ingresosTotales * 0.43 * (morosidadFactor / 100);
            const ebitda = ingresosTotales * 0.43 - provisionAdjusted;
            
            // Calculate TIR
            const tir = calculateTIR();
            
            // Update summary cards
            document.getElementById('ebitda-year5').textContent = '$' + (ebitda / 1000000).toFixed(1) + 'M MXN';
            document.getElementById('tir-proyectada').textContent = tir.toFixed(1) + '%';
            document.getElementById('unidades-year5').textContent = unitsYear5.toString();
            document.getElementById('irr-value').textContent = tir.toFixed(1) + '%';
            
            // Update charts if visible
            updateCharts();
        }

        function calculateTIR() {
            // Simplified TIR calculation
            const baseRate = 22.8;
            const morosidadImpact = (8 - modelData.tasaMorosidad) * 0.5;
            const margenImpact = (modelData.margenVagoneta - 88000) / 88000 * 10;
            const proteccionImpact = modelData.proteccionRodando ? 2 : 0;
            
            return Math.max(15, baseRate + morosidadImpact + margenImpact + proteccionImpact);
        }

        function initializeCharts() {
            // Revenue and EBITDA evolution chart
            const ctx1 = document.getElementById('revenue-ebitda-chart');
            if (ctx1) {
                charts.revenueEbitda = new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['A√±o 1', 'A√±o 2', 'A√±o 3', 'A√±o 4', 'A√±o 5'],
                        datasets: [{
                            label: 'Ingresos Totales',
                            data: [5.79, 16.6, 29.46, 43.34, 59.4],
                            borderColor: '#2563eb',
                            backgroundColor: 'rgba(37, 99, 235, 0.1)',
                            tension: 0.4
                        }, {
                            label: 'EBITDA',
                            data: [2.48, 7.12, 12.66, 18.67, 25.52],
                            borderColor: '#16a34a',
                            backgroundColor: 'rgba(22, 163, 74, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Millones MXN'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                position: 'top',
                            },
                            title: {
                                display: false
                            }
                        }
                    }
                });
            }

            // Revenue breakdown chart
            const ctx2 = document.getElementById('revenue-breakdown-chart');
            if (ctx2) {
                charts.revenueBreakdown = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Financiamiento', 'Margen Vagoneta', 'Comisiones GNV', 'Refacciones PMA'],
                        datasets: [{
                            data: [43.1, 53.3, 2.0, 1.6],
                            backgroundColor: [
                                '#2563eb',
                                '#16a34a', 
                                '#d97706',
                                '#7c3aed'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                            }
                        }
                    }
                });
            }

            // Sensitivity analysis chart
            const ctx3 = document.getElementById('sensitivity-chart');
            if (ctx3) {
                charts.sensitivity = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: ['4%', '6%', '8%', '10%', '12%', '15%'],
                        datasets: [{
                            label: 'EBITDA A√±o 5 (Millones MXN)',
                            data: [28.5, 27.0, 25.5, 24.0, 22.5, 20.0],
                            backgroundColor: [
                                '#16a34a', '#22c55e', '#2563eb', '#3b82f6', '#f59e0b', '#dc2626'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: false,
                                min: 18,
                                title: {
                                    display: true,
                                    text: 'EBITDA (Millones MXN)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Tasa de Morosidad'
                                }
                            }
                        }
                    }
                });
            }

            // Capital structure chart
            const ctx4 = document.getElementById('capital-structure-chart');
            if (ctx4) {
                charts.capitalStructure = new Chart(ctx4, {
                    type: 'scatter',
                    data: {
                        datasets: [{
                            label: 'TIR vs % Venture Debt',
                            data: [
                                {x: 0, y: 22.8},
                                {x: 10, y: 21.5},
                                {x: 20, y: 20.2},
                                {x: 30, y: 18.9},
                                {x: 40, y: 17.6},
                                {x: 50, y: 16.3}
                            ],
                            backgroundColor: '#2563eb',
                            borderColor: '#2563eb'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: '% Venture Debt'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'TIR (%)'
                                }
                            }
                        }
                    }
                });
            }
        }

        function updateCharts() {
            // Update charts with current model data
            if (charts.sensitivity && charts.sensitivity.data) {
                const currentMorosidad = modelData.tasaMorosidad;
                const baseEbitda = 25.5;
                const ebitdaValues = [4, 6, 8, 10, 12, 15].map(rate => {
                    const factor = modelData.proteccionRodando ? 0.5 : 1;
                    return baseEbitda - (rate - 8) * 0.5 * factor;
                });
                
                charts.sensitivity.data.datasets[0].data = ebitdaValues;
                charts.sensitivity.update();
            }

            if (charts.capitalStructure && charts.capitalStructure.data) {
                const baseTIR = calculateTIR();
                const tirValues = [0, 10, 20, 30, 40, 50].map(debt => ({
                    x: debt,
                    y: baseTIR - (debt * 0.13) // Impact of debt on TIR
                }));
                
                charts.capitalStructure.data.datasets[0].data = tirValues;
                charts.capitalStructure.update();
            }
        }
    </script>
</body>
</html>
